<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Continous Time Markov Model â€“ Procrastination and Dementia</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../analysis/discrete-markov.html" rel="next">
<link href="../analysis/hypothesis.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-17c909d5fd25ae21b861c0c7a49b2096.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-cb0f7c8bbc9089441895bfd16ca674ab.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/quarto-contrib/fontawesome6-1.2.0/all.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/fontawesome6-1.2.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="../site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="../site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">

<script src="../site_libs/datatables-binding-0.33/datatables.js"></script>

<script src="../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">

<link href="../site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">

<script src="../site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>

<link href="../site_libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">

<script src="../site_libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>

<link href="../site_libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">

<script src="../site_libs/selectize-0.12.0/selectize.min.js"></script>

<link href="../site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="../site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>


  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Procrastination and Dementia</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../analysis/data-final.html"> 
<span class="menu-text">Data</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../analysis/hypothesis.html" aria-current="page"> 
<span class="menu-text">Analysis</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../analysis/paper.html"> 
<span class="menu-text">Manuscript</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/C-Monaghan/crisp-clam"> <i class="bi bi-github" role="img" aria-label="github">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../analysis/continous-markov.html">Models</a></li><li class="breadcrumb-item"><a href="../analysis/continous-markov.html">Continous Time Markov Model</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Hypothesis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analysis/hypothesis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hypotheses</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analysis/continous-markov.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Continous Time Markov Model</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../analysis/discrete-markov.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Discrete Time Markov Model</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setting-up" id="toc-setting-up" class="nav-link active" data-scroll-target="#setting-up">Setting up</a>
  <ul class="collapse">
  <li><a href="#loading-packages" id="toc-loading-packages" class="nav-link" data-scroll-target="#loading-packages">Loading packages</a></li>
  <li><a href="#loading-functions" id="toc-loading-functions" class="nav-link" data-scroll-target="#loading-functions">Loading functions</a></li>
  <li><a href="#reading-in-data" id="toc-reading-in-data" class="nav-link" data-scroll-target="#reading-in-data">Reading in data</a></li>
  </ul></li>
  <li><a href="#markov-modelling" id="toc-markov-modelling" class="nav-link" data-scroll-target="#markov-modelling">Markov Modelling</a>
  <ul class="collapse">
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">Data preparation</a></li>
  <li><a href="#creating-transition-matrix" id="toc-creating-transition-matrix" class="nav-link" data-scroll-target="#creating-transition-matrix">Creating transition matrix</a></li>
  <li><a href="#visualising-the-matrix" id="toc-visualising-the-matrix" class="nav-link" data-scroll-target="#visualising-the-matrix">Visualising the matrix</a></li>
  </ul></li>
  <li><a href="#multi-state-markov-model" id="toc-multi-state-markov-model" class="nav-link" data-scroll-target="#multi-state-markov-model">Multi-State Markov Model</a>
  <ul class="collapse">
  <li><a href="#data-preperation" id="toc-data-preperation" class="nav-link" data-scroll-target="#data-preperation">Data preperation</a></li>
  <li><a href="#modelling" id="toc-modelling" class="nav-link" data-scroll-target="#modelling">Modelling</a></li>
  <li><a href="#fitting" id="toc-fitting" class="nav-link" data-scroll-target="#fitting">Fitting</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/C-Monaghan/crisp-clam/edit/main/analysis/continous-markov.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/C-Monaghan/crisp-clam/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../analysis/continous-markov.html">Models</a></li><li class="breadcrumb-item"><a href="../analysis/continous-markov.html">Continous Time Markov Model</a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Continous Time Markov Model</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="setting-up" class="level2">
<h2 class="anchored" data-anchor-id="setting-up">Setting up</h2>
<section id="loading-packages" class="level3">
<h3 class="anchored" data-anchor-id="loading-packages">Loading packages</h3>
<div class="cell">
<details class="code-fold">
<summary>Check our my packages</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="loading-functions" class="level3">
<h3 class="anchored" data-anchor-id="loading-functions">Loading functions</h3>
<div class="cell">
<details class="code-fold">
<summary>Check our my functions</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>extract_years <span class="ot">&lt;-</span> <span class="cf">function</span>(data, years, <span class="at">impute =</span> <span class="cn">TRUE</span>, <span class="at">cog_total =</span> <span class="cn">FALSE</span>, <span class="at">absorbing =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Extracts cognitive function data for specified years from a dataset.</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Converts numeric cognitive status codes (1, 2, 3) into descriptive labels</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ("Normal Cognition", "MCI", "Dementia") for easier interpretation.</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Arguments:</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - data: The input dataset containing cognitive function data.</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - years: A vector of years for which data should be extracted.</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Returns:</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - A dataset with ID and cognitive status columns for the specified years.</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create dynamic column names based on the years provided</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  cogfunction_cols <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"cogfunction"</span>, years)</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  cogtotal_cols    <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"cogtot27_imp"</span>, years)</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(cog_total <span class="sc">==</span> <span class="cn">FALSE</span>) {</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Select only the ID column and cognitive function columns for the specified years</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(ID, <span class="fu">any_of</span>(cogfunction_cols)) <span class="sc">|&gt;</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="sc">!</span><span class="fu">c</span>(ID), <span class="sc">~</span> <span class="fu">case_when</span>(</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>      .x <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Normal Cognition"</span>,</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>      .x <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"MCI"</span>,</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>      .x <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"Dementia"</span>,</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_character_</span>  <span class="co"># To handle missing/other cases</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    )))</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Select only the ID column and cognitive function columns for the specified years</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(ID, <span class="fu">any_of</span>(cogtotal_cols)) <span class="sc">|&gt;</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>      <span class="fu">rename_with</span>( <span class="at">.cols =</span> <span class="sc">!</span>ID, <span class="at">.fn =</span> <span class="sc">~</span> stringr<span class="sc">::</span><span class="fu">str_replace</span>(</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>        <span class="at">string =</span> .x,</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>        <span class="at">pattern =</span> <span class="st">"cogtot27_imp"</span>, </span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">replacement =</span> <span class="st">"cog_score_"</span>))</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(impute <span class="sc">==</span> <span class="cn">TRUE</span>){</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>      tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">cols =</span> <span class="sc">!</span>ID,</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">names_to =</span> <span class="st">"Wave"</span>,</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>        <span class="at">values_to =</span> <span class="st">"Status"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(ID) <span class="sc">|&gt;</span></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>      tidyr<span class="sc">::</span><span class="fu">fill</span>(Status, <span class="at">.direction =</span> <span class="st">"down"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>      tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"Wave"</span>, <span class="at">values_from =</span> <span class="st">"Status"</span>)</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(absorbing <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>      tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>        <span class="at">cols =</span> <span class="sc">!</span>ID,</span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>        <span class="at">names_to =</span> <span class="st">"Wave"</span>,</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>        <span class="at">values_to =</span> <span class="st">"Status"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(ID) <span class="sc">|&gt;</span></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">Status =</span> <span class="fu">ifelse</span>(<span class="fu">cumany</span>(Status <span class="sc">==</span> <span class="st">"Dementia"</span>), <span class="st">"Dementia"</span>, Status)) <span class="sc">|&gt;</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>      tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> <span class="st">"Wave"</span>, <span class="at">values_from =</span> <span class="st">"Status"</span>)</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(data)</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>create_transitions <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">absorbing =</span> <span class="cn">FALSE</span>){</span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reshapes data from wide to long format to track cognitive status transitions over time.</span></span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculates the next wave's cognitive status for each individual and creates a transition column.</span></span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Optionally treats "Dementia" as an absorbing state, meaning once an individual is classified</span></span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>  <span class="co"># with dementia, their status cannot change in subsequent waves.</span></span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Arguments:</span></span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - data: The dataset containing cognitive status data.</span></span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - absorbing: A logical flag indicating whether "Dementia" should be treated </span></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   as an absorbing state.</span></span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Returns:</span></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - A dataset with transition information, including current and next wave statuses.</span></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reshape the data from wide to long format to track cognitive status over waves</span></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(ID, <span class="fu">starts_with</span>(<span class="st">"cogfunction"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">!</span>ID,</span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>                        <span class="at">names_to =</span> <span class="st">"Wave"</span>,</span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>                        <span class="at">values_to =</span> <span class="st">"Status"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Wave =</span> <span class="fu">as.factor</span>(stringr<span class="sc">::</span><span class="fu">str_replace</span>(Wave, <span class="st">"cogfunction"</span>, <span class="st">""</span>))) <span class="sc">|&gt;</span></span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Arrange by ID and Wave to prepare for transition calculation</span></span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(ID, Wave) <span class="sc">|&gt;</span></span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(ID) <span class="sc">|&gt;</span></span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Get the next wave's cognitive status for each person</span></span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">next_wave_status =</span> <span class="fu">lead</span>(Status)) <span class="sc">|&gt;</span></span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>  <span class="co"># We can optionally specify dementia as an absorbing state</span></span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Once an individual is classified with dementia they cannot be classified</span></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>  <span class="co"># with anything else </span></span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(absorbing <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(ID) <span class="sc">|&gt;</span></span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>        <span class="at">Status =</span> <span class="fu">ifelse</span>(<span class="fu">cumany</span>(Status <span class="sc">==</span> <span class="st">"Dementia"</span>), <span class="st">"Dementia"</span>, Status),</span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>        <span class="at">next_wave_status =</span> <span class="fu">ifelse</span>(<span class="fu">cumany</span>(Status <span class="sc">==</span> <span class="st">"Dementia"</span>), <span class="st">"Dementia"</span>, next_wave_status),</span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>        <span class="at">transition =</span> <span class="fu">paste</span>(Status, next_wave_status, <span class="at">sep =</span> <span class="st">" to "</span>)</span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span></span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(Wave <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">2016</span>, <span class="dv">2018</span>, <span class="dv">2020</span>))</span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter out rows where either the current or next status is missing</span></span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(ID) <span class="sc">|&gt;</span></span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(Status), <span class="sc">!</span><span class="fu">is.na</span>(next_wave_status)) <span class="sc">|&gt;</span></span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create a new column representing the transition from one status to the next</span></span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a>      <span class="at">transition =</span> <span class="fu">paste</span>(Status, next_wave_status, <span class="at">sep =</span> <span class="st">" to "</span>),</span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a>      <span class="at">transition =</span> <span class="fu">factor</span>(</span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a>        transition, </span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a>        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Normal Cognition to Normal Cognition"</span>, <span class="st">"Normal Cognition to MCI"</span>,</span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Normal Cognition to Dementia"</span>, <span class="st">"MCI to Normal Cognition"</span>, <span class="st">"MCI to MCI"</span>,</span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"MCI to Dementia"</span>, <span class="st">"Dementia to Dementia"</span>) </span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a>        ))</span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(data)</span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>calculate_probabilties <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculates the proportion of each cognitive status transition in the dataset.</span></span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Counts the occurrences of each transition and computes their relative probabilities.</span></span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Arguments:</span></span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - data: The dataset containing transition information.</span></span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Returns:</span></span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - A dataset with transition probabilities, split into "from" and "to" states.</span></span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate the proportion of each transition by dividing by the total count</span></span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">|&gt;</span></span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>(transition) <span class="sc">|&gt;</span></span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">prop =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">|&gt;</span></span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">separate</span>(transition, <span class="at">into =</span> <span class="fu">c</span>(<span class="st">"from"</span>, <span class="st">"to"</span>), <span class="at">sep =</span> <span class="st">" to "</span>)</span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a>transition_matrix <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">longitudinal =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Constructs a transition matrix from the calculated transition probabilities.</span></span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The matrix represents the probability of moving from one cognitive state to another.</span></span>
<span id="cb2-138"><a href="#cb2-138" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Arguments:</span></span>
<span id="cb2-139"><a href="#cb2-139" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - data: The dataset containing transition probabilities.</span></span>
<span id="cb2-140"><a href="#cb2-140" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - longitudinal: A TRUE/FALSE statement indicating if the probabilities are from multiple waves</span></span>
<span id="cb2-141"><a href="#cb2-141" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Returns:</span></span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - A transition matrix with rows representing "from" states and columns </span></span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   representing "to" states.</span></span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(longitudinal <span class="sc">==</span> <span class="cn">FALSE</span>) {</span>
<span id="cb2-146"><a href="#cb2-146" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Defining empty matrix matrix</span></span>
<span id="cb2-147"><a href="#cb2-147" aria-hidden="true" tabindex="-1"></a>    states <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Normal Cognition"</span>, <span class="st">"MCI"</span>, <span class="st">"Dementia"</span>)</span>
<span id="cb2-148"><a href="#cb2-148" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-149"><a href="#cb2-149" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb2-150"><a href="#cb2-150" aria-hidden="true" tabindex="-1"></a>      <span class="dv">0</span>,</span>
<span id="cb2-151"><a href="#cb2-151" aria-hidden="true" tabindex="-1"></a>      <span class="at">nrow =</span> <span class="fu">length</span>(states),</span>
<span id="cb2-152"><a href="#cb2-152" aria-hidden="true" tabindex="-1"></a>      <span class="at">ncol =</span> <span class="fu">length</span>(states),</span>
<span id="cb2-153"><a href="#cb2-153" aria-hidden="true" tabindex="-1"></a>      <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="at">from_state =</span> states, <span class="at">to_state =</span> states))</span>
<span id="cb2-154"><a href="#cb2-154" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-155"><a href="#cb2-155" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fill the transition matrix with probabilities</span></span>
<span id="cb2-156"><a href="#cb2-156" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data)) {</span>
<span id="cb2-157"><a href="#cb2-157" aria-hidden="true" tabindex="-1"></a>      from <span class="ot">&lt;-</span> data<span class="sc">$</span>from[i]</span>
<span id="cb2-158"><a href="#cb2-158" aria-hidden="true" tabindex="-1"></a>      to <span class="ot">&lt;-</span> data<span class="sc">$</span>to[i]</span>
<span id="cb2-159"><a href="#cb2-159" aria-hidden="true" tabindex="-1"></a>      prob <span class="ot">&lt;-</span> data<span class="sc">$</span>prop[i]</span>
<span id="cb2-160"><a href="#cb2-160" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb2-161"><a href="#cb2-161" aria-hidden="true" tabindex="-1"></a>      transition_matrix[from, to] <span class="ot">&lt;-</span> prob</span>
<span id="cb2-162"><a href="#cb2-162" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-163"><a href="#cb2-163" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span>(longitudinal <span class="sc">==</span> <span class="cn">TRUE</span>){</span>
<span id="cb2-164"><a href="#cb2-164" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-165"><a href="#cb2-165" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Aggregate by 'from' and 'to' states to sum transition probabilities</span></span>
<span id="cb2-166"><a href="#cb2-166" aria-hidden="true" tabindex="-1"></a>    data_agg <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb2-167"><a href="#cb2-167" aria-hidden="true" tabindex="-1"></a>      <span class="fu">group_by</span>(from, to) <span class="sc">|&gt;</span></span>
<span id="cb2-168"><a href="#cb2-168" aria-hidden="true" tabindex="-1"></a>      <span class="fu">summarise</span>(<span class="at">transition_prob =</span> <span class="fu">sum</span>(prop), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb2-169"><a href="#cb2-169" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-170"><a href="#cb2-170" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="ot">&lt;-</span> data_agg <span class="sc">|&gt;</span></span>
<span id="cb2-171"><a href="#cb2-171" aria-hidden="true" tabindex="-1"></a>      tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(<span class="at">names_from =</span> to, <span class="at">values_from =</span> transition_prob, <span class="at">values_fill =</span> <span class="dv">0</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-172"><a href="#cb2-172" aria-hidden="true" tabindex="-1"></a>      tibble<span class="sc">::</span><span class="fu">column_to_rownames</span>(<span class="st">"from"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-173"><a href="#cb2-173" aria-hidden="true" tabindex="-1"></a>      <span class="fu">as.matrix</span>()</span>
<span id="cb2-174"><a href="#cb2-174" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-175"><a href="#cb2-175" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-176"><a href="#cb2-176" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(transition_matrix)</span>
<span id="cb2-177"><a href="#cb2-177" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-178"><a href="#cb2-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-179"><a href="#cb2-179" aria-hidden="true" tabindex="-1"></a>plot_matrix <span class="ot">&lt;-</span> <span class="cf">function</span>(data, year, <span class="at">ts =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb2-180"><a href="#cb2-180" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Visualizes the transition matrix as a heatmap.</span></span>
<span id="cb2-181"><a href="#cb2-181" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Uses color gradients to represent transition probabilities and includes labels for clarity.</span></span>
<span id="cb2-182"><a href="#cb2-182" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Arguments:</span></span>
<span id="cb2-183"><a href="#cb2-183" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - data: The transition matrix or dataset to plot.</span></span>
<span id="cb2-184"><a href="#cb2-184" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - year: The year or time period associated with the data.</span></span>
<span id="cb2-185"><a href="#cb2-185" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - ts: A logical flag indicating whether the title should include a time series label.</span></span>
<span id="cb2-186"><a href="#cb2-186" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Returns:</span></span>
<span id="cb2-187"><a href="#cb2-187" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - A ggplot object representing the transition probabilities as a heatmap.</span></span>
<span id="cb2-188"><a href="#cb2-188" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-189"><a href="#cb2-189" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(ts <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb2-190"><a href="#cb2-190" aria-hidden="true" tabindex="-1"></a>    title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Transition Probabilities Across Cognitive States - "</span>, year)</span>
<span id="cb2-191"><a href="#cb2-191" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb2-192"><a href="#cb2-192" aria-hidden="true" tabindex="-1"></a>    title <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">"Transition Probabilities Across Cognitive States ("</span>, year, <span class="st">"-2022)"</span>)</span>
<span id="cb2-193"><a href="#cb2-193" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-194"><a href="#cb2-194" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-195"><a href="#cb2-195" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reshaping data for plotting</span></span>
<span id="cb2-196"><a href="#cb2-196" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb2-197"><a href="#cb2-197" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>(<span class="at">row.names =</span> <span class="cn">FALSE</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-198"><a href="#cb2-198" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">from_state =</span> <span class="fu">c</span>(<span class="st">"Normal Cognition"</span>, <span class="st">"MCI"</span>, <span class="st">"Dementia"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-199"><a href="#cb2-199" aria-hidden="true" tabindex="-1"></a>    reshape2<span class="sc">::</span><span class="fu">melt</span>(<span class="at">id.vars =</span> <span class="st">"from_state"</span>, <span class="at">variable.name =</span> <span class="st">"to_state"</span>, <span class="at">value.name =</span> <span class="st">"probability"</span>)</span>
<span id="cb2-200"><a href="#cb2-200" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-201"><a href="#cb2-201" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plotting probabilities</span></span>
<span id="cb2-202"><a href="#cb2-202" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">|&gt;</span></span>
<span id="cb2-203"><a href="#cb2-203" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> from_state, <span class="at">y =</span> to_state, <span class="at">fill =</span> probability)) <span class="sc">+</span></span>
<span id="cb2-204"><a href="#cb2-204" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb2-205"><a href="#cb2-205" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_c</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb2-206"><a href="#cb2-206" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> title,</span>
<span id="cb2-207"><a href="#cb2-207" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"To"</span>, <span class="at">y =</span> <span class="st">"From"</span>, <span class="at">fill =</span> <span class="st">"Prob"</span>) <span class="sc">+</span></span>
<span id="cb2-208"><a href="#cb2-208" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(probability, <span class="at">digits =</span> <span class="dv">3</span>)), <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb2-209"><a href="#cb2-209" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb2-210"><a href="#cb2-210" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb2-211"><a href="#cb2-211" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb2-212"><a href="#cb2-212" aria-hidden="true" tabindex="-1"></a>          <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb2-213"><a href="#cb2-213" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid =</span> <span class="fu">element_blank</span>()</span>
<span id="cb2-214"><a href="#cb2-214" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-215"><a href="#cb2-215" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-216"><a href="#cb2-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-217"><a href="#cb2-217" aria-hidden="true" tabindex="-1"></a>normalise <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb2-218"><a href="#cb2-218" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Normalizes a matrix so that each row sums to 1.</span></span>
<span id="cb2-219"><a href="#cb2-219" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Arguments:</span></span>
<span id="cb2-220"><a href="#cb2-220" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - x: The input matrix to normalize.</span></span>
<span id="cb2-221"><a href="#cb2-221" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Returns:</span></span>
<span id="cb2-222"><a href="#cb2-222" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - A normalized matrix where each row sums to 1.</span></span>
<span id="cb2-223"><a href="#cb2-223" aria-hidden="true" tabindex="-1"></a>  x <span class="sc">/</span> <span class="fu">rowSums</span>(x)</span>
<span id="cb2-224"><a href="#cb2-224" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-225"><a href="#cb2-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-226"><a href="#cb2-226" aria-hidden="true" tabindex="-1"></a>reshape_matrix <span class="ot">&lt;-</span> <span class="cf">function</span>(matrix, wave) {</span>
<span id="cb2-227"><a href="#cb2-227" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reshapes a transition matrix into a long format for easier analysis and visualization.</span></span>
<span id="cb2-228"><a href="#cb2-228" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adds a "Wave" column to identify the time period associated with the matrix.</span></span>
<span id="cb2-229"><a href="#cb2-229" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Arguments:</span></span>
<span id="cb2-230"><a href="#cb2-230" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - matrix: The transition matrix to reshape.</span></span>
<span id="cb2-231"><a href="#cb2-231" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - wave: The wave or time period associated with the matrix.</span></span>
<span id="cb2-232"><a href="#cb2-232" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Returns:</span></span>
<span id="cb2-233"><a href="#cb2-233" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - A long-format dataset with "from", "to", and "transition_prob" columns.</span></span>
<span id="cb2-234"><a href="#cb2-234" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-235"><a href="#cb2-235" aria-hidden="true" tabindex="-1"></a>  matrix <span class="sc">|&gt;</span></span>
<span id="cb2-236"><a href="#cb2-236" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb2-237"><a href="#cb2-237" aria-hidden="true" tabindex="-1"></a>    tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"from"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-238"><a href="#cb2-238" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">-</span>from, <span class="at">names_to =</span> <span class="st">"to"</span>, <span class="at">values_to =</span> <span class="st">"transition_prob"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-239"><a href="#cb2-239" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Wave =</span> wave)</span>
<span id="cb2-240"><a href="#cb2-240" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-241"><a href="#cb2-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-242"><a href="#cb2-242" aria-hidden="true" tabindex="-1"></a>plot_transition_wave <span class="ot">&lt;-</span> <span class="cf">function</span>(data, wave) {</span>
<span id="cb2-243"><a href="#cb2-243" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plots transition probabilities for a specific wave as a heatmap.</span></span>
<span id="cb2-244"><a href="#cb2-244" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filters the data to include only the main transitions and adds labels for clarity.</span></span>
<span id="cb2-245"><a href="#cb2-245" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Arguments:</span></span>
<span id="cb2-246"><a href="#cb2-246" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - data: The dataset containing transition probabilities.</span></span>
<span id="cb2-247"><a href="#cb2-247" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - wave: The wave or time period to plot.</span></span>
<span id="cb2-248"><a href="#cb2-248" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Returns:</span></span>
<span id="cb2-249"><a href="#cb2-249" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - A ggplot object representing the transition probabilities for the </span></span>
<span id="cb2-250"><a href="#cb2-250" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   specified wave.</span></span>
<span id="cb2-251"><a href="#cb2-251" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-252"><a href="#cb2-252" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Main transitions per wave</span></span>
<span id="cb2-253"><a href="#cb2-253" aria-hidden="true" tabindex="-1"></a>  filter_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-254"><a href="#cb2-254" aria-hidden="true" tabindex="-1"></a>    <span class="at">from =</span> <span class="fu">c</span>(<span class="st">"Normal Cognition"</span>, <span class="st">"Normal Cognition"</span>, <span class="st">"Normal Cognition"</span>,  <span class="st">"MCI"</span>, <span class="st">"MCI"</span>, <span class="st">"MCI"</span>, <span class="st">"Dementia"</span>, <span class="st">"Dementia"</span>, <span class="st">"Dementia"</span>),</span>
<span id="cb2-255"><a href="#cb2-255" aria-hidden="true" tabindex="-1"></a>    <span class="at">to =</span> <span class="fu">c</span>(<span class="st">"Normal Cognition"</span>, <span class="st">"MCI"</span>, <span class="st">"Dementia"</span>, <span class="st">"Normal Cognition"</span>, <span class="st">"MCI"</span>, <span class="st">"Dementia"</span>, <span class="st">"Normal Cognition"</span>, <span class="st">"MCI"</span>, <span class="st">"Dementia"</span>)</span>
<span id="cb2-256"><a href="#cb2-256" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-257"><a href="#cb2-257" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-258"><a href="#cb2-258" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">|&gt;</span></span>
<span id="cb2-259"><a href="#cb2-259" aria-hidden="true" tabindex="-1"></a>    <span class="fu">semi_join</span>(filter_data, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"from"</span>, <span class="st">"to"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-260"><a href="#cb2-260" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Wave <span class="sc">==</span> wave) <span class="sc">|&gt;</span></span>
<span id="cb2-261"><a href="#cb2-261" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> to, <span class="at">y =</span> from, <span class="at">fill =</span> transition_prob)) <span class="sc">+</span></span>
<span id="cb2-262"><a href="#cb2-262" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb2-263"><a href="#cb2-263" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> transition_prob), <span class="at">size =</span> <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb2-264"><a href="#cb2-264" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_c</span>(<span class="at">alpha =</span> <span class="fl">0.8</span>)<span class="sc">+</span></span>
<span id="cb2-265"><a href="#cb2-265" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"Transition Probabilities Across Cognitive States ("</span>, wave, <span class="st">"-"</span>, wave <span class="sc">+</span> <span class="dv">2</span>, <span class="st">")"</span>),</span>
<span id="cb2-266"><a href="#cb2-266" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"To"</span>, <span class="at">y =</span> <span class="st">"From"</span>, <span class="at">fill =</span> <span class="st">"Prob"</span>) <span class="sc">+</span></span>
<span id="cb2-267"><a href="#cb2-267" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_light</span>() <span class="sc">+</span></span>
<span id="cb2-268"><a href="#cb2-268" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb2-269"><a href="#cb2-269" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb2-270"><a href="#cb2-270" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb2-271"><a href="#cb2-271" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">8</span>),</span>
<span id="cb2-272"><a href="#cb2-272" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb2-273"><a href="#cb2-273" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.border =</span> <span class="fu">element_blank</span>()</span>
<span id="cb2-274"><a href="#cb2-274" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-275"><a href="#cb2-275" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-276"><a href="#cb2-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-277"><a href="#cb2-277" aria-hidden="true" tabindex="-1"></a>backtrack_age <span class="ot">&lt;-</span> <span class="cf">function</span>(data, base_year, current_year) {</span>
<span id="cb2-278"><a href="#cb2-278" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Back calculates an individual's age by 2-year intervals</span></span>
<span id="cb2-279"><a href="#cb2-279" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Arguments:</span></span>
<span id="cb2-280"><a href="#cb2-280" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - data: The dataset containing the age variable and a 'Wave' column indicating the year of the wave</span></span>
<span id="cb2-281"><a href="#cb2-281" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - current_year: The year for which the age is measured (e.g., 2022)</span></span>
<span id="cb2-282"><a href="#cb2-282" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Returns:</span></span>
<span id="cb2-283"><a href="#cb2-283" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - A dataset where the age is subtracted by intervals of 2 for each respective year</span></span>
<span id="cb2-284"><a href="#cb2-284" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-285"><a href="#cb2-285" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Map Wave values (1-10) to their corresponding years</span></span>
<span id="cb2-286"><a href="#cb2-286" aria-hidden="true" tabindex="-1"></a>  wave_to_year <span class="ot">&lt;-</span> <span class="cf">function</span>(wave) {</span>
<span id="cb2-287"><a href="#cb2-287" aria-hidden="true" tabindex="-1"></a>    base_year <span class="sc">+</span> (<span class="fu">as.numeric</span>(wave) <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb2-288"><a href="#cb2-288" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-289"><a href="#cb2-289" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-290"><a href="#cb2-290" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">|&gt;</span></span>
<span id="cb2-291"><a href="#cb2-291" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(ID) <span class="sc">|&gt;</span></span>
<span id="cb2-292"><a href="#cb2-292" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Age =</span> Age <span class="sc">-</span> (current_year <span class="sc">-</span> <span class="fu">wave_to_year</span>(Wave))) <span class="sc">|&gt;</span></span>
<span id="cb2-293"><a href="#cb2-293" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb2-294"><a href="#cb2-294" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-295"><a href="#cb2-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-296"><a href="#cb2-296" aria-hidden="true" tabindex="-1"></a>pivot_data <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">cog_total =</span> <span class="cn">FALSE</span>) {</span>
<span id="cb2-297"><a href="#cb2-297" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reshapes the input dataset by pivoting cardiovascular, depression, and cognitive data</span></span>
<span id="cb2-298"><a href="#cb2-298" aria-hidden="true" tabindex="-1"></a>  <span class="co"># into long format for analysis. Handles two scenarios: one for cognitive status and</span></span>
<span id="cb2-299"><a href="#cb2-299" aria-hidden="true" tabindex="-1"></a>  <span class="co"># another for total cognitive scores. Combines the pivoted data into a final dataset</span></span>
<span id="cb2-300"><a href="#cb2-300" aria-hidden="true" tabindex="-1"></a>  <span class="co"># for further analysis.</span></span>
<span id="cb2-301"><a href="#cb2-301" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Arguments:</span></span>
<span id="cb2-302"><a href="#cb2-302" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - data: The input dataset containing cardiovascular, depression, and cognitive data.</span></span>
<span id="cb2-303"><a href="#cb2-303" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - cog_total: A logical flag indicating whether to pivot total cognitive scores (TRUE)</span></span>
<span id="cb2-304"><a href="#cb2-304" aria-hidden="true" tabindex="-1"></a>  <span class="co">#               or cognitive status (FALSE).</span></span>
<span id="cb2-305"><a href="#cb2-305" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Returns:</span></span>
<span id="cb2-306"><a href="#cb2-306" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - A reshaped dataset in long format with combined cardiovascular, depression, and</span></span>
<span id="cb2-307"><a href="#cb2-307" aria-hidden="true" tabindex="-1"></a>  <span class="co">#     cognitive data, ready for analysis.</span></span>
<span id="cb2-308"><a href="#cb2-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-309"><a href="#cb2-309" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pivot cardio dataset</span></span>
<span id="cb2-310"><a href="#cb2-310" aria-hidden="true" tabindex="-1"></a>  data_cardio <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb2-311"><a href="#cb2-311" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(</span>
<span id="cb2-312"><a href="#cb2-312" aria-hidden="true" tabindex="-1"></a>      <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"Cardio_risk"</span>),</span>
<span id="cb2-313"><a href="#cb2-313" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_to =</span> <span class="st">"Cardio_Year"</span>,</span>
<span id="cb2-314"><a href="#cb2-314" aria-hidden="true" tabindex="-1"></a>      <span class="at">values_to =</span> <span class="st">"Cardio_risk"</span></span>
<span id="cb2-315"><a href="#cb2-315" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb2-316"><a href="#cb2-316" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">!</span><span class="fu">any_of</span>(<span class="fu">c</span>(</span>
<span id="cb2-317"><a href="#cb2-317" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Cardio_Year"</span>, </span>
<span id="cb2-318"><a href="#cb2-318" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"cogfunction"</span>, <span class="dv">2016</span><span class="sc">:</span><span class="dv">2022</span>), </span>
<span id="cb2-319"><a href="#cb2-319" aria-hidden="true" tabindex="-1"></a>      <span class="fu">paste0</span>(<span class="st">"cog_score_"</span>, <span class="dv">2016</span><span class="sc">:</span><span class="dv">2022</span>)</span>
<span id="cb2-320"><a href="#cb2-320" aria-hidden="true" tabindex="-1"></a>      )))</span>
<span id="cb2-321"><a href="#cb2-321" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-322"><a href="#cb2-322" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Pivot dementia dataset</span></span>
<span id="cb2-323"><a href="#cb2-323" aria-hidden="true" tabindex="-1"></a>  data_dep <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb2-324"><a href="#cb2-324" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(</span>
<span id="cb2-325"><a href="#cb2-325" aria-hidden="true" tabindex="-1"></a>      <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"Total_dep"</span>),</span>
<span id="cb2-326"><a href="#cb2-326" aria-hidden="true" tabindex="-1"></a>      <span class="at">names_to =</span> <span class="st">"Dep_Year"</span>,</span>
<span id="cb2-327"><a href="#cb2-327" aria-hidden="true" tabindex="-1"></a>      <span class="at">values_to =</span> <span class="st">"Depression_score"</span></span>
<span id="cb2-328"><a href="#cb2-328" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb2-329"><a href="#cb2-329" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(ID, Depression_score)</span>
<span id="cb2-330"><a href="#cb2-330" aria-hidden="true" tabindex="-1"></a>           </span>
<span id="cb2-331"><a href="#cb2-331" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(cog_total <span class="sc">==</span> <span class="cn">FALSE</span>) {</span>
<span id="cb2-332"><a href="#cb2-332" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-333"><a href="#cb2-333" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Pivot cognition dataset</span></span>
<span id="cb2-334"><a href="#cb2-334" aria-hidden="true" tabindex="-1"></a>    data_cog <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb2-335"><a href="#cb2-335" aria-hidden="true" tabindex="-1"></a>      tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(</span>
<span id="cb2-336"><a href="#cb2-336" aria-hidden="true" tabindex="-1"></a>        <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"cogfunction"</span>),</span>
<span id="cb2-337"><a href="#cb2-337" aria-hidden="true" tabindex="-1"></a>        <span class="at">names_to =</span> <span class="st">"Wave"</span>,</span>
<span id="cb2-338"><a href="#cb2-338" aria-hidden="true" tabindex="-1"></a>        <span class="at">values_to =</span> <span class="st">"Status"</span></span>
<span id="cb2-339"><a href="#cb2-339" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span></span>
<span id="cb2-340"><a href="#cb2-340" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="sc">!</span><span class="fu">any_of</span>(<span class="fu">c</span>(</span>
<span id="cb2-341"><a href="#cb2-341" aria-hidden="true" tabindex="-1"></a>        <span class="fu">paste0</span>(<span class="st">"Cardio_risk_"</span>, <span class="dv">16</span><span class="sc">:</span><span class="dv">22</span>), </span>
<span id="cb2-342"><a href="#cb2-342" aria-hidden="true" tabindex="-1"></a>        <span class="fu">paste0</span>(<span class="st">"Total_dep_20"</span>, <span class="dv">16</span><span class="sc">:</span><span class="dv">22</span>))</span>
<span id="cb2-343"><a href="#cb2-343" aria-hidden="true" tabindex="-1"></a>        ))</span>
<span id="cb2-344"><a href="#cb2-344" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-345"><a href="#cb2-345" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding cardio data to cognition data</span></span>
<span id="cb2-346"><a href="#cb2-346" aria-hidden="true" tabindex="-1"></a>  combine_data <span class="ot">&lt;-</span> data_cog <span class="sc">|&gt;</span></span>
<span id="cb2-347"><a href="#cb2-347" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Cardio_risk =</span> data_cardio<span class="sc">$</span>Cardio_risk, <span class="at">.after =</span> Education_tri) <span class="sc">|&gt;</span></span>
<span id="cb2-348"><a href="#cb2-348" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Depression =</span> data_dep<span class="sc">$</span>Depression_score, <span class="at">.after =</span> Cardio_risk)</span>
<span id="cb2-349"><a href="#cb2-349" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-350"><a href="#cb2-350" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Producing final dataset</span></span>
<span id="cb2-351"><a href="#cb2-351" aria-hidden="true" tabindex="-1"></a>  final_data <span class="ot">&lt;-</span> combine_data <span class="sc">|&gt;</span></span>
<span id="cb2-352"><a href="#cb2-352" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb2-353"><a href="#cb2-353" aria-hidden="true" tabindex="-1"></a>      <span class="at">Wave =</span> stringr<span class="sc">::</span><span class="fu">str_replace</span>(Wave, <span class="st">"cogfunction"</span>, <span class="st">"HRS_"</span>),</span>
<span id="cb2-354"><a href="#cb2-354" aria-hidden="true" tabindex="-1"></a>      <span class="at">Wave =</span> <span class="fu">factor</span>(</span>
<span id="cb2-355"><a href="#cb2-355" aria-hidden="true" tabindex="-1"></a>        Wave,</span>
<span id="cb2-356"><a href="#cb2-356" aria-hidden="true" tabindex="-1"></a>        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"HRS_2016"</span>, <span class="st">"HRS_2018"</span>, <span class="st">"HRS_2020"</span>, <span class="st">"HRS_2022"</span>),</span>
<span id="cb2-357"><a href="#cb2-357" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)</span>
<span id="cb2-358"><a href="#cb2-358" aria-hidden="true" tabindex="-1"></a>      )) <span class="sc">|&gt;</span></span>
<span id="cb2-359"><a href="#cb2-359" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(ID) <span class="sc">|&gt;</span></span>
<span id="cb2-360"><a href="#cb2-360" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb2-361"><a href="#cb2-361" aria-hidden="true" tabindex="-1"></a>      <span class="at">Status =</span> <span class="fu">ifelse</span>(<span class="fu">cumany</span>(Status <span class="sc">==</span> <span class="st">"Dementia"</span>), <span class="st">"Dementia"</span>, Status),</span>
<span id="cb2-362"><a href="#cb2-362" aria-hidden="true" tabindex="-1"></a>      <span class="at">Status =</span> <span class="fu">factor</span>(</span>
<span id="cb2-363"><a href="#cb2-363" aria-hidden="true" tabindex="-1"></a>        Status,</span>
<span id="cb2-364"><a href="#cb2-364" aria-hidden="true" tabindex="-1"></a>        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Normal Cognition"</span>, <span class="st">"MCI"</span>, <span class="st">"Dementia"</span>),</span>
<span id="cb2-365"><a href="#cb2-365" aria-hidden="true" tabindex="-1"></a>        <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb2-366"><a href="#cb2-366" aria-hidden="true" tabindex="-1"></a>      )) <span class="sc">|&gt;</span></span>
<span id="cb2-367"><a href="#cb2-367" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb2-368"><a href="#cb2-368" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb2-369"><a href="#cb2-369" aria-hidden="true" tabindex="-1"></a>      <span class="at">Gender =</span> <span class="fu">factor</span>(Gender, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)),</span>
<span id="cb2-370"><a href="#cb2-370" aria-hidden="true" tabindex="-1"></a>      <span class="at">Education_tri =</span> <span class="fu">factor</span>(Education_tri, <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>)),</span>
<span id="cb2-371"><a href="#cb2-371" aria-hidden="true" tabindex="-1"></a>      <span class="at">Wave =</span> <span class="fu">as.numeric</span>(Wave),</span>
<span id="cb2-372"><a href="#cb2-372" aria-hidden="true" tabindex="-1"></a>      <span class="at">Status =</span> <span class="fu">as.numeric</span>(Status)</span>
<span id="cb2-373"><a href="#cb2-373" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-374"><a href="#cb2-374" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb2-375"><a href="#cb2-375" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-376"><a href="#cb2-376" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Pivot cog total data</span></span>
<span id="cb2-377"><a href="#cb2-377" aria-hidden="true" tabindex="-1"></a>    data_score <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb2-378"><a href="#cb2-378" aria-hidden="true" tabindex="-1"></a>      tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(</span>
<span id="cb2-379"><a href="#cb2-379" aria-hidden="true" tabindex="-1"></a>        <span class="at">cols =</span> <span class="fu">starts_with</span>(<span class="st">"cog_score"</span>),</span>
<span id="cb2-380"><a href="#cb2-380" aria-hidden="true" tabindex="-1"></a>        <span class="at">names_to =</span> <span class="st">"Wave"</span>,</span>
<span id="cb2-381"><a href="#cb2-381" aria-hidden="true" tabindex="-1"></a>        <span class="at">values_to =</span> <span class="st">"Score"</span></span>
<span id="cb2-382"><a href="#cb2-382" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span></span>
<span id="cb2-383"><a href="#cb2-383" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(</span>
<span id="cb2-384"><a href="#cb2-384" aria-hidden="true" tabindex="-1"></a>        <span class="at">Wave =</span> stringr<span class="sc">::</span><span class="fu">str_replace</span>(Wave, <span class="st">"cog_score_"</span>, <span class="st">""</span>),</span>
<span id="cb2-385"><a href="#cb2-385" aria-hidden="true" tabindex="-1"></a>        <span class="at">Wave =</span> <span class="fu">factor</span>(</span>
<span id="cb2-386"><a href="#cb2-386" aria-hidden="true" tabindex="-1"></a>          Wave, </span>
<span id="cb2-387"><a href="#cb2-387" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"2016"</span>, <span class="st">"2018"</span>, <span class="st">"2020"</span>, <span class="st">"2022"</span>),</span>
<span id="cb2-388"><a href="#cb2-388" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)),</span>
<span id="cb2-389"><a href="#cb2-389" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb2-390"><a href="#cb2-390" aria-hidden="true" tabindex="-1"></a>        <span class="at">Gender =</span> <span class="fu">as.factor</span>(Gender),</span>
<span id="cb2-391"><a href="#cb2-391" aria-hidden="true" tabindex="-1"></a>        <span class="at">Education_tri =</span> <span class="fu">as.factor</span>(Education_tri)</span>
<span id="cb2-392"><a href="#cb2-392" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span></span>
<span id="cb2-393"><a href="#cb2-393" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(<span class="sc">!</span><span class="fu">any_of</span>(<span class="fu">c</span>(</span>
<span id="cb2-394"><a href="#cb2-394" aria-hidden="true" tabindex="-1"></a>        <span class="fu">paste0</span>(<span class="st">"Cardio_risk_"</span>, <span class="dv">16</span><span class="sc">:</span><span class="dv">22</span>), </span>
<span id="cb2-395"><a href="#cb2-395" aria-hidden="true" tabindex="-1"></a>        <span class="fu">paste0</span>(<span class="st">"Total_dep_20"</span>, <span class="dv">16</span><span class="sc">:</span><span class="dv">22</span>))</span>
<span id="cb2-396"><a href="#cb2-396" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb2-397"><a href="#cb2-397" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-398"><a href="#cb2-398" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Combine cardio and cog total data</span></span>
<span id="cb2-399"><a href="#cb2-399" aria-hidden="true" tabindex="-1"></a>    final_data <span class="ot">&lt;-</span> data_score <span class="sc">|&gt;</span></span>
<span id="cb2-400"><a href="#cb2-400" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">Cardio_risk =</span> data_cardio<span class="sc">$</span>Cardio_risk, <span class="at">.after =</span> Education_tri) <span class="sc">|&gt;</span></span>
<span id="cb2-401"><a href="#cb2-401" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">Depression =</span> data_dep<span class="sc">$</span>Depression_score, <span class="at">.after =</span> Cardio_risk)</span>
<span id="cb2-402"><a href="#cb2-402" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-403"><a href="#cb2-403" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-404"><a href="#cb2-404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(final_data)</span>
<span id="cb2-405"><a href="#cb2-405" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-406"><a href="#cb2-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-407"><a href="#cb2-407" aria-hidden="true" tabindex="-1"></a>gentleman_test <span class="ot">&lt;-</span> <span class="cf">function</span>(data, model) {</span>
<span id="cb2-408"><a href="#cb2-408" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compares observed and expected prevalence of cognitive states (Normal Cognition, MCI, Dementia)</span></span>
<span id="cb2-409"><a href="#cb2-409" aria-hidden="true" tabindex="-1"></a>  <span class="co"># over time. Reshapes the observed and expected data into a long format and generates a</span></span>
<span id="cb2-410"><a href="#cb2-410" aria-hidden="true" tabindex="-1"></a>  <span class="co"># faceted line plot to visualize the comparison.</span></span>
<span id="cb2-411"><a href="#cb2-411" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Arguments:</span></span>
<span id="cb2-412"><a href="#cb2-412" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - data: A list containing observed and expected prevalence data.</span></span>
<span id="cb2-413"><a href="#cb2-413" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - model: A string representing the model name, used in the plot title.</span></span>
<span id="cb2-414"><a href="#cb2-414" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Returns:</span></span>
<span id="cb2-415"><a href="#cb2-415" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - A ggplot object displaying the observed vs. expected prevalence of cognitive states</span></span>
<span id="cb2-416"><a href="#cb2-416" aria-hidden="true" tabindex="-1"></a>  <span class="co">#     over time.</span></span>
<span id="cb2-417"><a href="#cb2-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-418"><a href="#cb2-418" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reshaping observed prevalence</span></span>
<span id="cb2-419"><a href="#cb2-419" aria-hidden="true" tabindex="-1"></a>  do1 <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">row.names</span>(data<span class="sc">$</span>Observed)) <span class="sc">|&gt;</span></span>
<span id="cb2-420"><a href="#cb2-420" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">time =</span> value) <span class="sc">|&gt;</span></span>
<span id="cb2-421"><a href="#cb2-421" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">as.numeric</span>(time))</span>
<span id="cb2-422"><a href="#cb2-422" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-423"><a href="#cb2-423" aria-hidden="true" tabindex="-1"></a>  do2 <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(data<span class="sc">$</span>Observed) <span class="sc">|&gt;</span> </span>
<span id="cb2-424"><a href="#cb2-424" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">"observed"</span>)</span>
<span id="cb2-425"><a href="#cb2-425" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-426"><a href="#cb2-426" aria-hidden="true" tabindex="-1"></a>  do <span class="ot">&lt;-</span> <span class="fu">cbind</span>(do1, do2) <span class="sc">|&gt;</span></span>
<span id="cb2-427"><a href="#cb2-427" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>Total) <span class="sc">|&gt;</span></span>
<span id="cb2-428"><a href="#cb2-428" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">gather</span>(state, number, <span class="sc">-</span><span class="fu">c</span>(time, type)) <span class="sc">|&gt;</span></span>
<span id="cb2-429"><a href="#cb2-429" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">state =</span> <span class="fu">case_when</span>(state <span class="sc">==</span> <span class="st">"State 1"</span> <span class="sc">~</span> <span class="st">"Normal Cognition"</span>,</span>
<span id="cb2-430"><a href="#cb2-430" aria-hidden="true" tabindex="-1"></a>                             state <span class="sc">==</span> <span class="st">"State 2"</span> <span class="sc">~</span> <span class="st">"MCI"</span>,</span>
<span id="cb2-431"><a href="#cb2-431" aria-hidden="true" tabindex="-1"></a>                             state <span class="sc">==</span> <span class="st">"State 3"</span> <span class="sc">~</span> <span class="st">"Dementia"</span>))</span>
<span id="cb2-432"><a href="#cb2-432" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-433"><a href="#cb2-433" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Reshaping expected prevalence</span></span>
<span id="cb2-434"><a href="#cb2-434" aria-hidden="true" tabindex="-1"></a>  de1 <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">row.names</span>(data<span class="sc">$</span>Expected)) <span class="sc">|&gt;</span></span>
<span id="cb2-435"><a href="#cb2-435" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">time =</span> value) <span class="sc">|&gt;</span></span>
<span id="cb2-436"><a href="#cb2-436" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">time =</span> <span class="fu">as.numeric</span>(time))</span>
<span id="cb2-437"><a href="#cb2-437" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-438"><a href="#cb2-438" aria-hidden="true" tabindex="-1"></a>  de2 <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(data<span class="sc">$</span>Expected) <span class="sc">|&gt;</span></span>
<span id="cb2-439"><a href="#cb2-439" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">type =</span> <span class="st">"expected"</span>)</span>
<span id="cb2-440"><a href="#cb2-440" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-441"><a href="#cb2-441" aria-hidden="true" tabindex="-1"></a>  de <span class="ot">&lt;-</span> <span class="fu">cbind</span>(de1,de2) <span class="sc">|&gt;</span></span>
<span id="cb2-442"><a href="#cb2-442" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="sc">-</span>Total) <span class="sc">|&gt;</span></span>
<span id="cb2-443"><a href="#cb2-443" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">gather</span>(state, number, <span class="sc">-</span><span class="fu">c</span>(time, type))</span>
<span id="cb2-444"><a href="#cb2-444" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-445"><a href="#cb2-445" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Turn into single data frame and plotting</span></span>
<span id="cb2-446"><a href="#cb2-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(do, de) <span class="sc">|&gt;</span></span>
<span id="cb2-447"><a href="#cb2-447" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">type =</span> <span class="fu">factor</span>(type),</span>
<span id="cb2-448"><a href="#cb2-448" aria-hidden="true" tabindex="-1"></a>           <span class="at">state =</span> <span class="fu">factor</span>(state, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Normal Cognition"</span>, <span class="st">"MCI"</span>, <span class="st">"Dementia"</span>)),</span>
<span id="cb2-449"><a href="#cb2-449" aria-hidden="true" tabindex="-1"></a>           <span class="at">time =</span> <span class="fu">round</span>(time,<span class="dv">3</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-450"><a href="#cb2-450" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(state) <span class="sc">|&gt;</span></span>
<span id="cb2-451"><a href="#cb2-451" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time, <span class="at">y =</span> number, <span class="at">colour =</span> type)) <span class="sc">+</span></span>
<span id="cb2-452"><a href="#cb2-452" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2-453"><a href="#cb2-453" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"Observed vs Fitted Values: "</span>, model), <span class="at">x =</span> <span class="st">"Time"</span>, <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb2-454"><a href="#cb2-454" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span> state) <span class="sc">+</span></span>
<span id="cb2-455"><a href="#cb2-455" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb2-456"><a href="#cb2-456" aria-hidden="true" tabindex="-1"></a>    ggeasy<span class="sc">::</span><span class="fu">easy_remove_legend_title</span>()</span>
<span id="cb2-457"><a href="#cb2-457" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-458"><a href="#cb2-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-459"><a href="#cb2-459" aria-hidden="true" tabindex="-1"></a>process_hr <span class="ot">&lt;-</span> <span class="cf">function</span>(data, <span class="at">fix_upper =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb2-460"><a href="#cb2-460" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Processes hazard ratio (HR) data by cleaning and reshaping it for visualization.</span></span>
<span id="cb2-461"><a href="#cb2-461" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Converts covariate names into descriptive labels and ensures proper formatting</span></span>
<span id="cb2-462"><a href="#cb2-462" aria-hidden="true" tabindex="-1"></a>  <span class="co"># of transitions and confidence intervals. Optionally fixes upper confidence intervals</span></span>
<span id="cb2-463"><a href="#cb2-463" aria-hidden="true" tabindex="-1"></a>  <span class="co"># that exceed a specified threshold.</span></span>
<span id="cb2-464"><a href="#cb2-464" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Arguments:</span></span>
<span id="cb2-465"><a href="#cb2-465" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - data: The input dataset containing hazard ratio data.</span></span>
<span id="cb2-466"><a href="#cb2-466" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - fix_upper: A logical flag indicating whether to fix upper confidence intervals</span></span>
<span id="cb2-467"><a href="#cb2-467" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                that exceed a threshold (default: TRUE).</span></span>
<span id="cb2-468"><a href="#cb2-468" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Returns:</span></span>
<span id="cb2-469"><a href="#cb2-469" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - A cleaned and reshaped dataset ready for hazard ratio visualization.</span></span>
<span id="cb2-470"><a href="#cb2-470" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-471"><a href="#cb2-471" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">do.call</span>(rbind.data.frame, data) <span class="sc">|&gt;</span></span>
<span id="cb2-472"><a href="#cb2-472" aria-hidden="true" tabindex="-1"></a>    tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"Covariate"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-473"><a href="#cb2-473" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">separate_wider_delim</span>(<span class="at">cols =</span> Covariate, </span>
<span id="cb2-474"><a href="#cb2-474" aria-hidden="true" tabindex="-1"></a>                                <span class="at">delim =</span> <span class="st">"."</span>, </span>
<span id="cb2-475"><a href="#cb2-475" aria-hidden="true" tabindex="-1"></a>                                <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"Covariate"</span>, <span class="st">"Transition"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb2-476"><a href="#cb2-476" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Covariate =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-477"><a href="#cb2-477" aria-hidden="true" tabindex="-1"></a>      Covariate <span class="sc">==</span> <span class="st">"Gender1"</span> <span class="sc">~</span> <span class="st">"Female"</span>,</span>
<span id="cb2-478"><a href="#cb2-478" aria-hidden="true" tabindex="-1"></a>      Covariate <span class="sc">==</span> <span class="st">"Education_tri1"</span> <span class="sc">~</span> <span class="st">"High School"</span>,</span>
<span id="cb2-479"><a href="#cb2-479" aria-hidden="true" tabindex="-1"></a>      Covariate <span class="sc">==</span> <span class="st">"Education_tri2"</span> <span class="sc">~</span> <span class="st">"College"</span>,</span>
<span id="cb2-480"><a href="#cb2-480" aria-hidden="true" tabindex="-1"></a>      Covariate <span class="sc">==</span> <span class="st">"Cardio_risk"</span> <span class="sc">~</span> <span class="st">"Cardiovascular Risk"</span>,</span>
<span id="cb2-481"><a href="#cb2-481" aria-hidden="true" tabindex="-1"></a>      Covariate <span class="sc">==</span> <span class="st">"Depression"</span> <span class="sc">~</span> <span class="st">"Depression"</span>,</span>
<span id="cb2-482"><a href="#cb2-482" aria-hidden="true" tabindex="-1"></a>      Covariate <span class="sc">==</span> <span class="st">"Total_p"</span> <span class="sc">~</span> <span class="st">"Total Procrastination"</span>,</span>
<span id="cb2-483"><a href="#cb2-483" aria-hidden="true" tabindex="-1"></a>      Covariate <span class="sc">==</span> <span class="st">"Depression:Total_p"</span> <span class="sc">~</span> <span class="st">"Depression x Procrastination"</span>,</span>
<span id="cb2-484"><a href="#cb2-484" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> Covariate),</span>
<span id="cb2-485"><a href="#cb2-485" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb2-486"><a href="#cb2-486" aria-hidden="true" tabindex="-1"></a>      <span class="at">Covariate =</span> <span class="fu">factor</span>(</span>
<span id="cb2-487"><a href="#cb2-487" aria-hidden="true" tabindex="-1"></a>        Covariate, </span>
<span id="cb2-488"><a href="#cb2-488" aria-hidden="true" tabindex="-1"></a>        <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Female"</span>, <span class="st">"Age"</span>, <span class="st">"High School"</span>, <span class="st">"College"</span>, </span>
<span id="cb2-489"><a href="#cb2-489" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Cardiovascular Risk"</span>, <span class="st">"Depression"</span>, </span>
<span id="cb2-490"><a href="#cb2-490" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"Total Procrastination"</span>, <span class="st">"Depression x Procrastination"</span>))</span>
<span id="cb2-491"><a href="#cb2-491" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span></span>
<span id="cb2-492"><a href="#cb2-492" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Transition =</span> <span class="fu">factor</span>(</span>
<span id="cb2-493"><a href="#cb2-493" aria-hidden="true" tabindex="-1"></a>      Transition, </span>
<span id="cb2-494"><a href="#cb2-494" aria-hidden="true" tabindex="-1"></a>      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Normal Cognition - MCI"</span>, </span>
<span id="cb2-495"><a href="#cb2-495" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"Normal Cognition - Dementia"</span>,</span>
<span id="cb2-496"><a href="#cb2-496" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"MCI - Normal Cognition"</span>,</span>
<span id="cb2-497"><a href="#cb2-497" aria-hidden="true" tabindex="-1"></a>                 <span class="st">"MCI - Dementia"</span>)))</span>
<span id="cb2-498"><a href="#cb2-498" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-499"><a href="#cb2-499" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(fix_upper <span class="sc">==</span> <span class="cn">TRUE</span>){</span>
<span id="cb2-500"><a href="#cb2-500" aria-hidden="true" tabindex="-1"></a>    data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb2-501"><a href="#cb2-501" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">U =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-502"><a href="#cb2-502" aria-hidden="true" tabindex="-1"></a>        U <span class="sc">&gt;=</span> <span class="dv">5</span> <span class="sc">&amp;</span> Transition <span class="sc">==</span> <span class="st">"Normal Cognition - Dementia"</span> <span class="sc">~</span> HR,</span>
<span id="cb2-503"><a href="#cb2-503" aria-hidden="true" tabindex="-1"></a>        <span class="co"># U &gt;= 5 &amp; HR &lt; 1 ~ 1,</span></span>
<span id="cb2-504"><a href="#cb2-504" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> U</span>
<span id="cb2-505"><a href="#cb2-505" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb2-506"><a href="#cb2-506" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-507"><a href="#cb2-507" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-508"><a href="#cb2-508" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(data)</span>
<span id="cb2-509"><a href="#cb2-509" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-510"><a href="#cb2-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-511"><a href="#cb2-511" aria-hidden="true" tabindex="-1"></a>calculate_p_value <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb2-512"><a href="#cb2-512" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculates p-values for hazard ratios (HR) based on log-transformed HR values and</span></span>
<span id="cb2-513"><a href="#cb2-513" aria-hidden="true" tabindex="-1"></a>  <span class="co"># their confidence intervals. Adds the calculated p-values to the input dataset.</span></span>
<span id="cb2-514"><a href="#cb2-514" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Arguments:</span></span>
<span id="cb2-515"><a href="#cb2-515" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - data: The input dataset containing hazard ratios and confidence intervals.</span></span>
<span id="cb2-516"><a href="#cb2-516" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Returns:</span></span>
<span id="cb2-517"><a href="#cb2-517" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - The input dataset with an additional column for p-values</span></span>
<span id="cb2-518"><a href="#cb2-518" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-519"><a href="#cb2-519" aria-hidden="true" tabindex="-1"></a>  log_HR <span class="ot">&lt;-</span> <span class="fu">log</span>(data<span class="sc">$</span>HR)</span>
<span id="cb2-520"><a href="#cb2-520" aria-hidden="true" tabindex="-1"></a>  log_lower_CI <span class="ot">&lt;-</span> <span class="fu">log</span>(data<span class="sc">$</span>L)</span>
<span id="cb2-521"><a href="#cb2-521" aria-hidden="true" tabindex="-1"></a>  log_upper_CI <span class="ot">&lt;-</span> <span class="fu">log</span>(data<span class="sc">$</span>U)</span>
<span id="cb2-522"><a href="#cb2-522" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-523"><a href="#cb2-523" aria-hidden="true" tabindex="-1"></a>  SE <span class="ot">&lt;-</span> (log_upper_CI <span class="sc">-</span> log_lower_CI) <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> <span class="fl">1.96</span>)</span>
<span id="cb2-524"><a href="#cb2-524" aria-hidden="true" tabindex="-1"></a>  Z <span class="ot">&lt;-</span> log_HR <span class="sc">/</span> SE</span>
<span id="cb2-525"><a href="#cb2-525" aria-hidden="true" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(Z)))</span>
<span id="cb2-526"><a href="#cb2-526" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-527"><a href="#cb2-527" aria-hidden="true" tabindex="-1"></a>  data<span class="sc">$</span>pval <span class="ot">&lt;-</span> p_value <span class="sc">|&gt;</span> <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb2-528"><a href="#cb2-528" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-529"><a href="#cb2-529" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(data)</span>
<span id="cb2-530"><a href="#cb2-530" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-531"><a href="#cb2-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-532"><a href="#cb2-532" aria-hidden="true" tabindex="-1"></a>plot_hr <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb2-533"><a href="#cb2-533" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generates a forest plot of hazard ratios (HR) for cognitive transitions, including</span></span>
<span id="cb2-534"><a href="#cb2-534" aria-hidden="true" tabindex="-1"></a>  <span class="co"># confidence intervals and significance stars. Customizes the plot based on covariate</span></span>
<span id="cb2-535"><a href="#cb2-535" aria-hidden="true" tabindex="-1"></a>  <span class="co"># labels and ensures proper formatting for visualization.</span></span>
<span id="cb2-536"><a href="#cb2-536" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Arguments:</span></span>
<span id="cb2-537"><a href="#cb2-537" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - data: The input dataset containing hazard ratios, confidence intervals, and p-values.</span></span>
<span id="cb2-538"><a href="#cb2-538" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Returns:</span></span>
<span id="cb2-539"><a href="#cb2-539" aria-hidden="true" tabindex="-1"></a>  <span class="co">#   - A ggplot object displaying hazard ratios for cognitive transitions, faceted by covariate.</span></span>
<span id="cb2-540"><a href="#cb2-540" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-541"><a href="#cb2-541" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Making a plot customization</span></span>
<span id="cb2-542"><a href="#cb2-542" aria-hidden="true" tabindex="-1"></a>  labeller <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb2-543"><a href="#cb2-543" aria-hidden="true" tabindex="-1"></a>    <span class="at">Female =</span> <span class="st">"Being female vs. Male"</span>,</span>
<span id="cb2-544"><a href="#cb2-544" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">High School</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Having a highshool education vs. No education"</span>,</span>
<span id="cb2-545"><a href="#cb2-545" aria-hidden="true" tabindex="-1"></a>    <span class="at">College =</span> <span class="st">"Having a further education vs. No education"</span>,</span>
<span id="cb2-546"><a href="#cb2-546" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Cardiovascular Risk</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Total number of cardiovascular risk factors"</span>,</span>
<span id="cb2-547"><a href="#cb2-547" aria-hidden="true" tabindex="-1"></a>    <span class="at">Depression =</span> <span class="st">"Depression"</span>,</span>
<span id="cb2-548"><a href="#cb2-548" aria-hidden="true" tabindex="-1"></a>    <span class="at">Total_p =</span> <span class="st">"Procrastination"</span>,</span>
<span id="cb2-549"><a href="#cb2-549" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Depression x Procrastination</span><span class="st">`</span> <span class="ot">=</span> <span class="st">"Depression x Procrastination"</span></span>
<span id="cb2-550"><a href="#cb2-550" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-551"><a href="#cb2-551" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-552"><a href="#cb2-552" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add a column for significance stars</span></span>
<span id="cb2-553"><a href="#cb2-553" aria-hidden="true" tabindex="-1"></a>  data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb2-554"><a href="#cb2-554" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb2-555"><a href="#cb2-555" aria-hidden="true" tabindex="-1"></a>      <span class="at">stars =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-556"><a href="#cb2-556" aria-hidden="true" tabindex="-1"></a>        pval <span class="sc">&lt;</span> <span class="fl">0.001</span> <span class="sc">~</span> <span class="st">"***"</span>,</span>
<span id="cb2-557"><a href="#cb2-557" aria-hidden="true" tabindex="-1"></a>        pval <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">~</span> <span class="st">"**"</span>,</span>
<span id="cb2-558"><a href="#cb2-558" aria-hidden="true" tabindex="-1"></a>        pval <span class="sc">&lt;</span> <span class="fl">0.05</span> <span class="sc">~</span> <span class="st">"*"</span>,</span>
<span id="cb2-559"><a href="#cb2-559" aria-hidden="true" tabindex="-1"></a>        pval <span class="sc">&lt;</span> <span class="fl">0.10</span> <span class="sc">~</span> <span class="st">"+"</span>,</span>
<span id="cb2-560"><a href="#cb2-560" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">""</span> </span>
<span id="cb2-561"><a href="#cb2-561" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb2-562"><a href="#cb2-562" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-563"><a href="#cb2-563" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plotting  </span></span>
<span id="cb2-564"><a href="#cb2-564" aria-hidden="true" tabindex="-1"></a>  haz_plot <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb2-565"><a href="#cb2-565" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> HR, <span class="at">y =</span> forcats<span class="sc">::</span><span class="fu">fct_rev</span>(Transition), <span class="at">colour =</span> HR <span class="sc">&gt;</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb2-566"><a href="#cb2-566" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">4</span>) <span class="sc">+</span></span>
<span id="cb2-567"><a href="#cb2-567" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_linerange</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> L, <span class="at">xmax =</span> U), <span class="at">linewidth =</span> <span class="fl">1.5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb2-568"><a href="#cb2-568" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">1</span>, <span class="at">colour =</span> <span class="st">"gray75"</span>, <span class="at">linewidth =</span> <span class="fl">0.75</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb2-569"><a href="#cb2-569" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> stars), <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb2-570"><a href="#cb2-570" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Hazard Ratio for dementia transitions"</span>,</span>
<span id="cb2-571"><a href="#cb2-571" aria-hidden="true" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">"Hazard Ratio (95% Confidence Interval)"</span>, </span>
<span id="cb2-572"><a href="#cb2-572" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">""</span>) <span class="sc">+</span></span>
<span id="cb2-573"><a href="#cb2-573" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>), <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb2-574"><a href="#cb2-574" aria-hidden="true" tabindex="-1"></a>    <span class="fu">guides</span>(<span class="at">colour =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb2-575"><a href="#cb2-575" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb2-576"><a href="#cb2-576" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb2-577"><a href="#cb2-577" aria-hidden="true" tabindex="-1"></a>      <span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">size =</span> <span class="dv">14</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb2-578"><a href="#cb2-578" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb2-579"><a href="#cb2-579" aria-hidden="true" tabindex="-1"></a>      <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>)</span>
<span id="cb2-580"><a href="#cb2-580" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb2-581"><a href="#cb2-581" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-582"><a href="#cb2-582" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(data) <span class="sc">==</span> <span class="dv">32</span>){</span>
<span id="cb2-583"><a href="#cb2-583" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Centering the bottom facet because I am pedantic</span></span>
<span id="cb2-584"><a href="#cb2-584" aria-hidden="true" tabindex="-1"></a>    haz_plot <span class="ot">&lt;-</span> haz_plot <span class="sc">+</span> ggh4x<span class="sc">::</span><span class="fu">facet_manual</span>(</span>
<span id="cb2-585"><a href="#cb2-585" aria-hidden="true" tabindex="-1"></a>    <span class="sc">~</span> Covariate,</span>
<span id="cb2-586"><a href="#cb2-586" aria-hidden="true" tabindex="-1"></a>    <span class="at">scales =</span> <span class="st">"free_x"</span>,</span>
<span id="cb2-587"><a href="#cb2-587" aria-hidden="true" tabindex="-1"></a>    <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">Covariate =</span> labeller),</span>
<span id="cb2-588"><a href="#cb2-588" aria-hidden="true" tabindex="-1"></a>    <span class="at">design =</span> <span class="fu">c</span>(</span>
<span id="cb2-589"><a href="#cb2-589" aria-hidden="true" tabindex="-1"></a>    <span class="st">"</span></span>
<span id="cb2-590"><a href="#cb2-590" aria-hidden="true" tabindex="-1"></a><span class="st">    AABBCC</span></span>
<span id="cb2-591"><a href="#cb2-591" aria-hidden="true" tabindex="-1"></a><span class="st">    DDEEFF</span></span>
<span id="cb2-592"><a href="#cb2-592" aria-hidden="true" tabindex="-1"></a><span class="st">    #GGHH#</span></span>
<span id="cb2-593"><a href="#cb2-593" aria-hidden="true" tabindex="-1"></a><span class="st">    "</span></span>
<span id="cb2-594"><a href="#cb2-594" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb2-595"><a href="#cb2-595" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb2-596"><a href="#cb2-596" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Centering the bottom facet because I am pedantic</span></span>
<span id="cb2-597"><a href="#cb2-597" aria-hidden="true" tabindex="-1"></a>    haz_plot <span class="ot">&lt;-</span> haz_plot <span class="sc">+</span> ggh4x<span class="sc">::</span><span class="fu">facet_manual</span>(</span>
<span id="cb2-598"><a href="#cb2-598" aria-hidden="true" tabindex="-1"></a>      <span class="sc">~</span> Covariate,</span>
<span id="cb2-599"><a href="#cb2-599" aria-hidden="true" tabindex="-1"></a>      <span class="at">scales =</span> <span class="st">"free_x"</span>,</span>
<span id="cb2-600"><a href="#cb2-600" aria-hidden="true" tabindex="-1"></a>      <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">Covariate =</span> labeller),</span>
<span id="cb2-601"><a href="#cb2-601" aria-hidden="true" tabindex="-1"></a>      <span class="at">design =</span> <span class="fu">c</span>(</span>
<span id="cb2-602"><a href="#cb2-602" aria-hidden="true" tabindex="-1"></a>      <span class="st">"</span></span>
<span id="cb2-603"><a href="#cb2-603" aria-hidden="true" tabindex="-1"></a><span class="st">      AABBCC</span></span>
<span id="cb2-604"><a href="#cb2-604" aria-hidden="true" tabindex="-1"></a><span class="st">      DDEEFF</span></span>
<span id="cb2-605"><a href="#cb2-605" aria-hidden="true" tabindex="-1"></a><span class="st">      ##GG##</span></span>
<span id="cb2-606"><a href="#cb2-606" aria-hidden="true" tabindex="-1"></a><span class="st">      "</span></span>
<span id="cb2-607"><a href="#cb2-607" aria-hidden="true" tabindex="-1"></a>      ))</span>
<span id="cb2-608"><a href="#cb2-608" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-609"><a href="#cb2-609" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-610"><a href="#cb2-610" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(haz_plot)</span>
<span id="cb2-611"><a href="#cb2-611" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="reading-in-data" class="level3">
<h3 class="anchored" data-anchor-id="reading-in-data">Reading in data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">34521</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"analysis/data/data.csv"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="markov-modelling" class="level2">
<h2 class="anchored" data-anchor-id="markov-modelling">Markov Modelling</h2>
<p>In this section, we apply Markov modelling to analyze the transitions between cognitive states (Normal Cognition, Mild Cognitive Impairment [MCI], and Dementia) using longitudinal data from the Health and Retirement Study (HRS) from 2016 to 2022. By modeling these transitions, we aim to understand the probabilities of moving between different cognitive states over time.</p>
<section id="data-preparation" class="level3">
<h3 class="anchored" data-anchor-id="data-preparation">Data preparation</h3>
<p>The first step is to prepare the transition dataset. We start by transforming the data to create a record of transitions from one cognitive state to another between consecutive waves.</p>
<p>Once the transitions are identified, we calculate the probabilities of each state-to-state transition. These probabilities are computed by counting the occurrences of each transition and dividing by the total number of transitions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>tran_prob <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_years</span>(<span class="at">years =</span> <span class="fu">seq</span>(<span class="dv">2016</span>, <span class="dv">2022</span>, <span class="at">by =</span> <span class="dv">2</span>)) <span class="sc">|&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">create_transitions</span>(<span class="at">absorbing =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate_probabilties</span>()</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>tran_prob <span class="sc">|&gt;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop =</span> <span class="fu">round</span>(prop, <span class="at">digits =</span> <span class="dv">3</span>)) <span class="sc">|&gt;</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">head</span>(<span class="at">n =</span> <span class="dv">9</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  gtExtras<span class="sc">::</span><span class="fu">gt_theme_538</span>() <span class="sc">|&gt;</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">cols_align</span>(<span class="at">align =</span> <span class="st">"center"</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_header</span>(<span class="at">title =</span> <span class="st">"Overall Transition Probabilties (2016 - 2022)"</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_options</span>(<span class="at">table.width =</span> gt<span class="sc">::</span><span class="fu">pct</span>(<span class="dv">100</span>)) <span class="sc">|&gt;</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">opt_align_table_header</span>(<span class="at">align =</span> <span class="st">"center"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="pfortlxarm" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Chivo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
@import url("https://fonts.googleapis.com/css2?family=Cairo:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap");
#pfortlxarm table {
  font-family: Cairo, system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#pfortlxarm thead, #pfortlxarm tbody, #pfortlxarm tfoot, #pfortlxarm tr, #pfortlxarm td, #pfortlxarm th {
  border-style: none;
}

#pfortlxarm p {
  margin: 0;
  padding: 0;
}

#pfortlxarm .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: 400;
  font-style: normal;
  background-color: #FFFFFF;
  width: 100%;
  border-top-style: none;
  border-top-width: 3px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pfortlxarm .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pfortlxarm .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pfortlxarm .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pfortlxarm .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pfortlxarm .gt_bottom_border {
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pfortlxarm .gt_col_headings {
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pfortlxarm .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pfortlxarm .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pfortlxarm .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pfortlxarm .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pfortlxarm .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #000000;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pfortlxarm .gt_spanner_row {
  border-bottom-style: hidden;
}

#pfortlxarm .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pfortlxarm .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: none;
  border-top-width: 2px;
  border-top-color: #000000;
  border-bottom-style: solid;
  border-bottom-width: 1px;
  border-bottom-color: #FFFFFF;
  vertical-align: middle;
}

#pfortlxarm .gt_from_md > :first-child {
  margin-top: 0;
}

#pfortlxarm .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pfortlxarm .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pfortlxarm .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 0px;
  border-right-color: #FFFFFF;
  padding-left: 5px;
  padding-right: 5px;
}

#pfortlxarm .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pfortlxarm .gt_row_group_first td {
  border-top-width: 2px;
}

#pfortlxarm .gt_row_group_first th {
  border-top-width: 2px;
}

#pfortlxarm .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pfortlxarm .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pfortlxarm .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pfortlxarm .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pfortlxarm .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pfortlxarm .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pfortlxarm .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#pfortlxarm .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pfortlxarm .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pfortlxarm .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pfortlxarm .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pfortlxarm .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pfortlxarm .gt_sourcenote {
  font-size: 12px;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pfortlxarm .gt_left {
  text-align: left;
}

#pfortlxarm .gt_center {
  text-align: center;
}

#pfortlxarm .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pfortlxarm .gt_font_normal {
  font-weight: normal;
}

#pfortlxarm .gt_font_bold {
  font-weight: bold;
}

#pfortlxarm .gt_font_italic {
  font-style: italic;
}

#pfortlxarm .gt_super {
  font-size: 65%;
}

#pfortlxarm .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#pfortlxarm .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pfortlxarm .gt_indent_1 {
  text-indent: 5px;
}

#pfortlxarm .gt_indent_2 {
  text-indent: 10px;
}

#pfortlxarm .gt_indent_3 {
  text-indent: 15px;
}

#pfortlxarm .gt_indent_4 {
  text-indent: 20px;
}

#pfortlxarm .gt_indent_5 {
  text-indent: 25px;
}

#pfortlxarm .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#pfortlxarm div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}

tbody tr:last-child {
  border-bottom: 2px solid #ffffff00;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="4" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="font-family: Chivo; font-weight: 700">Overall Transition Probabilties (2016 - 2022)</th>
</tr>
<tr class="gt_col_headings even">
<th id="from" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">from</th>
<th id="to" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">to</th>
<th id="n" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">n</th>
<th id="prop" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" style="border-top-width: 0px; border-top-style: solid; border-top-color: black; font-family: Chivo; font-size: 14px; vertical-align: bottom; font-weight: 200; text-transform: uppercase" scope="col">prop</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_center" headers="from">Normal Cognition</td>
<td class="gt_row gt_center" headers="to">Normal Cognition</td>
<td class="gt_row gt_center" headers="n">2090</td>
<td class="gt_row gt_center" headers="prop">0.755</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="from">Normal Cognition</td>
<td class="gt_row gt_center" headers="to">MCI</td>
<td class="gt_row gt_center" headers="n">224</td>
<td class="gt_row gt_center" headers="prop">0.081</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="from">Normal Cognition</td>
<td class="gt_row gt_center" headers="to">Dementia</td>
<td class="gt_row gt_center" headers="n">20</td>
<td class="gt_row gt_center" headers="prop">0.007</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="from">MCI</td>
<td class="gt_row gt_center" headers="to">Normal Cognition</td>
<td class="gt_row gt_center" headers="n">186</td>
<td class="gt_row gt_center" headers="prop">0.067</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="from">MCI</td>
<td class="gt_row gt_center" headers="to">MCI</td>
<td class="gt_row gt_center" headers="n">132</td>
<td class="gt_row gt_center" headers="prop">0.048</td>
</tr>
<tr class="even">
<td class="gt_row gt_center" headers="from">MCI</td>
<td class="gt_row gt_center" headers="to">Dementia</td>
<td class="gt_row gt_center" headers="n">33</td>
<td class="gt_row gt_center" headers="prop">0.012</td>
</tr>
<tr class="odd">
<td class="gt_row gt_center" headers="from">Dementia</td>
<td class="gt_row gt_center" headers="to">Dementia</td>
<td class="gt_row gt_center" headers="n">84</td>
<td class="gt_row gt_center" headers="prop">0.030</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="creating-transition-matrix" class="level3">
<h3 class="anchored" data-anchor-id="creating-transition-matrix">Creating transition matrix</h3>
<p>The probability distribution of transitions from one state to another can be represented into a transition matrix <span class="math inline">P = (p_{ij})_{i,j}</span> where each element of position <span class="math inline">(i, j)</span> represents the transition probability <span class="math inline">p_{ij}</span>.</p>
<p><span class="math display">
P = \begin{bmatrix}
p_{11} &amp; p_{12} &amp; p_{13} \\
p_{21} &amp; p_{22} &amp; p_{23} \\
p_{31} &amp; p_{32} &amp; p_{33} \\
\end{bmatrix}
</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>tran_matrix <span class="ot">&lt;-</span> tran_prob <span class="sc">|&gt;</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transition_matrix</span>() <span class="sc">|&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">normalise</span>() <span class="sc">|&gt;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">round</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>tran_matrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  to_state
from_state         Normal Cognition   MCI Dementia
  Normal Cognition            0.895 0.096    0.009
  MCI                         0.530 0.376    0.094
  Dementia                    0.000 0.000    1.000</code></pre>
</div>
</div>
<p>This code creates a <span class="math inline">3 \times 3</span> matrix (for the three states: Normal Cognition, MCI, and Dementia) and populates it with the transition probabilities.</p>
</section>
<section id="visualising-the-matrix" class="level3">
<h3 class="anchored" data-anchor-id="visualising-the-matrix">Visualising the matrix</h3>
<p>To make the transition matrix more interpretable we visualize the probabilities using a heat map (<a href="#fig-transition-matrix" class="quarto-xref">Figure&nbsp;1</a>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_matrix</span>(<span class="at">data =</span> <span class="fu">t</span>(tran_matrix), <span class="at">year =</span> <span class="dv">2016</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-transition-matrix" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-transition-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="continous-markov_files/figure-html/fig-transition-matrix-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-transition-matrix-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Heat map of transition probabilities (2016 - 2022)
</figcaption>
</figure>
</div>
</div>
</div>
<p>We can also create and plot transition matrices for each wave separately allowing us to see how these transition probabilities change across multiple waves of data collection</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>tran_prob_long <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_years</span>(<span class="at">years =</span> <span class="fu">seq</span>(<span class="dv">2016</span>, <span class="dv">2022</span>, <span class="at">by =</span> <span class="dv">2</span>)) <span class="sc">|&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">create_transitions</span>(<span class="at">absorbing =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Wave) <span class="sc">|&gt;</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate_probabilties</span>() <span class="sc">|&gt;</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_map</span>(<span class="sc">~</span> <span class="fu">transition_matrix</span>(.x, <span class="at">longitudinal =</span> <span class="cn">TRUE</span>), <span class="at">.keep =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lapply</span>(<span class="cf">function</span>(mat) {</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>    mat[<span class="fu">c</span>(<span class="st">"Normal Cognition"</span>, <span class="st">"MCI"</span>, <span class="st">"Dementia"</span>), <span class="fu">c</span>(<span class="st">"Normal Cognition"</span>, <span class="st">"MCI"</span>, <span class="st">"Dementia"</span>)] <span class="sc">|&gt;</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">normalise</span>()</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    }) <span class="sc">|&gt;</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map2_df</span>(<span class="at">.y =</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">2016</span>, <span class="dv">2020</span>, <span class="at">by =</span> <span class="dv">2</span>)), <span class="at">.f =</span> reshape_matrix) <span class="sc">|&gt;</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">transition_prob =</span> <span class="fu">round</span>(transition_prob, <span class="at">digits =</span> <span class="dv">3</span>),</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">from =</span> <span class="fu">factor</span>(from, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Normal Cognition"</span>, <span class="st">"MCI"</span>, <span class="st">"Dementia"</span>))</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  tran_prob_long,</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">filter =</span> <span class="st">"top"</span>,</span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">colnames =</span> <span class="fu">c</span>(<span class="st">"Probability"</span> <span class="ot">=</span> <span class="st">"transition_prob"</span>),</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">6</span>, <span class="at">autoWidth =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-bfc9f6b1c10acf54ef76" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-bfc9f6b1c10acf54ef76">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;Normal Cognition&quot;,&quot;MCI&quot;,&quot;Dementia&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"1\" data-scale=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"2016\" data-max=\"2020\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27"],["Normal Cognition","Normal Cognition","Normal Cognition","MCI","MCI","MCI","Dementia","Dementia","Dementia","Normal Cognition","Normal Cognition","Normal Cognition","MCI","MCI","MCI","Dementia","Dementia","Dementia","Normal Cognition","Normal Cognition","Normal Cognition","MCI","MCI","MCI","Dementia","Dementia","Dementia"],["Normal Cognition","MCI","Dementia","Normal Cognition","MCI","Dementia","Normal Cognition","MCI","Dementia","Normal Cognition","MCI","Dementia","Normal Cognition","MCI","Dementia","Normal Cognition","MCI","Dementia","Normal Cognition","MCI","Dementia","Normal Cognition","MCI","Dementia","Normal Cognition","MCI","Dementia"],[0.921,0.075,0.004,0.5590000000000001,0.36,0.081,0,0,1,0.902,0.093,0.005,0.551,0.327,0.121,0,0,1,0.863,0.121,0.017,0.472,0.444,0.083,0,0,1],[2016,2016,2016,2016,2016,2016,2016,2016,2016,2018,2018,2018,2018,2018,2018,2018,2018,2018,2020,2020,2020,2020,2020,2020,2020,2020,2020]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>from<\/th>\n      <th>to<\/th>\n      <th>Probability<\/th>\n      <th>Wave<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":6,"autoWidth":true,"columnDefs":[{"className":"dt-right","targets":[3,4]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"from","targets":1},{"name":"to","targets":2},{"name":"transition_prob","targets":3},{"name":"Wave","targets":4}],"order":[],"orderClasses":false,"orderCellsTop":true,"lengthMenu":[6,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(wave <span class="cf">in</span> <span class="fu">c</span>(<span class="fu">seq</span>(<span class="dv">2016</span>, <span class="dv">2020</span>, <span class="at">by =</span> <span class="dv">2</span>))){</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">plot_transition_wave</span>(<span class="at">data =</span> tran_prob_long, <span class="at">wave =</span> wave))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="continous-markov_files/figure-html/transition-matrix-longitudinal-plot-.gif" class="img-fluid figure-img" width="768"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="multi-state-markov-model" class="level2">
<h2 class="anchored" data-anchor-id="multi-state-markov-model">Multi-State Markov Model</h2>
<p>Now that we have an idea of the disease progression across time we are interested in the effect of different covariates on these transitions. For this, we can fit a multi-state Markov model. Multi-state models (MSMs) provide a comprehensive view of the disease process and make risk-factors analysis and long-term predictions more easily. The conditional distribution of the status of an individual participant at an arbitrary examination given their status at previous examinations was assumed to have the <strong>Markov property</strong>. That is the distribution of the forthcoming state <span class="math inline">X_{n+1}</span> depends only on the current state <span class="math inline">X_n</span> and doesnâ€™t depend on the previous ones <span class="math inline">X_{n-1}, X_{n-2}, \dots, X_1</span>.</p>
<p><span class="math display">Pr(X_{n+1} = x_{n+1} \; \vert \; X_1 = x_1, X_2 = x_2, \dots, X_n = x_n) = Pr(X_{n+1} = x_{n+1} \; \vert \; X_n = x_n)</span></p>
<section id="data-preperation" class="level3">
<h3 class="anchored" data-anchor-id="data-preperation">Data preperation</h3>
<p>For our model we are going to look at several different covariates:</p>
<ul>
<li><strong>Gender</strong>: <span class="math inline">0 = \text{Male;} \; 1 = \text{Female}</span></li>
<li><strong>Age</strong>: <span class="math inline">\text{Range} \; = 50 - 91</span></li>
<li><strong>Education</strong>: <span class="math inline">0 = \text{No Degree;} \; 1 = \text{High School Degree;} \; 2 = \text{Further Education}</span></li>
<li><strong>Number of cardiovascular risk factors</strong>: <span class="math inline">\text{Range} \; = 0 - 4</span></li>
<li><strong>Procrastination</strong>: <span class="math inline">\text{Range} \; = 4 - 60</span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ID"</span>, <span class="st">"Gender"</span>, <span class="st">"Age"</span>, <span class="st">"Education_tri"</span>, </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="st">"Cardio_risk_"</span>, <span class="fu">seq</span>(<span class="dv">16</span>, <span class="dv">22</span>, <span class="at">by =</span> <span class="dv">2</span>)), </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste0</span>(<span class="st">"Total_dep_20"</span>, <span class="fu">seq</span>(<span class="dv">16</span>, <span class="dv">22</span>, <span class="at">by =</span> <span class="dv">2</span>)), <span class="st">"Total_p"</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>markov_data <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">extract_years</span>(<span class="fu">seq</span>(<span class="dv">2016</span>, <span class="dv">2022</span>, <span class="at">by =</span> <span class="dv">2</span>)) <span class="sc">|&gt;</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>() <span class="sc">|&gt;</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(data[, cols], <span class="at">by =</span> <span class="st">"ID"</span>) <span class="sc">|&gt;</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_data</span>() <span class="sc">|&gt;</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">backtrack_age</span>(<span class="at">base_year =</span> <span class="dv">2016</span>, <span class="at">current_year =</span> <span class="dv">2022</span>) <span class="sc">|&gt;</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID) <span class="sc">|&gt;</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age =</span> <span class="fu">min</span>(Age), <span class="co"># Baseline age</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">Cardio_risk =</span> Cardio_risk[Wave <span class="sc">==</span> <span class="dv">1</span>],</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">Depression =</span> Depression[Wave <span class="sc">==</span> <span class="dv">1</span>]</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Age <span class="sc">&gt;=</span> <span class="dv">50</span>) <span class="co"># Only looking at older adults</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>DT<span class="sc">::</span><span class="fu">datatable</span>(</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>  markov_data,</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">filter =</span> <span class="st">"top"</span>,</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">options =</span> <span class="fu">list</span>(<span class="at">pageLength =</span> <span class="dv">6</span>, <span class="at">autoWidth =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-36523a9ace4948562df3" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-36523a9ace4948562df3">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td><\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"949\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;0&quot;,&quot;1&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"50\" data-max=\"91\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;0&quot;,&quot;1&quot;,&quot;2&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"4\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"0\" data-max=\"8\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"integer\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"4\" data-max=\"60\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"4\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none;position: absolute;width: 200px;opacity: 1\">\n      <div data-min=\"1\" data-max=\"3\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582","583","584","585","586","587","588","589","590","591","592","593","594","595","596","597","598","599","600","601","602","603","604","605","606","607","608","609","610","611","612","613","614","615","616","617","618","619","620","621","622","623","624","625","626","627","628","629","630","631","632","633","634","635","636","637","638","639","640","641","642","643","644","645","646","647","648","649","650","651","652","653","654","655","656","657","658","659","660","661","662","663","664","665","666","667","668","669","670","671","672","673","674","675","676","677","678","679","680","681","682","683","684","685","686","687","688","689","690","691","692","693","694","695","696","697","698","699","700","701","702","703","704","705","706","707","708","709","710","711","712","713","714","715","716","717","718","719","720","721","722","723","724","725","726","727","728","729","730","731","732","733","734","735","736","737","738","739","740","741","742","743","744","745","746","747","748","749","750","751","752","753","754","755","756","757","758","759","760","761","762","763","764","765","766","767","768","769","770","771","772","773","774","775","776","777","778","779","780","781","782","783","784","785","786","787","788","789","790","791","792","793","794","795","796","797","798","799","800","801","802","803","804","805","806","807","808","809","810","811","812","813","814","815","816","817","818","819","820","821","822","823","824","825","826","827","828","829","830","831","832","833","834","835","836","837","838","839","840","841","842","843","844","845","846","847","848","849","850","851","852","853","854","855","856","857","858","859","860","861","862","863","864","865","866","867","868","869","870","871","872","873","874","875","876","877","878","879","880","881","882","883","884","885","886","887","888","889","890","891","892","893","894","895","896","897","898","899","900","901","902","903","904","905","906","907","908","909","910","911","912","913","914","915","916","917","918","919","920","921","922","923","924","925","926","927","928","929","930","931","932","933","934","935","936","937","938","939","940","941","942","943","944","945","946","947","948","949","950","951","952","953","954","955","956","957","958","959","960","961","962","963","964","965","966","967","968","969","970","971","972","973","974","975","976","977","978","979","980","981","982","983","984","985","986","987","988","989","990","991","992","993","994","995","996","997","998","999","1000","1001","1002","1003","1004","1005","1006","1007","1008","1009","1010","1011","1012","1013","1014","1015","1016","1017","1018","1019","1020","1021","1022","1023","1024","1025","1026","1027","1028","1029","1030","1031","1032","1033","1034","1035","1036","1037","1038","1039","1040","1041","1042","1043","1044","1045","1046","1047","1048","1049","1050","1051","1052","1053","1054","1055","1056","1057","1058","1059","1060","1061","1062","1063","1064","1065","1066","1067","1068","1069","1070","1071","1072","1073","1074","1075","1076","1077","1078","1079","1080","1081","1082","1083","1084","1085","1086","1087","1088","1089","1090","1091","1092","1093","1094","1095","1096","1097","1098","1099","1100","1101","1102","1103","1104","1105","1106","1107","1108","1109","1110","1111","1112","1113","1114","1115","1116","1117","1118","1119","1120","1121","1122","1123","1124","1125","1126","1127","1128","1129","1130","1131","1132","1133","1134","1135","1136","1137","1138","1139","1140","1141","1142","1143","1144","1145","1146","1147","1148","1149","1150","1151","1152","1153","1154","1155","1156","1157","1158","1159","1160","1161","1162","1163","1164","1165","1166","1167","1168","1169","1170","1171","1172","1173","1174","1175","1176","1177","1178","1179","1180","1181","1182","1183","1184","1185","1186","1187","1188","1189","1190","1191","1192","1193","1194","1195","1196","1197","1198","1199","1200","1201","1202","1203","1204","1205","1206","1207","1208","1209","1210","1211","1212","1213","1214","1215","1216","1217","1218","1219","1220","1221","1222","1223","1224","1225","1226","1227","1228","1229","1230","1231","1232","1233","1234","1235","1236","1237","1238","1239","1240","1241","1242","1243","1244","1245","1246","1247","1248","1249","1250","1251","1252","1253","1254","1255","1256","1257","1258","1259","1260","1261","1262","1263","1264","1265","1266","1267","1268","1269","1270","1271","1272","1273","1274","1275","1276","1277","1278","1279","1280","1281","1282","1283","1284","1285","1286","1287","1288","1289","1290","1291","1292","1293","1294","1295","1296","1297","1298","1299","1300","1301","1302","1303","1304","1305","1306","1307","1308","1309","1310","1311","1312","1313","1314","1315","1316","1317","1318","1319","1320","1321","1322","1323","1324","1325","1326","1327","1328","1329","1330","1331","1332","1333","1334","1335","1336","1337","1338","1339","1340","1341","1342","1343","1344","1345","1346","1347","1348","1349","1350","1351","1352","1353","1354","1355","1356","1357","1358","1359","1360","1361","1362","1363","1364","1365","1366","1367","1368","1369","1370","1371","1372","1373","1374","1375","1376","1377","1378","1379","1380","1381","1382","1383","1384","1385","1386","1387","1388","1389","1390","1391","1392","1393","1394","1395","1396","1397","1398","1399","1400","1401","1402","1403","1404","1405","1406","1407","1408","1409","1410","1411","1412","1413","1414","1415","1416","1417","1418","1419","1420","1421","1422","1423","1424","1425","1426","1427","1428","1429","1430","1431","1432","1433","1434","1435","1436","1437","1438","1439","1440","1441","1442","1443","1444","1445","1446","1447","1448","1449","1450","1451","1452","1453","1454","1455","1456","1457","1458","1459","1460","1461","1462","1463","1464","1465","1466","1467","1468","1469","1470","1471","1472","1473","1474","1475","1476","1477","1478","1479","1480","1481","1482","1483","1484","1485","1486","1487","1488","1489","1490","1491","1492","1493","1494","1495","1496","1497","1498","1499","1500","1501","1502","1503","1504","1505","1506","1507","1508","1509","1510","1511","1512","1513","1514","1515","1516","1517","1518","1519","1520","1521","1522","1523","1524","1525","1526","1527","1528","1529","1530","1531","1532","1533","1534","1535","1536","1537","1538","1539","1540","1541","1542","1543","1544","1545","1546","1547","1548","1549","1550","1551","1552","1553","1554","1555","1556","1557","1558","1559","1560","1561","1562","1563","1564","1565","1566","1567","1568","1569","1570","1571","1572","1573","1574","1575","1576","1577","1578","1579","1580","1581","1582","1583","1584","1585","1586","1587","1588","1589","1590","1591","1592","1593","1594","1595","1596","1597","1598","1599","1600","1601","1602","1603","1604","1605","1606","1607","1608","1609","1610","1611","1612","1613","1614","1615","1616","1617","1618","1619","1620","1621","1622","1623","1624","1625","1626","1627","1628","1629","1630","1631","1632","1633","1634","1635","1636","1637","1638","1639","1640","1641","1642","1643","1644","1645","1646","1647","1648","1649","1650","1651","1652","1653","1654","1655","1656","1657","1658","1659","1660","1661","1662","1663","1664","1665","1666","1667","1668","1669","1670","1671","1672","1673","1674","1675","1676","1677","1678","1679","1680","1681","1682","1683","1684","1685","1686","1687","1688","1689","1690","1691","1692","1693","1694","1695","1696","1697","1698","1699","1700","1701","1702","1703","1704","1705","1706","1707","1708","1709","1710","1711","1712","1713","1714","1715","1716","1717","1718","1719","1720","1721","1722","1723","1724","1725","1726","1727","1728","1729","1730","1731","1732","1733","1734","1735","1736","1737","1738","1739","1740","1741","1742","1743","1744","1745","1746","1747","1748","1749","1750","1751","1752","1753","1754","1755","1756","1757","1758","1759","1760","1761","1762","1763","1764","1765","1766","1767","1768","1769","1770","1771","1772","1773","1774","1775","1776","1777","1778","1779","1780","1781","1782","1783","1784","1785","1786","1787","1788","1789","1790","1791","1792","1793","1794","1795","1796","1797","1798","1799","1800","1801","1802","1803","1804","1805","1806","1807","1808","1809","1810","1811","1812","1813","1814","1815","1816","1817","1818","1819","1820","1821","1822","1823","1824","1825","1826","1827","1828","1829","1830","1831","1832","1833","1834","1835","1836","1837","1838","1839","1840","1841","1842","1843","1844","1845","1846","1847","1848","1849","1850","1851","1852","1853","1854","1855","1856","1857","1858","1859","1860","1861","1862","1863","1864","1865","1866","1867","1868","1869","1870","1871","1872","1873","1874","1875","1876","1877","1878","1879","1880","1881","1882","1883","1884","1885","1886","1887","1888","1889","1890","1891","1892","1893","1894","1895","1896","1897","1898","1899","1900","1901","1902","1903","1904","1905","1906","1907","1908","1909","1910","1911","1912","1913","1914","1915","1916","1917","1918","1919","1920","1921","1922","1923","1924","1925","1926","1927","1928","1929","1930","1931","1932","1933","1934","1935","1936","1937","1938","1939","1940","1941","1942","1943","1944","1945","1946","1947","1948","1949","1950","1951","1952","1953","1954","1955","1956","1957","1958","1959","1960","1961","1962","1963","1964","1965","1966","1967","1968","1969","1970","1971","1972","1973","1974","1975","1976","1977","1978","1979","1980","1981","1982","1983","1984","1985","1986","1987","1988","1989","1990","1991","1992","1993","1994","1995","1996","1997","1998","1999","2000","2001","2002","2003","2004","2005","2006","2007","2008","2009","2010","2011","2012","2013","2014","2015","2016","2017","2018","2019","2020","2021","2022","2023","2024","2025","2026","2027","2028","2029","2030","2031","2032","2033","2034","2035","2036","2037","2038","2039","2040","2041","2042","2043","2044","2045","2046","2047","2048","2049","2050","2051","2052","2053","2054","2055","2056","2057","2058","2059","2060","2061","2062","2063","2064","2065","2066","2067","2068","2069","2070","2071","2072","2073","2074","2075","2076","2077","2078","2079","2080","2081","2082","2083","2084","2085","2086","2087","2088","2089","2090","2091","2092","2093","2094","2095","2096","2097","2098","2099","2100","2101","2102","2103","2104","2105","2106","2107","2108","2109","2110","2111","2112","2113","2114","2115","2116","2117","2118","2119","2120","2121","2122","2123","2124","2125","2126","2127","2128","2129","2130","2131","2132","2133","2134","2135","2136","2137","2138","2139","2140","2141","2142","2143","2144","2145","2146","2147","2148","2149","2150","2151","2152","2153","2154","2155","2156","2157","2158","2159","2160","2161","2162","2163","2164","2165","2166","2167","2168","2169","2170","2171","2172","2173","2174","2175","2176","2177","2178","2179","2180","2181","2182","2183","2184","2185","2186","2187","2188","2189","2190","2191","2192","2193","2194","2195","2196","2197","2198","2199","2200","2201","2202","2203","2204","2205","2206","2207","2208","2209","2210","2211","2212","2213","2214","2215","2216","2217","2218","2219","2220","2221","2222","2223","2224","2225","2226","2227","2228","2229","2230","2231","2232","2233","2234","2235","2236","2237","2238","2239","2240","2241","2242","2243","2244","2245","2246","2247","2248","2249","2250","2251","2252","2253","2254","2255","2256","2257","2258","2259","2260","2261","2262","2263","2264","2265","2266","2267","2268","2269","2270","2271","2272","2273","2274","2275","2276","2277","2278","2279","2280","2281","2282","2283","2284","2285","2286","2287","2288","2289","2290","2291","2292","2293","2294","2295","2296","2297","2298","2299","2300","2301","2302","2303","2304","2305","2306","2307","2308","2309","2310","2311","2312","2313","2314","2315","2316","2317","2318","2319","2320","2321","2322","2323","2324","2325","2326","2327","2328","2329","2330","2331","2332","2333","2334","2335","2336","2337","2338","2339","2340","2341","2342","2343","2344","2345","2346","2347","2348","2349","2350","2351","2352","2353","2354","2355","2356","2357","2358","2359","2360","2361","2362","2363","2364","2365","2366","2367","2368","2369","2370","2371","2372","2373","2374","2375","2376","2377","2378","2379","2380","2381","2382","2383","2384","2385","2386","2387","2388","2389","2390","2391","2392","2393","2394","2395","2396","2397","2398","2399","2400","2401","2402","2403","2404","2405","2406","2407","2408","2409","2410","2411","2412","2413","2414","2415","2416","2417","2418","2419","2420","2421","2422","2423","2424","2425","2426","2427","2428","2429","2430","2431","2432","2433","2434","2435","2436","2437","2438","2439","2440","2441","2442","2443","2444","2445","2446","2447","2448","2449","2450","2451","2452","2453","2454","2455","2456","2457","2458","2459","2460","2461","2462","2463","2464","2465","2466","2467","2468","2469","2470","2471","2472","2473","2474","2475","2476","2477","2478","2479","2480","2481","2482","2483","2484","2485","2486","2487","2488","2489","2490","2491","2492","2493","2494","2495","2496","2497","2498","2499","2500","2501","2502","2503","2504","2505","2506","2507","2508","2509","2510","2511","2512","2513","2514","2515","2516","2517","2518","2519","2520","2521","2522","2523","2524","2525","2526","2527","2528","2529","2530","2531","2532","2533","2534","2535","2536","2537","2538","2539","2540","2541","2542","2543","2544","2545","2546","2547","2548","2549","2550","2551","2552","2553","2554","2555","2556","2557","2558","2559","2560","2561","2562","2563","2564","2565","2566","2567","2568","2569","2570","2571","2572","2573","2574","2575","2576","2577","2578","2579","2580","2581","2582","2583","2584","2585","2586","2587","2588","2589","2590","2591","2592","2593","2594","2595","2596","2597","2598","2599","2600","2601","2602","2603","2604","2605","2606","2607","2608","2609","2610","2611","2612","2613","2614","2615","2616","2617","2618","2619","2620","2621","2622","2623","2624","2625","2626","2627","2628","2629","2630","2631","2632","2633","2634","2635","2636","2637","2638","2639","2640","2641","2642","2643","2644","2645","2646","2647","2648","2649","2650","2651","2652","2653","2654","2655","2656","2657","2658","2659","2660","2661","2662","2663","2664","2665","2666","2667","2668","2669","2670","2671","2672","2673","2674","2675","2676","2677","2678","2679","2680","2681","2682","2683","2684","2685","2686","2687","2688","2689","2690","2691","2692","2693","2694","2695","2696","2697","2698","2699","2700","2701","2702","2703","2704","2705","2706","2707","2708","2709","2710","2711","2712","2713","2714","2715","2716","2717","2718","2719","2720","2721","2722","2723","2724","2725","2726","2727","2728","2729","2730","2731","2732","2733","2734","2735","2736","2737","2738","2739","2740","2741","2742","2743","2744","2745","2746","2747","2748","2749","2750","2751","2752","2753","2754","2755","2756","2757","2758","2759","2760","2761","2762","2763","2764","2765","2766","2767","2768","2769","2770","2771","2772","2773","2774","2775","2776","2777","2778","2779","2780","2781","2782","2783","2784","2785","2786","2787","2788","2789","2790","2791","2792","2793","2794","2795","2796","2797","2798","2799","2800","2801","2802","2803","2804","2805","2806","2807","2808","2809","2810","2811","2812","2813","2814","2815","2816","2817","2818","2819","2820","2821","2822","2823","2824","2825","2826","2827","2828","2829","2830","2831","2832","2833","2834","2835","2836","2837","2838","2839","2840","2841","2842","2843","2844","2845","2846","2847","2848","2849","2850","2851","2852","2853","2854","2855","2856","2857","2858","2859","2860","2861","2862","2863","2864","2865","2866","2867","2868","2869","2870","2871","2872","2873","2874","2875","2876","2877","2878","2879","2880","2881","2882","2883","2884","2885","2886","2887","2888","2889","2890","2891","2892","2893","2894","2895","2896","2897","2898","2899","2900","2901","2902","2903","2904","2905","2906","2907","2908","2909","2910","2911","2912","2913","2914","2915","2916","2917","2918","2919","2920","2921","2922","2923","2924","2925","2926","2927","2928","2929","2930","2931","2932","2933","2934","2935","2936","2937","2938","2939","2940","2941","2942","2943","2944","2945","2946","2947","2948","2949","2950","2951","2952","2953","2954","2955","2956","2957","2958","2959","2960","2961","2962","2963","2964","2965","2966","2967","2968","2969","2970","2971","2972","2973","2974","2975","2976","2977","2978","2979","2980","2981","2982","2983","2984","2985","2986","2987","2988","2989","2990","2991","2992","2993","2994","2995","2996","2997","2998","2999","3000","3001","3002","3003","3004","3005","3006","3007","3008","3009","3010","3011","3012","3013","3014","3015","3016","3017","3018","3019","3020","3021","3022","3023","3024","3025","3026","3027","3028","3029","3030","3031","3032","3033","3034","3035","3036","3037","3038","3039","3040","3041","3042","3043","3044","3045","3046","3047","3048","3049","3050","3051","3052","3053","3054","3055","3056","3057","3058","3059","3060","3061","3062","3063","3064","3065","3066","3067","3068","3069","3070","3071","3072","3073","3074","3075","3076","3077","3078","3079","3080","3081","3082","3083","3084","3085","3086","3087","3088","3089","3090","3091","3092","3093","3094","3095","3096","3097","3098","3099","3100","3101","3102","3103","3104","3105","3106","3107","3108","3109","3110","3111","3112","3113","3114","3115","3116","3117","3118","3119","3120","3121","3122","3123","3124","3125","3126","3127","3128","3129","3130","3131","3132","3133","3134","3135","3136","3137","3138","3139","3140","3141","3142","3143","3144","3145","3146","3147","3148","3149","3150","3151","3152","3153","3154","3155","3156","3157","3158","3159","3160","3161","3162","3163","3164","3165","3166","3167","3168","3169","3170","3171","3172","3173","3174","3175","3176","3177","3178","3179","3180","3181","3182","3183","3184","3185","3186","3187","3188","3189","3190","3191","3192","3193","3194","3195","3196","3197","3198","3199","3200","3201","3202","3203","3204","3205","3206","3207","3208","3209","3210","3211","3212","3213","3214","3215","3216","3217","3218","3219","3220","3221","3222","3223","3224","3225","3226","3227","3228","3229","3230","3231","3232","3233","3234","3235","3236","3237","3238","3239","3240","3241","3242","3243","3244","3245","3246","3247","3248","3249","3250","3251","3252","3253","3254","3255","3256","3257","3258","3259","3260","3261","3262","3263","3264","3265","3266","3267","3268","3269","3270","3271","3272","3273","3274","3275","3276","3277","3278","3279","3280","3281","3282","3283","3284","3285","3286","3287","3288","3289","3290","3291","3292","3293","3294","3295","3296","3297","3298","3299","3300","3301","3302","3303","3304","3305","3306","3307","3308","3309","3310","3311","3312","3313","3314","3315","3316","3317","3318","3319","3320","3321","3322","3323","3324","3325","3326","3327","3328","3329","3330","3331","3332","3333","3334","3335","3336","3337","3338","3339","3340","3341","3342","3343","3344","3345","3346","3347","3348","3349","3350","3351","3352","3353","3354","3355","3356","3357","3358","3359","3360","3361","3362","3363","3364","3365","3366","3367","3368","3369","3370","3371","3372","3373","3374","3375","3376","3377","3378","3379","3380","3381","3382","3383","3384","3385","3386","3387","3388","3389","3390","3391","3392","3393","3394","3395","3396","3397","3398","3399","3400","3401","3402","3403","3404","3405","3406","3407","3408","3409","3410","3411","3412","3413","3414","3415","3416","3417","3418","3419","3420","3421","3422","3423","3424","3425","3426","3427","3428","3429","3430","3431","3432","3433","3434","3435","3436","3437","3438","3439","3440","3441","3442","3443","3444","3445","3446","3447","3448","3449","3450","3451","3452","3453","3454","3455","3456","3457","3458","3459","3460","3461","3462","3463","3464","3465","3466","3467","3468","3469","3470","3471","3472","3473","3474","3475","3476","3477","3478","3479","3480","3481","3482","3483","3484","3485","3486","3487","3488","3489","3490","3491","3492","3493","3494","3495","3496","3497","3498","3499","3500","3501","3502","3503","3504","3505","3506","3507","3508","3509","3510","3511","3512","3513","3514","3515","3516","3517","3518","3519","3520","3521","3522","3523","3524","3525","3526","3527","3528","3529","3530","3531","3532","3533","3534","3535","3536"],[1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,9,9,9,9,10,10,10,10,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,14,15,15,15,15,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,22,22,22,22,24,24,24,24,25,25,25,25,26,26,26,26,27,27,27,27,28,28,28,28,29,29,29,29,30,30,30,30,31,31,31,31,32,32,32,32,33,33,33,33,34,34,34,34,35,35,35,35,36,36,36,36,37,37,37,37,38,38,38,38,39,39,39,39,40,40,40,40,41,41,41,41,42,42,42,42,43,43,43,43,44,44,44,44,45,45,45,45,46,46,46,46,47,47,47,47,48,48,48,48,49,49,49,49,50,50,50,50,51,51,51,51,52,52,52,52,53,53,53,53,54,54,54,54,55,55,55,55,56,56,56,56,57,57,57,57,58,58,58,58,59,59,59,59,60,60,60,60,61,61,61,61,62,62,62,62,63,63,63,63,64,64,64,64,65,65,65,65,66,66,66,66,67,67,67,67,68,68,68,68,69,69,69,69,70,70,70,70,71,71,71,71,72,72,72,72,73,73,73,73,74,74,74,74,75,75,75,75,76,76,76,76,77,77,77,77,78,78,78,78,79,79,79,79,80,80,80,80,81,81,81,81,82,82,82,82,83,83,83,83,84,84,84,84,85,85,85,85,86,86,86,86,87,87,87,87,88,88,88,88,89,89,89,89,90,90,90,90,91,91,91,91,92,92,92,92,93,93,93,93,94,94,94,94,95,95,95,95,96,96,96,96,97,97,97,97,98,98,98,98,99,99,99,99,100,100,100,100,101,101,101,101,102,102,102,102,103,103,103,103,104,104,104,104,105,105,105,105,106,106,106,106,107,107,107,107,108,108,108,108,109,109,109,109,110,110,110,110,111,111,111,111,112,112,112,112,113,113,113,113,114,114,114,114,115,115,115,115,116,116,116,116,117,117,117,117,118,118,118,118,119,119,119,119,120,120,120,120,121,121,121,121,122,122,122,122,123,123,123,123,124,124,124,124,125,125,125,125,126,126,126,126,127,127,127,127,128,128,128,128,129,129,129,129,130,130,130,130,131,131,131,131,132,132,132,132,134,134,134,134,135,135,135,135,136,136,136,136,137,137,137,137,138,138,138,138,139,139,139,139,140,140,140,140,141,141,141,141,142,142,142,142,143,143,143,143,144,144,144,144,145,145,145,145,146,146,146,146,147,147,147,147,148,148,148,148,149,149,149,149,150,150,150,150,151,151,151,151,152,152,152,152,153,153,153,153,154,154,154,154,155,155,155,155,156,156,156,156,157,157,157,157,158,158,158,158,159,159,159,159,160,160,160,160,161,161,161,161,162,162,162,162,163,163,163,163,164,164,164,164,165,165,165,165,166,166,166,166,167,167,167,167,169,169,169,169,170,170,170,170,171,171,171,171,172,172,172,172,173,173,173,173,174,174,174,174,175,175,175,175,176,176,176,176,177,177,177,177,178,178,178,178,179,179,179,179,180,180,180,180,181,181,181,181,182,182,182,182,183,183,183,183,184,184,184,184,185,185,185,185,186,186,186,186,187,187,187,187,189,189,189,189,190,190,190,190,191,191,191,191,192,192,192,192,193,193,193,193,194,194,194,194,195,195,195,195,197,197,197,197,198,198,198,198,199,199,199,199,200,200,200,200,201,201,201,201,202,202,202,202,203,203,203,203,204,204,204,204,205,205,205,205,206,206,206,206,207,207,207,207,208,208,208,208,209,209,209,209,210,210,210,210,211,211,211,211,212,212,212,212,213,213,213,213,214,214,214,214,215,215,215,215,216,216,216,216,217,217,217,217,218,218,218,218,219,219,219,219,220,220,220,220,221,221,221,221,222,222,222,222,223,223,223,223,224,224,224,224,225,225,225,225,226,226,226,226,227,227,227,227,228,228,228,228,229,229,229,229,230,230,230,230,231,231,231,231,232,232,232,232,233,233,233,233,234,234,234,234,235,235,235,235,236,236,236,236,237,237,237,237,238,238,238,238,239,239,239,239,240,240,240,240,241,241,241,241,242,242,242,242,243,243,243,243,244,244,244,244,246,246,246,246,247,247,247,247,248,248,248,248,249,249,249,249,250,250,250,250,251,251,251,251,252,252,252,252,253,253,253,253,254,254,254,254,255,255,255,255,256,256,256,256,258,258,258,258,259,259,259,259,260,260,260,260,261,261,261,261,262,262,262,262,263,263,263,263,264,264,264,264,265,265,265,265,266,266,266,266,267,267,267,267,268,268,268,268,269,269,269,269,270,270,270,270,271,271,271,271,272,272,272,272,273,273,273,273,274,274,274,274,275,275,275,275,276,276,276,276,277,277,277,277,278,278,278,278,279,279,279,279,280,280,280,280,281,281,281,281,282,282,282,282,284,284,284,284,285,285,285,285,286,286,286,286,287,287,287,287,288,288,288,288,289,289,289,289,290,290,290,290,291,291,291,291,292,292,292,292,293,293,293,293,294,294,294,294,295,295,295,295,296,296,296,296,297,297,297,297,298,298,298,298,299,299,299,299,300,300,300,300,301,301,301,301,302,302,302,302,303,303,303,303,304,304,304,304,306,306,306,306,307,307,307,307,308,308,308,308,309,309,309,309,310,310,310,310,311,311,311,311,312,312,312,312,313,313,313,313,314,314,314,314,315,315,315,315,316,316,316,316,317,317,317,317,318,318,318,318,319,319,319,319,320,320,320,320,322,322,322,322,323,323,323,323,324,324,324,324,325,325,325,325,326,326,326,326,327,327,327,327,328,328,328,328,329,329,329,329,330,330,330,330,331,331,331,331,332,332,332,332,333,333,333,333,334,334,334,334,335,335,335,335,336,336,336,336,337,337,337,337,338,338,338,338,339,339,339,339,340,340,340,340,341,341,341,341,342,342,342,342,343,343,343,343,344,344,344,344,345,345,345,345,346,346,346,346,347,347,347,347,348,348,348,348,349,349,349,349,350,350,350,350,351,351,351,351,352,352,352,352,353,353,353,353,354,354,354,354,355,355,355,355,356,356,356,356,357,357,357,357,358,358,358,358,359,359,359,359,360,360,360,360,361,361,361,361,362,362,362,362,363,363,363,363,364,364,364,364,365,365,365,365,366,366,366,366,367,367,367,367,368,368,368,368,369,369,369,369,371,371,371,371,372,372,372,372,373,373,373,373,374,374,374,374,375,375,375,375,376,376,376,376,377,377,377,377,378,378,378,378,379,379,379,379,380,380,380,380,381,381,381,381,382,382,382,382,383,383,383,383,384,384,384,384,385,385,385,385,386,386,386,386,387,387,387,387,388,388,388,388,389,389,389,389,390,390,390,390,391,391,391,391,392,392,392,392,393,393,393,393,394,394,394,394,395,395,395,395,396,396,396,396,397,397,397,397,398,398,398,398,399,399,399,399,400,400,400,400,401,401,401,401,402,402,402,402,403,403,403,403,404,404,404,404,405,405,405,405,406,406,406,406,407,407,407,407,408,408,408,408,409,409,409,409,410,410,410,410,411,411,411,411,412,412,412,412,413,413,413,413,414,414,414,414,415,415,415,415,418,418,418,418,419,419,419,419,420,420,420,420,421,421,421,421,422,422,422,422,423,423,423,423,424,424,424,424,425,425,425,425,426,426,426,426,427,427,427,427,428,428,428,428,429,429,429,429,430,430,430,430,431,431,431,431,432,432,432,432,433,433,433,433,434,434,434,434,435,435,435,435,436,436,436,436,437,437,437,437,438,438,438,438,439,439,439,439,440,440,440,440,441,441,441,441,442,442,442,442,443,443,443,443,444,444,444,444,446,446,446,446,447,447,447,447,448,448,448,448,449,449,449,449,450,450,450,450,451,451,451,451,452,452,452,452,453,453,453,453,454,454,454,454,455,455,455,455,456,456,456,456,457,457,457,457,458,458,458,458,460,460,460,460,462,462,462,462,463,463,463,463,464,464,464,464,465,465,465,465,466,466,466,466,468,468,468,468,469,469,469,469,470,470,470,470,471,471,471,471,472,472,472,472,473,473,473,473,474,474,474,474,475,475,475,475,476,476,476,476,477,477,477,477,478,478,478,478,479,479,479,479,480,480,480,480,482,482,482,482,483,483,483,483,484,484,484,484,486,486,486,486,487,487,487,487,488,488,488,488,489,489,489,489,490,490,490,490,491,491,491,491,492,492,492,492,493,493,493,493,494,494,494,494,495,495,495,495,496,496,496,496,497,497,497,497,498,498,498,498,499,499,499,499,500,500,500,500,501,501,501,501,502,502,502,502,503,503,503,503,504,504,504,504,505,505,505,505,506,506,506,506,507,507,507,507,508,508,508,508,509,509,509,509,510,510,510,510,511,511,511,511,512,512,512,512,513,513,513,513,514,514,514,514,515,515,515,515,516,516,516,516,517,517,517,517,518,518,518,518,519,519,519,519,520,520,520,520,521,521,521,521,522,522,522,522,523,523,523,523,524,524,524,524,525,525,525,525,526,526,526,526,528,528,528,528,529,529,529,529,530,530,530,530,531,531,531,531,532,532,532,532,533,533,533,533,534,534,534,534,535,535,535,535,536,536,536,536,537,537,537,537,538,538,538,538,539,539,539,539,540,540,540,540,541,541,541,541,542,542,542,542,543,543,543,543,544,544,544,544,545,545,545,545,546,546,546,546,547,547,547,547,549,549,549,549,550,550,550,550,551,551,551,551,552,552,552,552,553,553,553,553,554,554,554,554,555,555,555,555,556,556,556,556,557,557,557,557,558,558,558,558,559,559,559,559,560,560,560,560,561,561,561,561,562,562,562,562,563,563,563,563,564,564,564,564,565,565,565,565,566,566,566,566,568,568,568,568,570,570,570,570,571,571,571,571,572,572,572,572,573,573,573,573,576,576,576,576,577,577,577,577,578,578,578,578,579,579,579,579,580,580,580,580,581,581,581,581,582,582,582,582,583,583,583,583,584,584,584,584,585,585,585,585,586,586,586,586,587,587,587,587,588,588,588,588,589,589,589,589,590,590,590,590,591,591,591,591,592,592,592,592,593,593,593,593,594,594,594,594,595,595,595,595,596,596,596,596,597,597,597,597,598,598,598,598,600,600,600,600,601,601,601,601,602,602,602,602,603,603,603,603,604,604,604,604,605,605,605,605,606,606,606,606,607,607,607,607,608,608,608,608,609,609,609,609,610,610,610,610,611,611,611,611,612,612,612,612,614,614,614,614,616,616,616,616,617,617,617,617,618,618,618,618,619,619,619,619,620,620,620,620,621,621,621,621,622,622,622,622,623,623,623,623,624,624,624,624,625,625,625,625,626,626,626,626,627,627,627,627,628,628,628,628,629,629,629,629,630,630,630,630,632,632,632,632,633,633,633,633,634,634,634,634,635,635,635,635,636,636,636,636,637,637,637,637,638,638,638,638,639,639,639,639,640,640,640,640,641,641,641,641,642,642,642,642,643,643,643,643,644,644,644,644,645,645,645,645,646,646,646,646,647,647,647,647,648,648,648,648,649,649,649,649,650,650,650,650,651,651,651,651,653,653,653,653,654,654,654,654,655,655,655,655,656,656,656,656,657,657,657,657,658,658,658,658,659,659,659,659,660,660,660,660,661,661,661,661,662,662,662,662,664,664,664,664,665,665,665,665,666,666,666,666,667,667,667,667,668,668,668,668,669,669,669,669,670,670,670,670,671,671,671,671,672,672,672,672,673,673,673,673,674,674,674,674,675,675,675,675,676,676,676,676,677,677,677,677,678,678,678,678,679,679,679,679,680,680,680,680,681,681,681,681,682,682,682,682,683,683,683,683,684,684,684,684,685,685,685,685,686,686,686,686,687,687,687,687,689,689,689,689,690,690,690,690,691,691,691,691,692,692,692,692,694,694,694,694,695,695,695,695,697,697,697,697,698,698,698,698,699,699,699,699,702,702,702,702,703,703,703,703,704,704,704,704,705,705,705,705,706,706,706,706,707,707,707,707,708,708,708,708,709,709,709,709,710,710,710,710,711,711,711,711,712,712,712,712,713,713,713,713,717,717,717,717,718,718,718,718,719,719,719,719,721,721,721,721,723,723,723,723,724,724,724,724,725,725,725,725,727,727,727,727,728,728,728,728,729,729,729,729,730,730,730,730,731,731,731,731,732,732,732,732,734,734,734,734,735,735,735,735,736,736,736,736,737,737,737,737,738,738,738,738,739,739,739,739,740,740,740,740,741,741,741,741,742,742,742,742,746,746,746,746,747,747,747,747,748,748,748,748,749,749,749,749,750,750,750,750,751,751,751,751,752,752,752,752,753,753,753,753,754,754,754,754,756,756,756,756,757,757,757,757,759,759,759,759,760,760,760,760,761,761,761,761,763,763,763,763,766,766,766,766,767,767,767,767,768,768,768,768,769,769,769,769,770,770,770,770,771,771,771,771,772,772,772,772,773,773,773,773,775,775,775,775,776,776,776,776,777,777,777,777,778,778,778,778,779,779,779,779,780,780,780,780,782,782,782,782,783,783,783,783,784,784,784,784,785,785,785,785,786,786,786,786,787,787,787,787,788,788,788,788,789,789,789,789,790,790,790,790,791,791,791,791,792,792,792,792,793,793,793,793,794,794,794,794,795,795,795,795,796,796,796,796,797,797,797,797,799,799,799,799,800,800,800,800,801,801,801,801,802,802,802,802,805,805,805,805,806,806,806,806,808,808,808,808,809,809,809,809,810,810,810,810,811,811,811,811,812,812,812,812,813,813,813,813,814,814,814,814,815,815,815,815,816,816,816,816,817,817,817,817,818,818,818,818,820,820,820,820,821,821,821,821,822,822,822,822,823,823,823,823,824,824,824,824,825,825,825,825,826,826,826,826,827,827,827,827,828,828,828,828,829,829,829,829,830,830,830,830,831,831,831,831,832,832,832,832,833,833,833,833,834,834,834,834,835,835,835,835,836,836,836,836,837,837,837,837,838,838,838,838,839,839,839,839,840,840,840,840,842,842,842,842,843,843,843,843,844,844,844,844,845,845,845,845,846,846,846,846,847,847,847,847,848,848,848,848,849,849,849,849,850,850,850,850,851,851,851,851,852,852,852,852,853,853,853,853,854,854,854,854,855,855,855,855,856,856,856,856,857,857,857,857,858,858,858,858,859,859,859,859,860,860,860,860,862,862,862,862,863,863,863,863,864,864,864,864,865,865,865,865,866,866,866,866,867,867,867,867,868,868,868,868,869,869,869,869,870,870,870,870,871,871,871,871,872,872,872,872,873,873,873,873,874,874,874,874,875,875,875,875,876,876,876,876,877,877,877,877,878,878,878,878,880,880,880,880,881,881,881,881,882,882,882,882,883,883,883,883,884,884,884,884,885,885,885,885,886,886,886,886,887,887,887,887,888,888,888,888,889,889,889,889,890,890,890,890,891,891,891,891,892,892,892,892,893,893,893,893,894,894,894,894,895,895,895,895,896,896,896,896,897,897,897,897,898,898,898,898,899,899,899,899,900,900,900,900,901,901,901,901,902,902,902,902,903,903,903,903,904,904,904,904,905,905,905,905,906,906,906,906,907,907,907,907,908,908,908,908,909,909,909,909,910,910,910,910,911,911,911,911,912,912,912,912,913,913,913,913,914,914,914,914,915,915,915,915,916,916,916,916,917,917,917,917,918,918,918,918,919,919,919,919,920,920,920,920,921,921,921,921,922,922,922,922,923,923,923,923,924,924,924,924,926,926,926,926,927,927,927,927,928,928,928,928,929,929,929,929,930,930,930,930,932,932,932,932,933,933,933,933,934,934,934,934,935,935,935,935,936,936,936,936,937,937,937,937,939,939,939,939,940,940,940,940,941,941,941,941,943,943,943,943,944,944,944,944,945,945,945,945,946,946,946,946,947,947,947,947,948,948,948,948,949,949,949,949],["1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0"],[72,72,72,72,75,75,75,75,83,83,83,83,76,76,76,76,81,81,81,81,74,74,74,74,83,83,83,83,74,74,74,74,76,76,76,76,82,82,82,82,74,74,74,74,76,76,76,76,83,83,83,83,80,80,80,80,75,75,75,75,63,63,63,63,74,74,74,74,78,78,78,78,74,74,74,74,83,83,83,83,77,77,77,77,76,76,76,76,66,66,66,66,79,79,79,79,77,77,77,77,63,63,63,63,83,83,83,83,73,73,73,73,70,70,70,70,80,80,80,80,76,76,76,76,76,76,76,76,84,84,84,84,78,78,78,78,78,78,78,78,74,74,74,74,73,73,73,73,75,75,75,75,76,76,76,76,74,74,74,74,75,75,75,75,64,64,64,64,77,77,77,77,76,76,76,76,75,75,75,75,74,74,74,74,75,75,75,75,76,76,76,76,84,84,84,84,78,78,78,78,74,74,74,74,75,75,75,75,64,64,64,64,69,69,69,69,76,76,76,76,80,80,80,80,76,76,76,76,74,74,74,74,70,70,70,70,82,82,82,82,80,80,80,80,63,63,63,63,75,75,75,75,77,77,77,77,71,71,71,71,71,71,71,71,75,75,75,75,69,69,69,69,81,81,81,81,80,80,80,80,71,71,71,71,83,83,83,83,81,81,81,81,80,80,80,80,82,82,82,82,82,82,82,82,83,83,83,83,79,79,79,79,79,79,79,79,71,71,71,71,80,80,80,80,78,78,78,78,75,75,75,75,83,83,83,83,79,79,79,79,75,75,75,75,68,68,68,68,70,70,70,70,77,77,77,77,72,72,72,72,74,74,74,74,75,75,75,75,75,75,75,75,90,90,90,90,73,73,73,73,77,77,77,77,74,74,74,74,79,79,79,79,79,79,79,79,74,74,74,74,84,84,84,84,78,78,78,78,78,78,78,78,79,79,79,79,70,70,70,70,83,83,83,83,71,71,71,71,82,82,82,82,77,77,77,77,81,81,81,81,73,73,73,73,79,79,79,79,78,78,78,78,77,77,77,77,75,75,75,75,83,83,83,83,79,79,79,79,84,84,84,84,79,79,79,79,76,76,76,76,71,71,71,71,76,76,76,76,73,73,73,73,81,81,81,81,63,63,63,63,74,74,74,74,70,70,70,70,77,77,77,77,81,81,81,81,74,74,74,74,70,70,70,70,71,71,71,71,75,75,75,75,69,69,69,69,79,79,79,79,77,77,77,77,77,77,77,77,80,80,80,80,82,82,82,82,62,62,62,62,76,76,76,76,77,77,77,77,77,77,77,77,62,62,62,62,79,79,79,79,67,67,67,67,67,67,67,67,64,64,64,64,81,81,81,81,75,75,75,75,64,64,64,64,77,77,77,77,79,79,79,79,76,76,76,76,85,85,85,85,85,85,85,85,77,77,77,77,63,63,63,63,81,81,81,81,83,83,83,83,78,78,78,78,78,78,78,78,76,76,76,76,51,51,51,51,72,72,72,72,67,67,67,67,83,83,83,83,74,74,74,74,69,69,69,69,84,84,84,84,69,69,69,69,70,70,70,70,78,78,78,78,75,75,75,75,79,79,79,79,81,81,81,81,74,74,74,74,78,78,78,78,83,83,83,83,74,74,74,74,78,78,78,78,77,77,77,77,83,83,83,83,61,61,61,61,79,79,79,79,76,76,76,76,80,80,80,80,83,83,83,83,75,75,75,75,75,75,75,75,73,73,73,73,88,88,88,88,77,77,77,77,80,80,80,80,82,82,82,82,75,75,75,75,80,80,80,80,65,65,65,65,69,69,69,69,81,81,81,81,86,86,86,86,76,76,76,76,74,74,74,74,79,79,79,79,75,75,75,75,77,77,77,77,72,72,72,72,75,75,75,75,83,83,83,83,58,58,58,58,65,65,65,65,77,77,77,77,83,83,83,83,76,76,76,76,74,74,74,74,85,85,85,85,63,63,63,63,74,74,74,74,77,77,77,77,70,70,70,70,73,73,73,73,72,72,72,72,70,70,70,70,61,61,61,61,72,72,72,72,63,63,63,63,68,68,68,68,67,67,67,67,70,70,70,70,73,73,73,73,70,70,70,70,73,73,73,73,70,70,70,70,69,69,69,69,71,71,71,71,58,58,58,58,70,70,70,70,71,71,71,71,55,55,55,55,67,67,67,67,71,71,71,71,71,71,71,71,69,69,69,69,73,73,73,73,73,73,73,73,72,72,72,72,87,87,87,87,68,68,68,68,66,66,66,66,69,69,69,69,59,59,59,59,64,64,64,64,68,68,68,68,62,62,62,62,64,64,64,64,60,60,60,60,72,72,72,72,61,61,61,61,70,70,70,70,72,72,72,72,70,70,70,70,70,70,70,70,65,65,65,65,75,75,75,75,70,70,70,70,71,71,71,71,72,72,72,72,70,70,70,70,74,74,74,74,64,64,64,64,72,72,72,72,70,70,70,70,71,71,71,71,68,68,68,68,74,74,74,74,71,71,71,71,70,70,70,70,71,71,71,71,68,68,68,68,73,73,73,73,69,69,69,69,68,68,68,68,72,72,72,72,73,73,73,73,71,71,71,71,74,74,74,74,63,63,63,63,86,86,86,86,88,88,88,88,89,89,89,89,88,88,88,88,88,88,88,88,75,75,75,75,56,56,56,56,86,86,86,86,63,63,63,63,91,91,91,91,85,85,85,85,89,89,89,89,84,84,84,84,86,86,86,86,89,89,89,89,62,62,62,62,64,64,64,64,64,64,64,64,65,65,65,65,62,62,62,62,63,63,63,63,63,63,63,63,67,67,67,67,62,62,62,62,62,62,62,62,66,66,66,66,63,63,63,63,58,58,58,58,66,66,66,66,64,64,64,64,65,65,65,65,64,64,64,64,75,75,75,75,65,65,65,65,55,55,55,55,66,66,66,66,67,67,67,67,67,67,67,67,66,66,66,66,64,64,64,64,65,65,65,65,66,66,66,66,66,66,66,66,66,66,66,66,65,65,65,65,64,64,64,64,65,65,65,65,66,66,66,66,58,58,58,58,64,64,64,64,63,63,63,63,58,58,58,58,65,65,65,65,61,61,61,61,63,63,63,63,64,64,64,64,63,63,63,63,66,66,66,66,63,63,63,63,63,63,63,63,62,62,62,62,63,63,63,63,62,62,62,62,52,52,52,52,64,64,64,64,64,64,64,64,66,66,66,66,67,67,67,67,66,66,66,66,68,68,68,68,66,66,66,66,56,56,56,56,60,60,60,60,64,64,64,64,64,64,64,64,66,66,66,66,66,66,66,66,63,63,63,63,63,63,63,63,65,65,65,65,62,62,62,62,68,68,68,68,67,67,67,67,67,67,67,67,52,52,52,52,68,68,68,68,64,64,64,64,66,66,66,66,66,66,66,66,62,62,62,62,64,64,64,64,64,64,64,64,67,67,67,67,66,66,66,66,66,66,66,66,63,63,63,63,62,62,62,62,65,65,65,65,66,66,66,66,63,63,63,63,63,63,63,63,64,64,64,64,61,61,61,61,67,67,67,67,65,65,65,65,60,60,60,60,65,65,65,65,66,66,66,66,63,63,63,63,62,62,62,62,67,67,67,67,65,65,65,65,61,61,61,61,66,66,66,66,64,64,64,64,63,63,63,63,62,62,62,62,58,58,58,58,52,52,52,52,52,52,52,52,57,57,57,57,59,59,59,59,61,61,61,61,60,60,60,60,56,56,56,56,60,60,60,60,63,63,63,63,62,62,62,62,50,50,50,50,59,59,59,59,61,61,61,61,59,59,59,59,61,61,61,61,68,68,68,68,56,56,56,56,55,55,55,55,60,60,60,60,63,63,63,63,58,58,58,58,58,58,58,58,60,60,60,60,60,60,60,60,57,57,57,57,53,53,53,53,62,62,62,62,61,61,61,61,67,67,67,67,58,58,58,58,56,56,56,56,57,57,57,57,61,61,61,61,62,62,62,62,57,57,57,57,60,60,60,60,59,59,59,59,58,58,58,58,62,62,62,62,56,56,56,56,52,52,52,52,58,58,58,58,57,57,57,57,53,53,53,53,60,60,60,60,57,57,57,57,53,53,53,53,60,60,60,60,58,58,58,58,56,56,56,56,55,55,55,55,61,61,61,61,59,59,59,59,58,58,58,58,61,61,61,61,52,52,52,52,60,60,60,60,70,70,70,70,60,60,60,60,62,62,62,62,56,56,56,56,59,59,59,59,62,62,62,62,57,57,57,57,61,61,61,61,56,56,56,56,60,60,60,60,58,58,58,58,68,68,68,68,60,60,60,60,56,56,56,56,61,61,61,61,57,57,57,57,58,58,58,58,58,58,58,58,60,60,60,60,58,58,58,58,58,58,58,58,59,59,59,59,64,64,64,64,58,58,58,58,56,56,56,56,55,55,55,55,54,54,54,54,59,59,59,59,58,58,58,58,60,60,60,60,58,58,58,58,57,57,57,57,58,58,58,58,57,57,57,57,61,61,61,61,60,60,60,60,55,55,55,55,58,58,58,58,62,62,62,62,62,62,62,62,62,62,62,62,58,58,58,58,60,60,60,60,57,57,57,57,59,59,59,59,58,58,58,58,60,60,60,60,64,64,64,64,61,61,61,61,60,60,60,60,56,56,56,56,59,59,59,59,60,60,60,60,60,60,60,60,62,62,62,62,58,58,58,58,53,53,53,53,61,61,61,61,60,60,60,60,64,64,64,64,56,56,56,56,57,57,57,57,50,50,50,50,55,55,55,55,60,60,60,60,57,57,57,57,62,62,62,62,56,56,56,56,52,52,52,52,57,57,57,57,58,58,58,58,59,59,59,59,60,60,60,60,60,60,60,60,59,59,59,59,61,61,61,61,57,57,57,57,61,61,61,61,55,55,55,55,54,54,54,54,61,61,61,61,60,60,60,60,59,59,59,59,62,62,62,62,56,56,56,56,59,59,59,59,56,56,56,56,58,58,58,58,69,69,69,69,58,58,58,58,60,60,60,60,67,67,67,67,68,68,68,68,63,63,63,63,66,66,66,66,61,61,61,61,51,51,51,51,56,56,56,56,64,64,64,64,57,57,57,57,58,58,58,58,60,60,60,60,61,61,61,61,60,60,60,60,68,68,68,68,59,59,59,59,59,59,59,59,66,66,66,66,54,54,54,54,59,59,59,59,57,57,57,57,59,59,59,59,59,59,59,59,58,58,58,58,59,59,59,59,51,51,51,51,59,59,59,59,65,65,65,65,50,50,50,50,55,55,55,55,59,59,59,59,61,61,61,61,64,64,64,64,57,57,57,57,61,61,61,61,57,57,57,57,63,63,63,63,61,61,61,61,50,50,50,50,51,51,51,51,61,61,61,61,65,65,65,65,61,61,61,61,66,66,66,66,59,59,59,59,66,66,66,66,57,57,57,57,57,57,57,57,59,59,59,59,65,65,65,65,59,59,59,59,58,58,58,58,58,58,58,58,58,58,58,58,54,54,54,54,55,55,55,55,56,56,56,56,53,53,53,53,51,51,51,51,52,52,52,52,55,55,55,55,51,51,51,51,54,54,54,54,56,56,56,56,56,56,56,56,52,52,52,52,54,54,54,54,50,50,50,50,50,50,50,50,55,55,55,55,50,50,50,50,54,54,54,54,52,52,52,52,56,56,56,56,51,51,51,51,55,55,55,55,55,55,55,55,52,52,52,52,52,52,52,52,54,54,54,54,52,52,52,52,57,57,57,57,54,54,54,54,54,54,54,54,53,53,53,53,54,54,54,54,50,50,50,50,53,53,53,53,55,55,55,55,53,53,53,53,50,50,50,50,53,53,53,53,57,57,57,57,55,55,55,55,56,56,56,56,54,54,54,54,54,54,54,54,53,53,53,53,55,55,55,55,54,54,54,54,56,56,56,56,54,54,54,54,54,54,54,54,51,51,51,51,50,50,50,50,51,51,51,51,57,57,57,57,55,55,55,55,55,55,55,55,53,53,53,53,65,65,65,65,52,52,52,52,56,56,56,56,52,52,52,52,52,52,52,52,55,55,55,55,52,52,52,52,51,51,51,51,61,61,61,61,54,54,54,54,54,54,54,54,54,54,54,54,53,53,53,53,54,54,54,54,52,52,52,52,56,56,56,56,56,56,56,56,53,53,53,53,51,51,51,51,54,54,54,54,53,53,53,53,51,51,51,51,53,53,53,53,52,52,52,52,56,56,56,56,56,56,56,56,51,51,51,51,53,53,53,53,66,66,66,66,59,59,59,59,53,53,53,53,52,52,52,52,54,54,54,54,56,56,56,56,52,52,52,52,51,51,51,51,50,50,50,50,56,56,56,56,52,52,52,52,52,52,52,52,50,50,50,50,51,51,51,51,54,54,54,54,55,55,55,55,50,50,50,50,54,54,54,54,54,54,54,54,55,55,55,55,52,52,52,52,55,55,55,55,51,51,51,51,51,51,51,51,51,51,51,51,50,50,50,50,55,55,55,55,55,55,55,55,53,53,53,53,53,53,53,53,53,53,53,53,54,54,54,54,52,52,52,52,50,50,50,50,52,52,52,52,54,54,54,54,52,52,52,52,52,52,52,52,54,54,54,54,50,50,50,50,55,55,55,55,51,51,51,51,51,51,51,51,53,53,53,53,51,51,51,51,51,51,51,51,51,51,51,51,52,52,52,52,50,50,50,50,51,51,51,51,55,55,55,55,50,50,50,50,50,50,50,50,56,56,56,56,52,52,52,52,50,50,50,50,54,54,54,54,56,56,56,56,51,51,51,51,53,53,53,53,56,56,56,56,55,55,55,55,53,53,53,53,52,52,52,52,51,51,51,51,51,51,51,51,51,51,51,51,54,54,54,54,52,52,52,52,55,55,55,55,53,53,53,53,52,52,52,52,53,53,53,53,53,53,53,53,58,58,58,58,51,51,51,51,60,60,60,60,56,56,56,56,61,61,61,61,69,69,69,69,55,55,55,55,65,65,65,65,53,53,53,53,73,73,73,73,66,66,66,66,63,63,63,63,63,63,63,63,66,66,66,66,58,58,58,58,58,58,58,58,66,66,66,66,61,61,61,61,64,64,64,64,62,62,62,62,62,62,62,62,68,68,68,68,61,61,61,61,63,63,63,63,60,60,60,60,54,54,54,54,65,65,65,65,58,58,58,58,61,61,61,61,53,53,53,53,65,65,65,65,55,55,55,55,59,59,59,59,63,63,63,63,57,57,57,57,57,57,57,57,62,62,62,62,50,50,50,50,58,58,58,58,59,59,59,59,57,57,57,57,63,63,63,63,70,70,70,70,67,67,67,67,74,74,74,74,62,62,62,62,57,57,57,57,60,60,60,60,62,62,62,62,68,68,68,68,56,56,56,56,58,58,58,58,62,62,62,62,57,57,57,57,55,55,55,55,61,61,61,61,56,56,56,56,65,65,65,65,67,67,67,67,62,62,62,62,63,63,63,63,55,55,55,55,53,53,53,53,65,65,65,65,66,66,66,66,66,66,66,66,59,59,59,59,61,61,61,61,70,70,70,70,67,67,67,67,63,63,63,63,58,58,58,58,62,62,62,62,58,58,58,58,58,58,58,58,60,60,60,60,60,60,60,60,60,60,60,60,58,58,58,58,58,58,58,58,62,62,62,62,56,56,56,56,56,56,56,56,56,56,56,56,61,61,61,61,65,65,65,65,64,64,64,64,50,50,50,50,63,63,63,63,59,59,59,59,67,67,67,67,52,52,52,52,62,62,62,62,63,63,63,63,60,60,60,60,58,58,58,58,63,63,63,63,64,64,64,64,56,56,56,56,58,58,58,58,56,56,56,56,52,52,52,52,65,65,65,65,55,55,55,55,59,59,59,59,59,59,59,59,60,60,60,60,65,65,65,65,61,61,61,61,58,58,58,58,57,57,57,57,65,65,65,65,69,69,69,69,62,62,62,62,69,69,69,69,62,62,62,62,72,72,72,72,62,62,62,62,56,56,56,56,73,73,73,73],["2","2","2","2","2","2","2","2","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","2","2","2","2","1","1","1","1","2","2","2","2","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","2","2","2","2","0","0","0","0","2","2","2","2","1","1","1","1","2","2","2","2","1","1","1","1","2","2","2","2","1","1","1","1","2","2","2","2","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","2","2","2","2","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","1","1","1","1","2","2","2","2","0","0","0","0","1","1","1","1","1","1","1","1","2","2","2","2","1","1","1","1","2","2","2","2","1","1","1","1","2","2","2","2","2","2","2","2","2","2","2","2","0","0","0","0","2","2","2","2","2","2","2","2","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","1","1","1","1","2","2","2","2","2","2","2","2","1","1","1","1","2","2","2","2","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","2","2","2","2","2","2","2","2","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","2","2","2","2","2","2","2","2","2","2","2","2","1","1","1","1","2","2","2","2","2","2","2","2","2","2","2","2","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","2","2","2","2","2","2","2","2","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","0","0","0","0","2","2","2","2","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","2","2","2","2","2","2","2","2","2","2","2","2","1","1","1","1","2","2","2","2","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","2","2","2","2","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","2","2","2","2","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","2","2","2","2","2","2","2","2","1","1","1","1","1","1","1","1","2","2","2","2","2","2","2","2","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","2","2","2","2","2","2","2","2","2","2","2","2","1","1","1","1","0","0","0","0","2","2","2","2","2","2","2","2","0","0","0","0","1","1","1","1","2","2","2","2","1","1","1","1","2","2","2","2","1","1","1","1","2","2","2","2","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","1","1","1","1","0","0","0","0","2","2","2","2","1","1","1","1","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","2","2","2","2",null,null,null,null,"0","0","0","0","2","2","2","2","1","1","1","1","2","2","2","2","2","2","2","2","2","2","2","2","1","1","1","1","2","2","2","2","2","2","2","2","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","2","2","2","2","1","1","1","1","0","0","0","0","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","0","0","0","0","2","2","2","2","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","2","2","2","2","0","0","0","0","2","2","2","2","2","2","2","2","1","1","1","1","1","1","1","1","0","0","0","0","2","2","2","2","1","1","1","1","1","1","1","1","2","2","2","2","1","1","1","1","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","1","1","1","1","2","2","2","2","2","2","2","2","1","1","1","1","1","1","1","1","1","1","1","1","2","2","2","2","1","1","1","1","0","0","0","0",null,null,null,null,"0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","2","2","2","2","1","1","1","1","2","2","2","2","0","0","0","0","2","2","2","2","2","2","2","2","0","0","0","0","2","2","2","2","2","2","2","2","1","1","1","1","2","2","2","2","1","1","1","1","2","2","2","2","2","2","2","2","1","1","1","1","2","2","2","2","1","1","1","1","2","2","2","2","2","2","2","2",null,null,null,null,"0","0","0","0","0","0","0","0","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","2","2","2","2","2","2","2","2","2","2","2","2","1","1","1","1","2","2","2","2","1","1","1","1","2","2","2","2","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","2","2","2","2","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","2","2","2","2","1","1","1","1","2","2","2","2","2","2","2","2","0","0","0","0","2","2","2","2","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","2","2","2","2","1","1","1","1",null,null,null,null,"2","2","2","2","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","2","2","2","2","1","1","1","1",null,null,null,null,"1","1","1","1","2","2","2","2","2","2","2","2","2","2","2","2","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","2","2","2","2","2","2","2","2","2","2","2","2","1","1","1","1","0","0","0","0","1","1","1","1","2","2","2","2","0","0","0","0","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","0","0","0","0","2","2","2","2","1","1","1","1","2","2","2","2","2","2","2","2","2","2","2","2","1","1","1","1","1","1","1","1","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","2","2","2","2","2","2","2","2","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","2","2","2","2","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","1","1","1","1","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","1","1","1","1","2","2","2","2","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","2","2","2","2","0","0","0","0","2","2","2","2","1","1","1","1","0","0","0","0","2","2","2","2","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","2","2","2","2","2","2","2","2","1","1","1","1","1","1","1","1","2","2","2","2","2","2","2","2","1","1","1","1","2","2","2","2","1","1","1","1","2","2","2","2","0","0","0","0","1","1","1","1","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","2","2","2","2","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","1","1","1","1","1","1","1","1","1","1","1","1","2","2","2","2","0","0","0","0","1","1","1","1","1","1","1","1","2","2","2","2","1","1","1","1","2","2","2","2","2","2","2","2","2","2","2","2","1","1","1","1","2","2","2","2","1","1","1","1","2","2","2","2","1","1","1","1","2","2","2","2","0","0","0","0","2","2","2","2","2","2","2","2","2","2","2","2","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","2","2","2","2","2","2","2","2","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","2","2","2","2","0","0","0","0","0","0","0","0","0","0","0","0","2","2","2","2","2","2","2","2","0","0","0","0","1","1","1","1","1","1","1","1","2","2","2","2","1","1","1","1","0","0","0","0",null,null,null,null,"1","1","1","1","1","1","1","1","1","1","1","1",null,null,null,null,"0","0","0","0","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","1","1","1","1","1","1","1","1","1","1","1","1","2","2","2","2","1","1","1","1","0","0","0","0","0","0","0","0","2","2","2","2","1","1","1","1","2","2","2","2","2","2","2","2","2","2","2","2","1","1","1","1","1","1","1","1","2","2","2","2",null,null,null,null,"2","2","2","2","1","1","1","1","2","2","2","2","1","1","1","1","2","2","2","2","1","1","1","1","2","2","2","2","2","2","2","2","0","0","0","0","1","1","1","1","1","1","1","1","0","0","0","0","2","2","2","2","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","2","2","2","2","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","2","2","2","2","0","0","0","0","2","2","2","2","2","2","2","2",null,null,null,null,"2","2","2","2","2","2","2","2","1","1","1","1","2","2","2","2","2","2","2","2",null,null,null,null,"1","1","1","1","1","1","1","1","2","2","2","2","2","2","2","2","0","0","0","0","1","1","1","1","1","1","1","1","2","2","2","2","2","2","2","2",null,null,null,null,"0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","2","2","2","2","2","2","2","2","1","1","1","1","1","1","1","1","2","2","2","2","2","2","2","2","0","0","0","0","1","1","1","1",null,null,null,null,"2","2","2","2","1","1","1","1",null,null,null,null,"1","1","1","1","2","2","2","2",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"2","2","2","2",null,null,null,null,null,null,null,null,"0","0","0","0",null,null,null,null,"2","2","2","2","0","0","0","0","1","1","1","1","0","0","0","0",null,null,null,null,null,null,null,null,null,null,null,null,"1","1","1","1","2","2","2","2","2","2","2","2","2","2","2","2",null,null,null,null,"2","2","2","2",null,null,null,null,"2","2","2","2","1","1","1","1","0","0","0","0","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","0","0","0","0",null,null,null,null,null,null,null,null,"1","1","1","1","2","2","2","2","2","2","2","2",null,null,null,null,null,null,null,null,"0","0","0","0","2","2","2","2","1","1","1","1","2","2","2","2",null,null,null,null,"1","1","1","1","0","0","0","0","2","2","2","2","2","2","2","2","2","2","2","2",null,null,null,null,"0","0","0","0","1","1","1","1",null,null,null,null,"0","0","0","0",null,null,null,null,null,null,null,null,"2","2","2","2","2","2","2","2","0","0","0","0","2","2","2","2",null,null,null,null,"2","2","2","2","2","2","2","2","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1",null,null,null,null,"1","1","1","1","1","1","1","1","2","2","2","2","2","2","2","2","1","1","1","1","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","0","0","0","0","1","1","1","1","0","0","0","0","2","2","2","2","2","2","2","2","2","2","2","2",null,null,null,null,"2","2","2","2","2","2","2","2","1","1","1","1","0","0","0","0","0","0","0","0","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","2","1","1","1","1","0","0","0","0","2","2","2","2",null,null,null,null,"2","2","2","2","1","1","1","1","1","1","1","1","1","1","1","1",null,null,null,null,"1","1","1","1",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,"2","2","2","2","2","2","2","2","2","2","2","2","1","1","1","1","0","0","0","0","0","0","0","0","1","1","1","1",null,null,null,null,"2","2","2","2","1","1","1","1","2","2","2","2",null,null,null,null,"2","2","2","2","2","2","2","2","1","1","1","1","0","0","0","0","1","1","1","1","2","2","2","2","2","2","2","2","2","2","2","2","1","1","1","1","1","1","1","1","0","0","0","0","2","2","2","2","1","1","1","1","2","2","2","2","2","2","2","2","0","0","0","0","1","1","1","1","1","1","1","1","2","2","2","2","0","0","0","0","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1",null,null,null,null,"1","1","1","1","2","2","2","2","2","2","2","2","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","1","1","1","1","1","1","1","1","2","2","2","2","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","2","2","2","2","2","2","2","2","2","2","2","2","1","1","1","1","1","1","1","1",null,null,null,null,"1","1","1","1","1","1","1","1","2","2","2","2","0","0","0","0","2","2","2","2","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","2","2","2","2","2","2","2","2","0","0","0","0","0","0","0","0","2","2","2","2","2","2","2","2","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","1","1","1","1","2","2","2","2","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","1","1","1","1","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","1","1","1","1","2","2","2","2","1","1","1","1","0","0","0","0","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","1","1","1","1",null,null,null,null,"0","0","0","0","1","1","1","1","1","1","1","1","2","2","2","2","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","1","0","0","0","0","2","2","2","2","2","2","2","2","1","1","1","1","1","1","1","1","2","2","2","2","1","1","1","1"],[0,0,0,0,1,1,1,1,1,1,1,1,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,0,0,0,0,3,3,3,3,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,3,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,1,1,1,1,2,2,2,2,1,1,1,1,0,0,0,0,4,4,4,4,2,2,2,2,0,0,0,0,1,1,1,1,3,3,3,3,3,3,3,3,1,1,1,1,1,1,1,1,2,2,2,2,1,1,1,1,0,0,0,0,0,0,0,0,2,2,2,2,1,1,1,1,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,1,1,1,1,2,2,2,2,2,2,2,2,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,2,2,2,2,0,0,0,0,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,4,4,4,4,3,3,3,3,4,4,4,4,2,2,2,2,0,0,0,0,1,1,1,1,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,1,1,1,1,2,2,2,2,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,3,3,3,3,2,2,2,2,2,2,2,2,3,3,3,3,0,0,0,0,1,1,1,1,2,2,2,2,2,2,2,2,3,3,3,3,1,1,1,1,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,3,3,3,3,2,2,2,2,3,3,3,3,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,1,1,1,1,1,1,1,1,0,0,0,0,3,3,3,3,1,1,1,1,1,1,1,1,3,3,3,3,2,2,2,2,2,2,2,2,0,0,0,0,2,2,2,2,4,4,4,4,2,2,2,2,3,3,3,3,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,2,2,2,2,1,1,1,1,3,3,3,3,2,2,2,2,2,2,2,2,0,0,0,0,3,3,3,3,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,3,3,3,3,2,2,2,2,1,1,1,1,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,0,0,0,0,2,2,2,2,0,0,0,0,3,3,3,3,3,3,3,3,2,2,2,2,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,2,2,2,2,0,0,0,0,2,2,2,2,1,1,1,1,3,3,3,3,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,2,2,2,2,1,1,1,1,1,1,1,1,2,2,2,2,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,2,2,2,2,3,3,3,3,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,1,1,1,1,0,0,0,0,2,2,2,2,1,1,1,1,2,2,2,2,3,3,3,3,2,2,2,2,3,3,3,3,1,1,1,1,2,2,2,2,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,4,4,4,4,2,2,2,2,2,2,2,2,1,1,1,1,2,2,2,2,0,0,0,0,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,1,1,1,1,0,0,0,0,1,1,1,1,2,2,2,2,2,2,2,2,0,0,0,0,1,1,1,1,0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,1,1,1,1,4,4,4,4,0,0,0,0,2,2,2,2,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,1,1,1,1,2,2,2,2,1,1,1,1,2,2,2,2,1,1,1,1,2,2,2,2,2,2,2,2,1,1,1,1,0,0,0,0,2,2,2,2,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,2,2,2,2,0,0,0,0,2,2,2,2,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,1,1,1,1,2,2,2,2,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,0,0,0,0,3,3,3,3,3,3,3,3,0,0,0,0,2,2,2,2,1,1,1,1,2,2,2,2,2,2,2,2,1,1,1,1,3,3,3,3,3,3,3,3,0,0,0,0,3,3,3,3,0,0,0,0,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,3,3,3,3,3,3,3,3,0,0,0,0,2,2,2,2,1,1,1,1,1,1,1,1,2,2,2,2,1,1,1,1,2,2,2,2,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,1,1,1,1,2,2,2,2,3,3,3,3,1,1,1,1,1,1,1,1,4,4,4,4,1,1,1,1,2,2,2,2,1,1,1,1,2,2,2,2,2,2,2,2,1,1,1,1,0,0,0,0,3,3,3,3,2,2,2,2,0,0,0,0,1,1,1,1,2,2,2,2,1,1,1,1,3,3,3,3,1,1,1,1,0,0,0,0,3,3,3,3,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,1,1,1,1,3,3,3,3,1,1,1,1,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,3,3,3,3,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,2,2,2,2,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,2,2,2,2,0,0,0,0,2,2,2,2,0,0,0,0,1,1,1,1,1,1,1,1,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,2,2,2,2,3,3,3,3,2,2,2,2,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,0,0,0,0,2,2,2,2,1,1,1,1,1,1,1,1,0,0,0,0,2,2,2,2,0,0,0,0,3,3,3,3,1,1,1,1,3,3,3,3,1,1,1,1,0,0,0,0,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,2,2,2,2,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,2,2,2,2,1,1,1,1,1,1,1,1,2,2,2,2,1,1,1,1,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,3,3,3,3,2,2,2,2,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,1,1,1,1,2,2,2,2,1,1,1,1,1,1,1,1,4,4,4,4,1,1,1,1,2,2,2,2,1,1,1,1,0,0,0,0,3,3,3,3,2,2,2,2,1,1,1,1,3,3,3,3,0,0,0,0,2,2,2,2,0,0,0,0,2,2,2,2,0,0,0,0,3,3,3,3,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,1,1,1,1,2,2,2,2,3,3,3,3,1,1,1,1,2,2,2,2,2,2,2,2,1,1,1,1,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,2,2,2,2,0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,1,1,1,1,2,2,2,2,1,1,1,1,1,1,1,1,2,2,2,2,1,1,1,1,3,3,3,3,2,2,2,2,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,3,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,2,2,2,2,0,0,0,0,1,1,1,1,1,1,1,1,2,2,2,2,1,1,1,1,2,2,2,2,1,1,1,1,1,1,1,1,2,2,2,2,0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,0,0,0,0,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,2,2,2,2,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,2,2,2,2,0,0,0,0,2,2,2,2,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,0,0,0,0,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,3,3,3,3,2,2,2,2,0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,2,2,2,2,0,0,0,0,2,2,2,2,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,2,2,2,2,1,1,1,1,1,1,1,1,2,2,2,2,1,1,1,1,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,4,4,4,4,0,0,0,0,1,1,1,1,3,3,3,3,3,3,3,3,2,2,2,2,0,0,0,0,3,3,3,3,0,0,0,0,2,2,2,2,1,1,1,1,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,3,3,3,3,2,2,2,2,0,0,0,0,2,2,2,2,1,1,1,1,2,2,2,2,1,1,1,1,0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,2,2,2,2,0,0,0,0,2,2,2,2,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,2,2,2,2,0,0,0,0,2,2,2,2,1,1,1,1,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,1,1,1,1,1,1,1,1,2,2,2,2,0,0,0,0,2,2,2,2,1,1,1,1,2,2,2,2,1,1,1,1,2,2,2,2,2,2,2,2,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,1,1,1,1,1,1,1,1,2,2,2,2,0,0,0,0,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,3,3,3,3,1,1,1,1,0,0,0,0,1,1,1,1,2,2,2,2,0,0,0,0,3,3,3,3,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,3,3,3,3,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,2,2,2,2,1,1,1,1,2,2,2,2,0,0,0,0,2,2,2,2,2,2,2,2,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,2,2,2,2,1,1,1,1,2,2,2,2,1,1,1,1,0,0,0,0,1,1,1,1,2,2,2,2,0,0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,3,3,3,3,1,1,1,1,1,1,1,1,2,2,2,2,1,1,1,1,0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,2,2,2,2,1,1,1,1,0,0,0,0,2,2,2,2,2,2,2,2,1,1,1,1,4,4,4,4,3,3,3,3,2,2,2,2,1,1,1,1,2,2,2,2,0,0,0,0,2,2,2,2,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,2,2,2,2,3,3,3,3,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,0,0,0,0,1,1,1,1,0,0,0,0,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,2,2,2,2,0,0,0,0,3,3,3,3,1,1,1,1,2,2,2,2,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,3,3,3,3,0,0,0,0,3,3,3,3,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,1,1,1,1,3,3,3,3,0,0,0,0,2,2,2,2,0,0,0,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,2,2,2,2,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,3,3,3,3,2,2,2,2,2,2,2,2,0,0,0,0,2,2,2,2,3,3,3,3,3,3,3,3],[0,0,0,0,2,2,2,2,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,3,3,3,3,0,0,0,0,4,4,4,4,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5,0,0,0,0,1,1,1,1,0,0,0,0,5,5,5,5,0,0,0,0,2,2,2,2,2,2,2,2,1,1,1,1,0,0,0,0,2,2,2,2,1,1,1,1,0,0,0,0,0,0,0,0,5,5,5,5,0,0,0,0,2,2,2,2,1,1,1,1,5,5,5,5,2,2,2,2,0,0,0,0,2,2,2,2,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,7,7,7,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,2,2,2,2,1,1,1,1,2,2,2,2,2,2,2,2,3,3,3,3,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,5,5,5,5,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,3,2,2,2,2,0,0,0,0,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,3,2,2,2,2,0,0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,1,1,1,1,0,0,0,0,6,6,6,6,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,1,1,1,1,8,8,8,8,5,5,5,5,0,0,0,0,0,0,0,0,0,0,0,0,7,7,7,7,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,3,2,2,2,2,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,4,4,4,4,4,4,4,4,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,3,3,3,3,0,0,0,0,0,0,0,0,2,2,2,2,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,0,0,0,0,0,0,0,0,1,1,1,1,4,4,4,4,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,1,1,1,1,2,2,2,2,4,4,4,4,1,1,1,1,0,0,0,0,4,4,4,4,0,0,0,0,0,0,0,0,3,3,3,3,1,1,1,1,1,1,1,1,0,0,0,0,6,6,6,6,0,0,0,0,0,0,0,0,6,6,6,6,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,1,1,1,1,7,7,7,7,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,2,2,2,2,0,0,0,0,6,6,6,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,5,5,5,5,0,0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,1,1,1,1,5,5,5,5,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,2,2,2,2,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,1,1,1,1,0,0,0,0,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,7,7,7,7,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,2,2,2,2,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,3,3,3,3,2,2,2,2,0,0,0,0,0,0,0,0,4,4,4,4,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,6,6,6,6,1,1,1,1,4,4,4,4,7,7,7,7,5,5,5,5,2,2,2,2,0,0,0,0,1,1,1,1,7,7,7,7,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,3,3,3,3,6,6,6,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,5,5,5,5,7,7,7,7,6,6,6,6,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,4,4,4,4,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,7,7,7,7,8,8,8,8,1,1,1,1,0,0,0,0,2,2,2,2,0,0,0,0,2,2,2,2,4,4,4,4,4,4,4,4,0,0,0,0,0,0,0,0,1,1,1,1,7,7,7,7,2,2,2,2,5,5,5,5,0,0,0,0,1,1,1,1,0,0,0,0,5,5,5,5,8,8,8,8,1,1,1,1,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,3,0,0,0,0,3,3,3,3,1,1,1,1,0,0,0,0,0,0,0,0,7,7,7,7,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,3,3,3,3,0,0,0,0,1,1,1,1,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,0,0,0,0,0,0,0,0,7,7,7,7,1,1,1,1,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,1,1,1,1,0,0,0,0,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5,0,0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,6,6,6,6,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,7,7,7,7,2,2,2,2,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,2,2,2,2,7,7,7,7,0,0,0,0,3,3,3,3,6,6,6,6,3,3,3,3,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5,5,5,5,5,1,1,1,1,2,2,2,2,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,4,4,4,4,1,1,1,1,3,3,3,3,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,6,6,6,6,0,0,0,0,1,1,1,1,5,5,5,5,0,0,0,0,0,0,0,0,2,2,2,2,1,1,1,1,1,1,1,1,6,6,6,6,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,0,0,0,0,2,2,2,2,3,3,3,3,1,1,1,1,2,2,2,2,0,0,0,0,3,3,3,3,0,0,0,0,4,4,4,4,3,3,3,3,0,0,0,0,0,0,0,0,0,0,0,0,7,7,7,7,1,1,1,1,7,7,7,7,5,5,5,5,4,4,4,4,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,0,0,0,0,1,1,1,1,4,4,4,4,0,0,0,0,2,2,2,2,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,2,2,2,2,7,7,7,7,0,0,0,0,7,7,7,7,2,2,2,2,4,4,4,4,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,7,7,7,7,0,0,0,0,1,1,1,1,3,3,3,3,0,0,0,0,1,1,1,1,1,1,1,1,4,4,4,4,0,0,0,0,5,5,5,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,4,4,4,0,0,0,0,1,1,1,1,0,0,0,0,2,2,2,2,1,1,1,1,0,0,0,0,2,2,2,2,2,2,2,2,0,0,0,0,0,0,0,0,4,4,4,4,6,6,6,6,0,0,0,0,2,2,2,2,1,1,1,1,2,2,2,2,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,3,2,2,2,2,0,0,0,0,3,3,3,3,3,3,3,3,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,2,2,2,2,1,1,1,1,0,0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,0,0,0,0,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,3,3,3,3,0,0,0,0,1,1,1,1,0,0,0,0,7,7,7,7,0,0,0,0,2,2,2,2,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,5,5,5,5,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,7,7,7,7,0,0,0,0,1,1,1,1,2,2,2,2,1,1,1,1,0,0,0,0,1,1,1,1,4,4,4,4,1,1,1,1,0,0,0,0,3,3,3,3,0,0,0,0,7,7,7,7,0,0,0,0,1,1,1,1,2,2,2,2,0,0,0,0,5,5,5,5,0,0,0,0,7,7,7,7,0,0,0,0,1,1,1,1,2,2,2,2,5,5,5,5,1,1,1,1,7,7,7,7,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,7,7,7,7,7,7,7,7,1,1,1,1,8,8,8,8,0,0,0,0,0,0,0,0,2,2,2,2,8,8,8,8,3,3,3,3,0,0,0,0,2,2,2,2,0,0,0,0,4,4,4,4,1,1,1,1,6,6,6,6,1,1,1,1,1,1,1,1,0,0,0,0,7,7,7,7,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,2,2,2,2,2,2,2,2,5,5,5,5,0,0,0,0,2,2,2,2,0,0,0,0,1,1,1,1,6,6,6,6,0,0,0,0,1,1,1,1,1,1,1,1,5,5,5,5,2,2,2,2,1,1,1,1,6,6,6,6,1,1,1,1,3,3,3,3,2,2,2,2,6,6,6,6,0,0,0,0,4,4,4,4,7,7,7,7,0,0,0,0,1,1,1,1,0,0,0,0,6,6,6,6,0,0,0,0,1,1,1,1,2,2,2,2,1,1,1,1,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,8,8,8,8,5,5,5,5,1,1,1,1,3,3,3,3,0,0,0,0,1,1,1,1,0,0,0,0,2,2,2,2,5,5,5,5,2,2,2,2,3,3,3,3,7,7,7,7,0,0,0,0,2,2,2,2,4,4,4,4,8,8,8,8,1,1,1,1,0,0,0,0,0,0,0,0,5,5,5,5,1,1,1,1,2,2,2,2,1,1,1,1,0,0,0,0,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,5,5,5,5,1,1,1,1,0,0,0,0,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,2,2,2,2,1,1,1,1,3,3,3,3,0,0,0,0,3,3,3,3,4,4,4,4,0,0,0,0,1,1,1,1,4,4,4,4,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,2,2,2,2,3,3,3,3,1,1,1,1,1,1,1,1,4,4,4,4,0,0,0,0,0,0,0,0,0,0,0,0,3,3,3,3,0,0,0,0,4,4,4,4,7,7,7,7,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,3,3,3,3,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,8,8,8,8,7,7,7,7,1,1,1,1,6,6,6,6,0,0,0,0,6,6,6,6,4,4,4,4,4,4,4,4,7,7,7,7,1,1,1,1,1,1,1,1,0,0,0,0,4,4,4,4,3,3,3,3,6,6,6,6,2,2,2,2,4,4,4,4,0,0,0,0,0,0,0,0,7,7,7,7,6,6,6,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,0,0,0,0,1,1,1,1,0,0,0,0,4,4,4,4,1,1,1,1,4,4,4,4,0,0,0,0,3,3,3,3,0,0,0,0,3,3,3,3,3,3,3,3,1,1,1,1,2,2,2,2,1,1,1,1,4,4,4,4,4,4,4,4,0,0,0,0,1,1,1,1,2,2,2,2,1,1,1,1,1,1,1,1,0,0,0,0,3,3,3,3,8,8,8,8,7,7,7,7,7,7,7,7,1,1,1,1,1,1,1,1,0,0,0,0,2,2,2,2,1,1,1,1,2,2,2,2,0,0,0,0,0,0,0,0,0,0,0,0,8,8,8,8,5,5,5,5,8,8,8,8,3,3,3,3,2,2,2,2,0,0,0,0,4,4,4,4,0,0,0,0,2,2,2,2,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,3,3,3,3,7,7,7,7,3,3,3,3,5,5,5,5,0,0,0,0,2,2,2,2,0,0,0,0,3,3,3,3,4,4,4,4,0,0,0,0,5,5,5,5,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,4,4,4,4,1,1,1,1,0,0,0,0,8,8,8,8,0,0,0,0,0,0,0,0,6,6,6,6,5,5,5,5,3,3,3,3,1,1,1,1,0,0,0,0,2,2,2,2,1,1,1,1],[22,22,22,22,41,41,41,41,60,60,60,60,16,16,16,16,20,20,20,20,21,21,21,21,35,35,35,35,38,38,38,38,12,12,12,12,27,27,27,27,12,12,12,12,14,14,14,14,19,19,19,19,15,15,15,15,19,19,19,19,27,27,27,27,28,28,28,28,32,32,32,32,17,17,17,17,39,39,39,39,21,21,21,21,45,45,45,45,22,22,22,22,17,17,17,17,22,22,22,22,26,26,26,26,41,41,41,41,30,30,30,30,13,13,13,13,35,35,35,35,32,32,32,32,26,26,26,26,13,13,13,13,36,36,36,36,21,21,21,21,34,34,34,34,34,34,34,34,14,14,14,14,12,12,12,12,20,20,20,20,34,34,34,34,43,43,43,43,19,19,19,19,32,32,32,32,56,56,56,56,20,20,20,20,43,43,43,43,44,44,44,44,19,19,19,19,40,40,40,40,28,28,28,28,12,12,12,12,26,26,26,26,26,26,26,26,37,37,37,37,39,39,39,39,32,32,32,32,25,25,25,25,30,30,30,30,19,19,19,19,33,33,33,33,37,37,37,37,27,27,27,27,32,32,32,32,12,12,12,12,60,60,60,60,30,30,30,30,26,26,26,26,31,31,31,31,19,19,19,19,13,13,13,13,17,17,17,17,40,40,40,40,38,38,38,38,44,44,44,44,28,28,28,28,13,13,13,13,17,17,17,17,52,52,52,52,17,17,17,17,24,24,24,24,48,48,48,48,12,12,12,12,25,25,25,25,22,22,22,22,9,9,9,9,17,17,17,17,39,39,39,39,28,28,28,28,44,44,44,44,34,34,34,34,22,22,22,22,38,38,38,38,46,46,46,46,17,17,17,17,60,60,60,60,50,50,50,50,16,16,16,16,12,12,12,12,12,12,12,12,34,34,34,34,14,14,14,14,19,19,19,19,23,23,23,23,25,25,25,25,26,26,26,26,16,16,16,16,28,28,28,28,29,29,29,29,null,null,null,null,36,36,36,36,23,23,23,23,27,27,27,27,38,38,38,38,12,12,12,12,16,16,16,16,32,32,32,32,15,15,15,15,37,37,37,37,20,20,20,20,45,45,45,45,13,13,13,13,38,38,38,38,45,45,45,45,47,47,47,47,36,36,36,36,16,16,16,16,27,27,27,27,33,33,33,33,36,36,36,36,29,29,29,29,47,47,47,47,34,34,34,34,27,27,27,27,25,25,25,25,33,33,33,33,58,58,58,58,43,43,43,43,37,37,37,37,23,23,23,23,12,12,12,12,32,32,32,32,13,13,13,13,41,41,41,41,58,58,58,58,55,55,55,55,21,21,21,21,20,20,20,20,34,34,34,34,13,13,13,13,27,27,27,27,34,34,34,34,15,15,15,15,32,32,32,32,46,46,46,46,16,16,16,16,30,30,30,30,45,45,45,45,17,17,17,17,46,46,46,46,26,26,26,26,29,29,29,29,10,10,10,10,25,25,25,25,32,32,32,32,48,48,48,48,32,32,32,32,45,45,45,45,47,47,47,47,27,27,27,27,43,43,43,43,24,24,24,24,12,12,12,12,12,12,12,12,22,22,22,22,35,35,35,35,31,31,31,31,24,24,24,24,36,36,36,36,16,16,16,16,27,27,27,27,32,32,32,32,12,12,12,12,40,40,40,40,null,null,null,null,39,39,39,39,36,36,36,36,16,16,16,16,40,40,40,40,17,17,17,17,42,42,42,42,24,24,24,24,5,5,5,5,17,17,17,17,38,38,38,38,53,53,53,53,32,32,32,32,39,39,39,39,12,12,12,12,22,22,22,22,48,48,48,48,35,35,35,35,53,53,53,53,15,15,15,15,29,29,29,29,24,24,24,24,39,39,39,39,60,60,60,60,31,31,31,31,20,20,20,20,55,55,55,55,20,20,20,20,33,33,33,33,32,32,32,32,39,39,39,39,44,44,44,44,15,15,15,15,41,41,41,41,12,12,12,12,22,22,22,22,37,37,37,37,4,4,4,4,12,12,12,12,36,36,36,36,25,25,25,25,14,14,14,14,24,24,24,24,19,19,19,19,49,49,49,49,22,22,22,22,26,26,26,26,17,17,17,17,28,28,28,28,23,23,23,23,13,13,13,13,26,26,26,26,36,36,36,36,22,22,22,22,37,37,37,37,15,15,15,15,24,24,24,24,20,20,20,20,29,29,29,29,29,29,29,29,21,21,21,21,12,12,12,12,12,12,12,12,23,23,23,23,28,28,28,28,15,15,15,15,34,34,34,34,27,27,27,27,43,43,43,43,15,15,15,15,34,34,34,34,18,18,18,18,47,47,47,47,11,11,11,11,50,50,50,50,17,17,17,17,14,14,14,14,29,29,29,29,21,21,21,21,14,14,14,14,21,21,21,21,13,13,13,13,33,33,33,33,12,12,12,12,13,13,13,13,42,42,42,42,21,21,21,21,24,24,24,24,16,16,16,16,12,12,12,12,31,31,31,31,48,48,48,48,35,35,35,35,47,47,47,47,23,23,23,23,33,33,33,33,20,20,20,20,31,31,31,31,36,36,36,36,19,19,19,19,30,30,30,30,12,12,12,12,20,20,20,20,23,23,23,23,34,34,34,34,41,41,41,41,23,23,23,23,44,44,44,44,24,24,24,24,48,48,48,48,17,17,17,17,15,15,15,15,36,36,36,36,22,22,22,22,12,12,12,12,27,27,27,27,13,13,13,13,20,20,20,20,43,43,43,43,28,28,28,28,31,31,31,31,36,36,36,36,16,16,16,16,43,43,43,43,34,34,34,34,12,12,12,12,12,12,12,12,26,26,26,26,24,24,24,24,20,20,20,20,17,17,17,17,28,28,28,28,21,21,21,21,15,15,15,15,42,42,42,42,21,21,21,21,56,56,56,56,43,43,43,43,36,36,36,36,36,36,36,36,50,50,50,50,32,32,32,32,33,33,33,33,51,51,51,51,32,32,32,32,22,22,22,22,14,14,14,14,25,25,25,25,56,56,56,56,12,12,12,12,59,59,59,59,48,48,48,48,14,14,14,14,29,29,29,29,25,25,25,25,32,32,32,32,32,32,32,32,51,51,51,51,30,30,30,30,19,19,19,19,12,12,12,12,16,16,16,16,48,48,48,48,24,24,24,24,18,18,18,18,27,27,27,27,36,36,36,36,21,21,21,21,33,33,33,33,48,48,48,48,33,33,33,33,24,24,24,24,39,39,39,39,27,27,27,27,12,12,12,12,22,22,22,22,12,12,12,12,42,42,42,42,27,27,27,27,23,23,23,23,60,60,60,60,31,31,31,31,46,46,46,46,20,20,20,20,29,29,29,29,12,12,12,12,28,28,28,28,5,5,5,5,34,34,34,34,24,24,24,24,19,19,19,19,15,15,15,15,33,33,33,33,26,26,26,26,30,30,30,30,38,38,38,38,44,44,44,44,50,50,50,50,26,26,26,26,59,59,59,59,35,35,35,35,18,18,18,18,27,27,27,27,16,16,16,16,31,31,31,31,57,57,57,57,27,27,27,27,31,31,31,31,40,40,40,40,12,12,12,12,19,19,19,19,39,39,39,39,51,51,51,51,43,43,43,43,24,24,24,24,18,18,18,18,32,32,32,32,26,26,26,26,37,37,37,37,14,14,14,14,20,20,20,20,12,12,12,12,31,31,31,31,20,20,20,20,35,35,35,35,30,30,30,30,28,28,28,28,37,37,37,37,32,32,32,32,15,15,15,15,12,12,12,12,36,36,36,36,12,12,12,12,12,12,12,12,56,56,56,56,28,28,28,28,12,12,12,12,14,14,14,14,21,21,21,21,16,16,16,16,31,31,31,31,42,42,42,42,17,17,17,17,32,32,32,32,28,28,28,28,26,26,26,26,26,26,26,26,17,17,17,17,33,33,33,33,36,36,36,36,20,20,20,20,39,39,39,39,17,17,17,17,42,42,42,42,38,38,38,38,18,18,18,18,28,28,28,28,16,16,16,16,38,38,38,38,36,36,36,36,13,13,13,13,34,34,34,34,28,28,28,28,15,15,15,15,19,19,19,19,14,14,14,14,16,16,16,16,60,60,60,60,49,49,49,49,23,23,23,23,36,36,36,36,44,44,44,44,57,57,57,57,43,43,43,43,20,20,20,20,35,35,35,35,23,23,23,23,24,24,24,24,46,46,46,46,33,33,33,33,24,24,24,24,16,16,16,16,35,35,35,35,23,23,23,23,37,37,37,37,42,42,42,42,12,12,12,12,50,50,50,50,13,13,13,13,5,5,5,5,43,43,43,43,28,28,28,28,18,18,18,18,31,31,31,31,20,20,20,20,40,40,40,40,33,33,33,33,37,37,37,37,34,34,34,34,23,23,23,23,26,26,26,26,29,29,29,29,19,19,19,19,19,19,19,19,31,31,31,31,51,51,51,51,17,17,17,17,45,45,45,45,43,43,43,43,48,48,48,48,29,29,29,29,13,13,13,13,27,27,27,27,16,16,16,16,25,25,25,25,27,27,27,27,49,49,49,49,22,22,22,22,29,29,29,29,39,39,39,39,19,19,19,19,23,23,23,23,19,19,19,19,19,19,19,19,16,16,16,16,21,21,21,21,14,14,14,14,12,12,12,12,59,59,59,59,25,25,25,25,23,23,23,23,25,25,25,25,18,18,18,18,24,24,24,24,16,16,16,16,32,32,32,32,27,27,27,27,14,14,14,14,21,21,21,21,21,21,21,21,47,47,47,47,27,27,27,27,19,19,19,19,41,41,41,41,13,13,13,13,33,33,33,33,13,13,13,13,27,27,27,27,44,44,44,44,25,25,25,25,21,21,21,21,37,37,37,37,32,32,32,32,31,31,31,31,17,17,17,17,30,30,30,30,16,16,16,16,12,12,12,12,22,22,22,22,23,23,23,23,35,35,35,35,28,28,28,28,31,31,31,31,21,21,21,21,32,32,32,32,40,40,40,40,26,26,26,26,43,43,43,43,30,30,30,30,28,28,28,28,52,52,52,52,19,19,19,19,24,24,24,24,25,25,25,25,32,32,32,32,16,16,16,16,34,34,34,34,31,31,31,31,26,26,26,26,34,34,34,34,27,27,27,27,26,26,26,26,33,33,33,33,26,26,26,26,12,12,12,12,17,17,17,17,15,15,15,15,14,14,14,14,37,37,37,37,46,46,46,46,27,27,27,27,12,12,12,12,38,38,38,38,23,23,23,23,25,25,25,25,24,24,24,24,30,30,30,30,33,33,33,33,15,15,15,15,17,17,17,17,44,44,44,44,23,23,23,23,23,23,23,23,28,28,28,28,15,15,15,15,19,19,19,19,20,20,20,20,51,51,51,51,38,38,38,38,41,41,41,41,14,14,14,14,17,17,17,17,48,48,48,48,23,23,23,23,27,27,27,27,39,39,39,39,22,22,22,22,17,17,17,17,35,35,35,35,28,28,28,28,32,32,32,32,32,32,32,32,37,37,37,37,16,16,16,16,45,45,45,45,23,23,23,23,24,24,24,24,40,40,40,40,20,20,20,20,25,25,25,25,27,27,27,27,33,33,33,33,39,39,39,39,37,37,37,37,47,47,47,47,15,15,15,15,15,15,15,15,28,28,28,28,31,31,31,31,45,45,45,45,25,25,25,25,26,26,26,26,20,20,20,20,48,48,48,48,45,45,45,45,40,40,40,40,26,26,26,26,24,24,24,24,34,34,34,34,18,18,18,18,48,48,48,48,38,38,38,38,23,23,23,23,29,29,29,29,20,20,20,20,12,12,12,12,18,18,18,18,39,39,39,39,23,23,23,23,40,40,40,40,41,41,41,41,31,31,31,31,18,18,18,18,46,46,46,46,53,53,53,53,30,30,30,30,24,24,24,24,27,27,27,27,45,45,45,45,31,31,31,31,17,17,17,17,36,36,36,36,12,12,12,12,25,25,25,25,16,16,16,16,29,29,29,29,47,47,47,47,44,44,44,44,21,21,21,21,23,23,23,23,26,26,26,26,23,23,23,23,43,43,43,43,45,45,45,45,12,12,12,12,12,12,12,12,20,20,20,20,null,null,null,null,42,42,42,42,28,28,28,28,37,37,37,37,35,35,35,35,32,32,32,32,30,30,30,30,42,42,42,42,36,36,36,36,24,24,24,24,53,53,53,53,21,21,21,21,56,56,56,56,29,29,29,29,12,12,12,12,29,29,29,29,21,21,21,21,32,32,32,32,16,16,16,16,36,36,36,36,26,26,26,26,21,21,21,21,18,18,18,18,34,34,34,34,25,25,25,25,31,31,31,31,17,17,17,17,31,31,31,31,47,47,47,47,14,14,14,14,21,21,21,21,36,36,36,36,57,57,57,57,27,27,27,27,16,16,16,16,37,37,37,37,43,43,43,43,28,28,28,28,52,52,52,52,38,38,38,38,20,20,20,20,48,48,48,48,16,16,16,16,13,13,13,13,24,24,24,24,28,28,28,28,24,24,24,24,25,25,25,25,29,29,29,29,43,43,43,43,49,49,49,49,36,36,36,36,35,35,35,35,32,32,32,32,32,32,32,32,18,18,18,18,19,19,19,19,5,5,5,5,35,35,35,35,18,18,18,18,28,28,28,28,24,24,24,24,23,23,23,23,17,17,17,17,26,26,26,26,29,29,29,29,13,13,13,13,25,25,25,25,28,28,28,28,24,24,24,24,13,13,13,13,33,33,33,33,48,48,48,48,26,26,26,26,33,33,33,33,17,17,17,17,26,26,26,26,32,32,32,32,14,14,14,14,38,38,38,38,19,19,19,19,38,38,38,38,35,35,35,35,26,26,26,26,53,53,53,53,56,56,56,56,36,36,36,36,30,30,30,30,18,18,18,18,31,31,31,31,15,15,15,15,20,20,20,20,20,20,20,20,45,45,45,45,28,28,28,28,40,40,40,40,34,34,34,34,36,36,36,36,37,37,37,37,16,16,16,16,50,50,50,50,31,31,31,31,50,50,50,50,42,42,42,42,51,51,51,51,34,34,34,34,37,37,37,37,60,60,60,60,46,46,46,46,37,37,37,37,17,17,17,17,39,39,39,39,52,52,52,52,30,30,30,30,24,24,24,24,18,18,18,18,25,25,25,25,18,18,18,18,16,16,16,16,17,17,17,17,48,48,48,48,41,41,41,41,22,22,22,22,17,17,17,17,50,50,50,50,33,33,33,33,12,12,12,12,44,44,44,44,30,30,30,30,28,28,28,28,12,12,12,12,28,28,28,28,15,15,15,15,20,20,20,20,20,20,20,20,12,12,12,12,31,31,31,31,20,20,20,20,28,28,28,28,14,14,14,14,24,24,24,24,27,27,27,27,39,39,39,39,34,34,34,34,37,37,37,37,17,17,17,17,16,16,16,16,35,35,35,35,40,40,40,40,30,30,30,30,29,29,29,29,31,31,31,31,15,15,15,15,33,33,33,33,28,28,28,28,30,30,30,30,26,26,26,26,46,46,46,46,35,35,35,35,42,42,42,42,54,54,54,54,18,18,18,18,35,35,35,35,33,33,33,33,18,18,18,18,36,36,36,36,46,46,46,46,13,13,13,13,23,23,23,23,26,26,26,26,51,51,51,51,54,54,54,54,14,14,14,14,36,36,36,36,24,24,24,24,16,16,16,16,23,23,23,23,34,34,34,34,42,42,42,42,16,16,16,16,21,21,21,21,21,21,21,21,19,19,19,19,20,20,20,20,37,37,37,37,12,12,12,12,55,55,55,55,52,52,52,52,56,56,56,56,32,32,32,32,32,32,32,32,29,29,29,29,27,27,27,27,29,29,29,29,30,30,30,30,39,39,39,39,25,25,25,25,33,33,33,33,18,18,18,18,12,12,12,12,18,18,18,18,34,34,34,34,24,24,24,24,16,16,16,16,28,28,28,28,27,27,27,27,36,36,36,36,16,16,16,16,43,43,43,43,30,30,30,30,15,15,15,15,36,36,36,36,24,24,24,24],[1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4,1,2,3,4],[1,1,1,1,1,1,1,1,3,3,3,3,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,3,1,1,1,1,2,1,1,3,1,1,1,1,1,2,1,1,2,2,1,3,1,1,1,1,2,1,1,2,1,1,1,1,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,2,2,1,1,3,3,3,3,1,2,1,2,1,1,1,1,2,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,2,1,2,1,1,1,1,1,1,1,1,2,2,3,3,1,1,1,2,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,3,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,2,2,3,3,1,1,2,2,1,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,2,2,3,1,1,1,1,2,2,1,2,1,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,2,2,2,2,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,2,1,2,3,3,3,3,2,3,3,3,2,2,1,1,2,2,2,2,1,1,2,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,2,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,3,2,2,1,2,1,2,3,3,1,2,2,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,3,2,2,2,2,2,2,2,2,2,1,2,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,2,2,2,2,2,1,2,2,2,1,1,1,2,1,1,2,2,1,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,2,1,2,2,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,2,1,1,2,2,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,2,2,2,3,1,1,1,2,1,2,1,2,2,2,1,2,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,3,3,3,3,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,2,1,2,1,1,1,1,1,1,1,1,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,2,1,3,2,2,1,2,1,1,1,3,1,1,1,2,1,2,1,1,2,1,2,3,1,1,1,2,1,1,1,1,2,2,3,3,1,1,1,1,1,1,1,2,2,1,1,2,2,1,1,1,3,3,3,3,1,1,2,1,2,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,2,2,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,2,1,1,2,1,1,2,2,3,3,2,1,1,2,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,3,2,1,1,2,1,1,1,2,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,2,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,1,1,2,2,3,3,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,2,1,1,1,1,2,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,2,1,1,1,1,1,1,1,1,1,3,3,3,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,2,1,3,1,1,1,1,1,1,1,1,1,2,1,1,1,2,1,1,2,2,2,2,1,1,3,3,2,2,1,1,2,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,2,3,3,3,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,2,2,2,2,3,1,1,1,1,1,1,1,1,1,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,3,3,1,1,1,1,2,2,2,2,1,1,1,2,1,1,1,1,2,1,1,2,1,1,1,1,2,1,1,1,1,2,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,1,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,2,2,2,2,1,2,1,1,2,3,3,3,1,1,1,1,2,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,3,3,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,1,2,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,2,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,2,3,3,3,3,2,1,1,1,1,1,1,2,2,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,2,1,1,2,1,1,1,1,1,1,1,1,1,1,1,3,2,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,2,2,2,2,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,2,2,2,1,1,1,1,2,2,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,2,2,1,1,1,2,1,2,1,1,1,1,1,2,1,1,1,1,1,1,1,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,1,1,1,1,1,1,1,1,1,2,1,2,2,2,1,2,1,1,1,1,1,1,1,2,2,1,2,2,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,3,3,3,2,2,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,1,1,1,1,1,1,1,1,1,1,1,2,2,2,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,1,2,2,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,2,2,2,1,1,1,1,2,1,1,2,1,1,1,2,2,2,1,2,3,3,3,3,1,1,1,1,2,2,3,3,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,2,1,2,1,3,1,1,1,1,1,1,1,1,1,1,1,1,2,2,3,3,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,1,1,1,1,1,2,1,2,1,2,2,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,1,2,1,2,1,2,3,3,3,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,2,2,2,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,2,1,1,1,2,2,1,1,1,1,1,1,2,3,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,1,1,2,1,1,2,2,1,1,1,1,1,1,1,1,1,2,1,1,2,2,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,2,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,2,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,2,1,1,2,1,2,2,2,1,1,1,3,3,3,3,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,2,2,1,1,1,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>ID<\/th>\n      <th>Gender<\/th>\n      <th>Age<\/th>\n      <th>Education_tri<\/th>\n      <th>Cardio_risk<\/th>\n      <th>Depression<\/th>\n      <th>Total_p<\/th>\n      <th>Wave<\/th>\n      <th>Status<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":6,"autoWidth":true,"columnDefs":[{"className":"dt-right","targets":[1,3,5,6,7,8,9]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"ID","targets":1},{"name":"Gender","targets":2},{"name":"Age","targets":3},{"name":"Education_tri","targets":4},{"name":"Cardio_risk","targets":5},{"name":"Depression","targets":6},{"name":"Total_p","targets":7},{"name":"Wave","targets":8},{"name":"Status","targets":9}],"order":[],"orderClasses":false,"orderCellsTop":true,"lengthMenu":[6,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>Letâ€™s look at a state table to visualize the amount of transitions over time</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>markov_data <span class="sc">|&gt;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(ID, Wave, Status) <span class="sc">|&gt;</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Status =</span> <span class="fu">case_when</span>(</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    Status <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Normal Cognition"</span>, </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    Status <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"MCI"</span>, </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    Status <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"Dementia"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  msm<span class="sc">::</span><span class="fu">statetable.msm</span>(<span class="at">state =</span> Status, <span class="at">subject =</span> ID)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  to
from               Dementia  MCI Normal Cognition
  Dementia               79    0                0
  MCI                    31  128              180
  Normal Cognition       19  215             2000</code></pre>
</div>
</div>
</section>
<section id="modelling" class="level3">
<h3 class="anchored" data-anchor-id="modelling">Modelling</h3>
<section id="defining-a-q-matrix" class="level4">
<h4 class="anchored" data-anchor-id="defining-a-q-matrix">Defining a q-matrix</h4>
<p>The Q matrix (also known as the transition intensity matrix or generator matrix) defines the rates at which transitions occur between states in the model.</p>
<p>It is a square matrix where:</p>
<ul>
<li>Each row corresponds to a <strong>from</strong> state in the model.</li>
<li>Each column corresponds to a <strong>to</strong> state in the model.</li>
<li>The off-diagonal elements <span class="math inline">q_{ij}</span> represent the transition rate from state <span class="math inline">i</span> to state <span class="math inline">j</span>.</li>
</ul>
<p>For a model with <span class="math inline">n</span> states, the Q matrix has the following structure</p>
<p><span class="math display">
Q = \begin{bmatrix}
q_{11} &amp; q_{12} &amp; \cdots &amp; q_{1n} \\
q_{21} &amp; q_{22} &amp; \cdots &amp; q_{2n} \\
\vdots &amp; \vdots &amp; \ddots &amp;\vdots  \\
q_{n1} &amp; q_{n2} &amp; \cdots &amp; q_{nn}
\end{bmatrix}
</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating transition matrix</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Define possible transitions</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>states <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Normal Cognition"</span>, <span class="st">"MCI"</span>, <span class="st">"Dementia"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Theoretical transition probabilities</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>q_matrix <span class="ot">&lt;-</span> <span class="fu">rbind</span>(</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fl">0.75</span>, <span class="fl">0.20</span>, <span class="fl">0.05</span>),  <span class="co"># From Normal, can transition to MCI or Dementia</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.50</span>, <span class="fl">0.25</span>),  <span class="co"># From MCI, can transition to Normal or Dementia</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="fl">0.00</span>, <span class="fl">0.00</span>, <span class="fl">1.00</span>)         <span class="co"># From Dementia, no transitions (absorbing state)</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(q_matrix) <span class="ot">&lt;-</span> states</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(q_matrix) <span class="ot">&lt;-</span> states</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>q_matrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 Normal Cognition MCI Dementia
Normal Cognition             0.75 0.2     0.05
MCI                          0.25 0.5     0.25
Dementia                     0.00 0.0     1.00</code></pre>
</div>
</div>
</section>
</section>
<section id="fitting" class="level3">
<h3 class="anchored" data-anchor-id="fitting">Fitting</h3>
<p>We will fit three different multi-state models</p>
<ol type="1">
<li>A model with no covariates</li>
<li>A multivariate model with covariates acting on all transitions</li>
<li>A multivariate model with covariates (and interactions) acting on all transitions</li>
<li>A multivariate model with covariates acting on only NC &lt;-&gt; MCI &amp; MCI - Dementia</li>
<li>A multivariate model with covariates (and interactions) acting on only NC &lt;-&gt; MCI &amp; MCI - Dementia</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fitting model with no covariates</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>model_1 <span class="ot">&lt;-</span> msm<span class="sc">::</span><span class="fu">msm</span>(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> Status <span class="sc">~</span> Wave,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">subject =</span> ID,</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> markov_data,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">qmatrix =</span> q_matrix,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">obstype =</span> <span class="dv">1</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"BFGS"</span>, </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">gen.inits =</span> <span class="cn">TRUE</span>,</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">fnscale =</span> <span class="dv">5000</span>, </span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxit =</span> <span class="dv">2000</span> <span class="co"># To reach convergence</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Multivariate model: covariates acting on all transitions</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>model_2 <span class="ot">&lt;-</span> msm<span class="sc">::</span><span class="fu">msm</span>(</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> Status <span class="sc">~</span> Wave,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">subject =</span> ID,</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> markov_data,</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">qmatrix =</span> q_matrix,</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">covariates =</span> <span class="sc">~</span> Gender <span class="sc">+</span> Age <span class="sc">+</span> Education_tri <span class="sc">+</span> Cardio_risk <span class="sc">+</span> Depression <span class="sc">+</span> Total_p,</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">obstype =</span> <span class="dv">1</span>,</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">gen.inits =</span> <span class="cn">TRUE</span>,</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"BFGS"</span>,</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">fnscale =</span> <span class="dv">6000</span>, </span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxit =</span> <span class="dv">2000</span> <span class="co"># To reach convergence</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Multivariate model: covariates acting on all transitions (with interaction)</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>model_3 <span class="ot">&lt;-</span> msm<span class="sc">::</span><span class="fu">msm</span>(</span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> Status <span class="sc">~</span> Wave,</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">subject =</span> ID,</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> markov_data,</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">qmatrix =</span> q_matrix,</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">covariates =</span> <span class="sc">~</span> Gender <span class="sc">+</span> Age <span class="sc">+</span> Education_tri <span class="sc">+</span> Cardio_risk <span class="sc">+</span> (Depression <span class="sc">*</span> Total_p),</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">obstype =</span> <span class="dv">1</span>,</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">gen.inits =</span> <span class="cn">TRUE</span>,</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"BFGS"</span>,</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">fnscale =</span> <span class="dv">5000</span>, </span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxit =</span> <span class="dv">2000</span> <span class="co"># To reach convergence</span></span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Multivariate model: covariates acting on NC &lt;-&gt; MCI and MCI -&gt; D</span></span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>model_4 <span class="ot">&lt;-</span> msm<span class="sc">::</span><span class="fu">msm</span>(</span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> Status <span class="sc">~</span> Wave,</span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>  <span class="at">subject =</span> ID,</span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> markov_data,</span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>  <span class="at">qmatrix =</span> q_matrix,</span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a>  <span class="at">covariates =</span> <span class="fu">list</span>(</span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>    <span class="st">"1-2"</span> <span class="ot">=</span> <span class="er">~</span> Gender <span class="sc">+</span> Age <span class="sc">+</span> Education_tri <span class="sc">+</span> Cardio_risk <span class="sc">+</span> Depression <span class="sc">+</span> Total_p,</span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2-1"</span> <span class="ot">=</span> <span class="er">~</span> Gender <span class="sc">+</span> Age <span class="sc">+</span> Education_tri <span class="sc">+</span> Cardio_risk <span class="sc">+</span> Depression <span class="sc">+</span> Total_p,</span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2-3"</span> <span class="ot">=</span> <span class="er">~</span> Gender <span class="sc">+</span> Age <span class="sc">+</span> Education_tri <span class="sc">+</span> Cardio_risk <span class="sc">+</span> Depression <span class="sc">+</span> Total_p</span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>  <span class="at">obstype =</span> <span class="dv">1</span>,</span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">gen.inits =</span> <span class="cn">TRUE</span>,</span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"BFGS"</span>,</span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(</span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">fnscale =</span> <span class="dv">5000</span>, </span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxit =</span> <span class="dv">2000</span> <span class="co"># To reach convergence</span></span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Multivariate model: covariates acting on NC &lt;-&gt; MCI and MCI -&gt; D (with interaction)</span></span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a>model_5 <span class="ot">&lt;-</span> msm<span class="sc">::</span><span class="fu">msm</span>(</span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a>  <span class="at">formula =</span> Status <span class="sc">~</span> Wave,</span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a>  <span class="at">subject =</span> ID,</span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> markov_data,</span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a>  <span class="at">qmatrix =</span> q_matrix,</span>
<span id="cb15-71"><a href="#cb15-71" aria-hidden="true" tabindex="-1"></a>  <span class="at">covariates =</span> <span class="fu">list</span>(</span>
<span id="cb15-72"><a href="#cb15-72" aria-hidden="true" tabindex="-1"></a>    <span class="st">"1-2"</span> <span class="ot">=</span> <span class="er">~</span> Gender <span class="sc">+</span> Age <span class="sc">+</span> Education_tri <span class="sc">+</span> Cardio_risk <span class="sc">+</span> (Depression <span class="sc">*</span> Total_p),</span>
<span id="cb15-73"><a href="#cb15-73" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2-1"</span> <span class="ot">=</span> <span class="er">~</span> Gender <span class="sc">+</span> Age <span class="sc">+</span> Education_tri <span class="sc">+</span> Cardio_risk <span class="sc">+</span> (Depression <span class="sc">*</span> Total_p),</span>
<span id="cb15-74"><a href="#cb15-74" aria-hidden="true" tabindex="-1"></a>    <span class="st">"2-3"</span> <span class="ot">=</span> <span class="er">~</span> Gender <span class="sc">+</span> Age <span class="sc">+</span> Education_tri <span class="sc">+</span> Cardio_risk <span class="sc">+</span> (Depression <span class="sc">*</span> Total_p)</span>
<span id="cb15-75"><a href="#cb15-75" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb15-76"><a href="#cb15-76" aria-hidden="true" tabindex="-1"></a>  <span class="at">obstype =</span> <span class="dv">1</span>,</span>
<span id="cb15-77"><a href="#cb15-77" aria-hidden="true" tabindex="-1"></a>  <span class="at">gen.inits =</span> <span class="cn">TRUE</span>,</span>
<span id="cb15-78"><a href="#cb15-78" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"BFGS"</span>,</span>
<span id="cb15-79"><a href="#cb15-79" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">list</span>(</span>
<span id="cb15-80"><a href="#cb15-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">fnscale =</span> <span class="dv">5000</span>, </span>
<span id="cb15-81"><a href="#cb15-81" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxit =</span> <span class="dv">2000</span> <span class="co"># To reach convergence</span></span>
<span id="cb15-82"><a href="#cb15-82" aria-hidden="true" tabindex="-1"></a>  ))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="model-checking" class="level4">
<h4 class="anchored" data-anchor-id="model-checking">Model Checking</h4>
<p>After fitting each of our models we can extract some goodness of fit criteria</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>log_l <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">logLik</span>(model_1), </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>           <span class="fu">logLik</span>(model_2), </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>           <span class="fu">logLik</span>(model_3), </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>           <span class="fu">logLik</span>(model_4), </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>           <span class="fu">logLik</span>(model_5))</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>aic <span class="ot">&lt;-</span> <span class="fu">AIC</span>(model_1, model_2, model_3, model_4, model_5)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Very small difference between model 2 and 3 (makes sense)</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(log_l, aic) <span class="sc">|&gt;</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>(<span class="st">"Model"</span>) <span class="sc">|&gt;</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Model =</span> stringr<span class="sc">::</span><span class="fu">str_remove</span>(Model, <span class="st">"model_"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Model     log_l df      AIC
1     1 -1128.003  4 2264.007
2     2 -1006.632 32 2077.265
3     3 -1000.512 36 2073.024
4     4 -1008.524 25 2067.048
5     5 -1002.455 28 2060.910</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Likelihood ratio test</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>lmtest<span class="sc">::</span><span class="fu">lrtest</span>(model_1, model_2, model_3, model_4, model_5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Likelihood ratio test

Model 1: Status ~ Wave
Model 2: Status ~ Wave
Model 3: Status ~ Wave
Model 4: Status ~ Wave
Model 5: Status ~ Wave
  #Df  LogLik  Df   Chisq Pr(&gt;Chisq)    
1   4 -1128.0                           
2  32 -1006.6  28 242.742  &lt; 2.2e-16 ***
3  36 -1000.5   4  12.241   0.015647 *  
4  25 -1008.5 -11  16.025   0.140218    
5  28 -1002.5   3  12.138   0.006925 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>We can also look at a measure of how well the model fits the data using a test proposed by <span class="citation" data-cites="gentleman1994">[@gentleman1994]</span>. The function plots the observed numbers of individuals occupying a state at a series of times against forecasts from the fitted model, for each state (<a href="#fig-gentleman" class="quarto-xref">Figure&nbsp;2</a>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting fitted vs. observed values</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">gentleman_test</span>(<span class="at">data =</span> msm<span class="sc">::</span><span class="fu">prevalence.msm</span>(model_1), </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">model =</span> <span class="st">"Model 1"</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">gentleman_test</span>(<span class="at">data =</span> msm<span class="sc">::</span><span class="fu">prevalence.msm</span>(model_2), </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">model =</span> <span class="st">"Model 2"</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>g3 <span class="ot">&lt;-</span> <span class="fu">gentleman_test</span>(<span class="at">data =</span> msm<span class="sc">::</span><span class="fu">prevalence.msm</span>(model_3), </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">model =</span> <span class="st">"Model 3"</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>g4 <span class="ot">&lt;-</span> <span class="fu">gentleman_test</span>(<span class="at">data =</span> msm<span class="sc">::</span><span class="fu">prevalence.msm</span>(model_4), </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">model =</span> <span class="st">"Model 4"</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>g5 <span class="ot">&lt;-</span> <span class="fu">gentleman_test</span>(<span class="at">data =</span> msm<span class="sc">::</span><span class="fu">prevalence.msm</span>(model_5), </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>                     <span class="at">model =</span> <span class="st">"Model 5"</span>)</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>ggpubr<span class="sc">::</span><span class="fu">ggarrange</span>(g1, g2, g3, g4, g5, </span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">common.legend =</span> <span class="cn">TRUE</span>, </span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">nrow =</span> <span class="dv">5</span>,</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">heights =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>), </span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>                  <span class="at">legend =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-gentleman" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-gentleman-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="continous-markov_files/figure-html/fig-gentleman-1.png" class="img-fluid figure-img" width="1152">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-gentleman-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Fitted values versus observed values
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="hazard-ratios" class="level4">
<h4 class="anchored" data-anchor-id="hazard-ratios">Hazard ratios</h4>
<p>We now present hazard ratios for each of our fitted models. These ratios represent how the instantaneous risk of making a particular transition is modified by the covariate.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Model 2</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Model 3</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">Model 4</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">Model 5</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p><a href="#fig-hazard-ratio-1" class="quarto-xref">Figure&nbsp;3</a> presents hazard ratios from model 2 (our multivariate model with covariates acting on all transitions) for each covariate.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting hazard ratios</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>model_2 <span class="sc">|&gt;</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  msm<span class="sc">::</span><span class="fu">hazard.msm</span>() <span class="sc">|&gt;</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">process_hr</span>() <span class="sc">|&gt;</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate_p_value</span>() <span class="sc">|&gt;</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_hr</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-hazard-ratio-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hazard-ratio-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="continous-markov_files/figure-html/fig-hazard-ratio-1-1.png" class="img-fluid figure-img" width="1152">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hazard-ratio-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Ouputted hazard ratios from Markov model. Green bars represent a decreased risk of transition while red bars indicate an increased risk of transition.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p><a href="#fig-hazard-ratio-2" class="quarto-xref">Figure&nbsp;4</a> presents hazard ratios from model 3 (our multivariate model with covariates <strong>(and interactions)</strong> acting on all transitions) for each covariate.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting hazard ratios</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>model_3 <span class="sc">|&gt;</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  msm<span class="sc">::</span><span class="fu">hazard.msm</span>() <span class="sc">|&gt;</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">process_hr</span>() <span class="sc">|&gt;</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate_p_value</span>() <span class="sc">|&gt;</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_hr</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-hazard-ratio-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hazard-ratio-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="continous-markov_files/figure-html/fig-hazard-ratio-2-1.png" class="img-fluid figure-img" width="1152">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hazard-ratio-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Ouputted hazard ratios from Markov model. Green bars represent a decreased risk of transition while red bars indicate an increased risk of transition.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p><a href="#fig-hazard-ratio-3" class="quarto-xref">Figure&nbsp;5</a> presents hazard ratios for model 4 (our multivariate model with covariates acting on only NC &lt;-&gt; MCI &amp; MCI -&gt; Dementia) for each covariate</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting hazard ratios</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>model_4 <span class="sc">|&gt;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  msm<span class="sc">::</span><span class="fu">hazard.msm</span>() <span class="sc">|&gt;</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">process_hr</span>() <span class="sc">|&gt;</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate_p_value</span>() <span class="sc">|&gt;</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_hr</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-hazard-ratio-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hazard-ratio-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="continous-markov_files/figure-html/fig-hazard-ratio-3-1.png" class="img-fluid figure-img" width="1152">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hazard-ratio-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Ouputted hazard ratios from Markov model. Green bars represent a decreased risk of transition while red bars indicate an increased risk of transition.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<p><a href="#fig-hazard-ratio-4" class="quarto-xref">Figure&nbsp;6</a> presents hazard ratios for model 5 (our multivariate model with covariates <strong>(and interactions)</strong> acting on only NC &lt;-&gt; MCI &amp; MCI -&gt; Dementia) for each covariate</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting hazard ratios</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>model_5 <span class="sc">|&gt;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  msm<span class="sc">::</span><span class="fu">hazard.msm</span>() <span class="sc">|&gt;</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">process_hr</span>() <span class="sc">|&gt;</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate_p_value</span>() <span class="sc">|&gt;</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_hr</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-hazard-ratio-4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-hazard-ratio-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="continous-markov_files/figure-html/fig-hazard-ratio-4-1.png" class="img-fluid figure-img" width="1152">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-hazard-ratio-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Ouputted hazard ratios from Markov model. Green bars represent a decreased risk of transition while red bars indicate an increased risk of transition.
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>


<!-- -->

</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../analysis/hypothesis.html" class="pagination-link" aria-label="Hypotheses">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Hypotheses</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../analysis/discrete-markov.html" class="pagination-link" aria-label="Discrete Time Markov Model">
        <span class="nav-page-text">Discrete Time Markov Model</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb25" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Continous Time Markov Model"</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> html</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="fu"># Setting up</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="fu">## Loading packages</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="in">```{r packages}</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-summary: "Check our my packages"</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="in">#| message: false</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="in">library(dplyr)</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyr)</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggplot2)</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="fu">## Loading functions</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="in">```{r functions}</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: true</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-summary: "Check our my functions"</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a><span class="in">extract_years &lt;- function(data, years, impute = TRUE, cog_total = FALSE, absorbing = TRUE) {</span></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a><span class="in">  # Extracts cognitive function data for specified years from a dataset.</span></span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a><span class="in">  # Converts numeric cognitive status codes (1, 2, 3) into descriptive labels</span></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a><span class="in">  # ("Normal Cognition", "MCI", "Dementia") for easier interpretation.</span></span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a><span class="in">  # Arguments:</span></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - data: The input dataset containing cognitive function data.</span></span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - years: A vector of years for which data should be extracted.</span></span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a><span class="in">  # Returns:</span></span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - A dataset with ID and cognitive status columns for the specified years.</span></span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a><span class="in">  # Create dynamic column names based on the years provided</span></span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a><span class="in">  cogfunction_cols &lt;- paste0("cogfunction", years)</span></span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a><span class="in">  cogtotal_cols    &lt;- paste0("cogtot27_imp", years)</span></span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a><span class="in">  if(cog_total == FALSE) {</span></span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a><span class="in">  data &lt;- data |&gt;</span></span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a><span class="in">    # Select only the ID column and cognitive function columns for the specified years</span></span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a><span class="in">    select(ID, any_of(cogfunction_cols)) |&gt;</span></span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(across(!c(ID), ~ case_when(</span></span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a><span class="in">      .x == 1 ~ "Normal Cognition",</span></span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a><span class="in">      .x == 2 ~ "MCI",</span></span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a><span class="in">      .x == 3 ~ "Dementia",</span></span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a><span class="in">      TRUE ~ NA_character_  # To handle missing/other cases</span></span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a><span class="in">    )))</span></span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a><span class="in">  } else {</span></span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a><span class="in">    data &lt;- data |&gt;</span></span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a><span class="in">      # Select only the ID column and cognitive function columns for the specified years</span></span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a><span class="in">      select(ID, any_of(cogtotal_cols)) |&gt;</span></span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a><span class="in">      rename_with( .cols = !ID, .fn = ~ stringr::str_replace(</span></span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a><span class="in">        string = .x,</span></span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a><span class="in">        pattern = "cogtot27_imp", </span></span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a><span class="in">        replacement = "cog_score_"))</span></span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a><span class="in">  if(impute == TRUE){</span></span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a><span class="in">    data &lt;- data |&gt;</span></span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true" tabindex="-1"></a><span class="in">      tidyr::pivot_longer(</span></span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true" tabindex="-1"></a><span class="in">        cols = !ID,</span></span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true" tabindex="-1"></a><span class="in">        names_to = "Wave",</span></span>
<span id="cb25-66"><a href="#cb25-66" aria-hidden="true" tabindex="-1"></a><span class="in">        values_to = "Status") |&gt;</span></span>
<span id="cb25-67"><a href="#cb25-67" aria-hidden="true" tabindex="-1"></a><span class="in">      group_by(ID) |&gt;</span></span>
<span id="cb25-68"><a href="#cb25-68" aria-hidden="true" tabindex="-1"></a><span class="in">      tidyr::fill(Status, .direction = "down") |&gt;</span></span>
<span id="cb25-69"><a href="#cb25-69" aria-hidden="true" tabindex="-1"></a><span class="in">      ungroup() |&gt;</span></span>
<span id="cb25-70"><a href="#cb25-70" aria-hidden="true" tabindex="-1"></a><span class="in">      tidyr::pivot_wider(names_from = "Wave", values_from = "Status")</span></span>
<span id="cb25-71"><a href="#cb25-71" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb25-72"><a href="#cb25-72" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-73"><a href="#cb25-73" aria-hidden="true" tabindex="-1"></a><span class="in">  if(absorbing == TRUE) {</span></span>
<span id="cb25-74"><a href="#cb25-74" aria-hidden="true" tabindex="-1"></a><span class="in">    data &lt;- data |&gt;</span></span>
<span id="cb25-75"><a href="#cb25-75" aria-hidden="true" tabindex="-1"></a><span class="in">      tidyr::pivot_longer(</span></span>
<span id="cb25-76"><a href="#cb25-76" aria-hidden="true" tabindex="-1"></a><span class="in">        cols = !ID,</span></span>
<span id="cb25-77"><a href="#cb25-77" aria-hidden="true" tabindex="-1"></a><span class="in">        names_to = "Wave",</span></span>
<span id="cb25-78"><a href="#cb25-78" aria-hidden="true" tabindex="-1"></a><span class="in">        values_to = "Status") |&gt;</span></span>
<span id="cb25-79"><a href="#cb25-79" aria-hidden="true" tabindex="-1"></a><span class="in">      group_by(ID) |&gt;</span></span>
<span id="cb25-80"><a href="#cb25-80" aria-hidden="true" tabindex="-1"></a><span class="in">      mutate(Status = ifelse(cumany(Status == "Dementia"), "Dementia", Status)) |&gt;</span></span>
<span id="cb25-81"><a href="#cb25-81" aria-hidden="true" tabindex="-1"></a><span class="in">      ungroup() |&gt;</span></span>
<span id="cb25-82"><a href="#cb25-82" aria-hidden="true" tabindex="-1"></a><span class="in">      tidyr::pivot_wider(names_from = "Wave", values_from = "Status")</span></span>
<span id="cb25-83"><a href="#cb25-83" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb25-84"><a href="#cb25-84" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-85"><a href="#cb25-85" aria-hidden="true" tabindex="-1"></a><span class="in">  return(data)</span></span>
<span id="cb25-86"><a href="#cb25-86" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb25-87"><a href="#cb25-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-88"><a href="#cb25-88" aria-hidden="true" tabindex="-1"></a><span class="in">create_transitions &lt;- function(data, absorbing = FALSE){</span></span>
<span id="cb25-89"><a href="#cb25-89" aria-hidden="true" tabindex="-1"></a><span class="in">  # Reshapes data from wide to long format to track cognitive status transitions over time.</span></span>
<span id="cb25-90"><a href="#cb25-90" aria-hidden="true" tabindex="-1"></a><span class="in">  # Calculates the next wave's cognitive status for each individual and creates a transition column.</span></span>
<span id="cb25-91"><a href="#cb25-91" aria-hidden="true" tabindex="-1"></a><span class="in">  # Optionally treats "Dementia" as an absorbing state, meaning once an individual is classified</span></span>
<span id="cb25-92"><a href="#cb25-92" aria-hidden="true" tabindex="-1"></a><span class="in">  # with dementia, their status cannot change in subsequent waves.</span></span>
<span id="cb25-93"><a href="#cb25-93" aria-hidden="true" tabindex="-1"></a><span class="in">  # Arguments:</span></span>
<span id="cb25-94"><a href="#cb25-94" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - data: The dataset containing cognitive status data.</span></span>
<span id="cb25-95"><a href="#cb25-95" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - absorbing: A logical flag indicating whether "Dementia" should be treated </span></span>
<span id="cb25-96"><a href="#cb25-96" aria-hidden="true" tabindex="-1"></a><span class="in">  #   as an absorbing state.</span></span>
<span id="cb25-97"><a href="#cb25-97" aria-hidden="true" tabindex="-1"></a><span class="in">  # Returns:</span></span>
<span id="cb25-98"><a href="#cb25-98" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - A dataset with transition information, including current and next wave statuses.</span></span>
<span id="cb25-99"><a href="#cb25-99" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-100"><a href="#cb25-100" aria-hidden="true" tabindex="-1"></a><span class="in">  # Reshape the data from wide to long format to track cognitive status over waves</span></span>
<span id="cb25-101"><a href="#cb25-101" aria-hidden="true" tabindex="-1"></a><span class="in">  data &lt;- data |&gt;</span></span>
<span id="cb25-102"><a href="#cb25-102" aria-hidden="true" tabindex="-1"></a><span class="in">    select(ID, starts_with("cogfunction")) |&gt;</span></span>
<span id="cb25-103"><a href="#cb25-103" aria-hidden="true" tabindex="-1"></a><span class="in">    tidyr::pivot_longer(cols = !ID,</span></span>
<span id="cb25-104"><a href="#cb25-104" aria-hidden="true" tabindex="-1"></a><span class="in">                        names_to = "Wave",</span></span>
<span id="cb25-105"><a href="#cb25-105" aria-hidden="true" tabindex="-1"></a><span class="in">                        values_to = "Status") |&gt;</span></span>
<span id="cb25-106"><a href="#cb25-106" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(Wave = as.factor(stringr::str_replace(Wave, "cogfunction", ""))) |&gt;</span></span>
<span id="cb25-107"><a href="#cb25-107" aria-hidden="true" tabindex="-1"></a><span class="in">    # Arrange by ID and Wave to prepare for transition calculation</span></span>
<span id="cb25-108"><a href="#cb25-108" aria-hidden="true" tabindex="-1"></a><span class="in">    arrange(ID, Wave) |&gt;</span></span>
<span id="cb25-109"><a href="#cb25-109" aria-hidden="true" tabindex="-1"></a><span class="in">    group_by(ID) |&gt;</span></span>
<span id="cb25-110"><a href="#cb25-110" aria-hidden="true" tabindex="-1"></a><span class="in">    # Get the next wave's cognitive status for each person</span></span>
<span id="cb25-111"><a href="#cb25-111" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(next_wave_status = lead(Status)) |&gt;</span></span>
<span id="cb25-112"><a href="#cb25-112" aria-hidden="true" tabindex="-1"></a><span class="in">    ungroup()</span></span>
<span id="cb25-113"><a href="#cb25-113" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-114"><a href="#cb25-114" aria-hidden="true" tabindex="-1"></a><span class="in">  # We can optionally specify dementia as an absorbing state</span></span>
<span id="cb25-115"><a href="#cb25-115" aria-hidden="true" tabindex="-1"></a><span class="in">  # Once an individual is classified with dementia they cannot be classified</span></span>
<span id="cb25-116"><a href="#cb25-116" aria-hidden="true" tabindex="-1"></a><span class="in">  # with anything else </span></span>
<span id="cb25-117"><a href="#cb25-117" aria-hidden="true" tabindex="-1"></a><span class="in">  if(absorbing == TRUE) {</span></span>
<span id="cb25-118"><a href="#cb25-118" aria-hidden="true" tabindex="-1"></a><span class="in">    data &lt;- data |&gt;</span></span>
<span id="cb25-119"><a href="#cb25-119" aria-hidden="true" tabindex="-1"></a><span class="in">      group_by(ID) |&gt;</span></span>
<span id="cb25-120"><a href="#cb25-120" aria-hidden="true" tabindex="-1"></a><span class="in">      mutate(</span></span>
<span id="cb25-121"><a href="#cb25-121" aria-hidden="true" tabindex="-1"></a><span class="in">        Status = ifelse(cumany(Status == "Dementia"), "Dementia", Status),</span></span>
<span id="cb25-122"><a href="#cb25-122" aria-hidden="true" tabindex="-1"></a><span class="in">        next_wave_status = ifelse(cumany(Status == "Dementia"), "Dementia", next_wave_status),</span></span>
<span id="cb25-123"><a href="#cb25-123" aria-hidden="true" tabindex="-1"></a><span class="in">        transition = paste(Status, next_wave_status, sep = " to ")</span></span>
<span id="cb25-124"><a href="#cb25-124" aria-hidden="true" tabindex="-1"></a><span class="in">      ) |&gt;</span></span>
<span id="cb25-125"><a href="#cb25-125" aria-hidden="true" tabindex="-1"></a><span class="in">      filter(Wave %in% c(2016, 2018, 2020))</span></span>
<span id="cb25-126"><a href="#cb25-126" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb25-127"><a href="#cb25-127" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-128"><a href="#cb25-128" aria-hidden="true" tabindex="-1"></a><span class="in">  # Filter out rows where either the current or next status is missing</span></span>
<span id="cb25-129"><a href="#cb25-129" aria-hidden="true" tabindex="-1"></a><span class="in">  data &lt;- data |&gt;</span></span>
<span id="cb25-130"><a href="#cb25-130" aria-hidden="true" tabindex="-1"></a><span class="in">    group_by(ID) |&gt;</span></span>
<span id="cb25-131"><a href="#cb25-131" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(!is.na(Status), !is.na(next_wave_status)) |&gt;</span></span>
<span id="cb25-132"><a href="#cb25-132" aria-hidden="true" tabindex="-1"></a><span class="in">    ungroup() |&gt;</span></span>
<span id="cb25-133"><a href="#cb25-133" aria-hidden="true" tabindex="-1"></a><span class="in">    # Create a new column representing the transition from one status to the next</span></span>
<span id="cb25-134"><a href="#cb25-134" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(</span></span>
<span id="cb25-135"><a href="#cb25-135" aria-hidden="true" tabindex="-1"></a><span class="in">      transition = paste(Status, next_wave_status, sep = " to "),</span></span>
<span id="cb25-136"><a href="#cb25-136" aria-hidden="true" tabindex="-1"></a><span class="in">      transition = factor(</span></span>
<span id="cb25-137"><a href="#cb25-137" aria-hidden="true" tabindex="-1"></a><span class="in">        transition, </span></span>
<span id="cb25-138"><a href="#cb25-138" aria-hidden="true" tabindex="-1"></a><span class="in">        levels = c("Normal Cognition to Normal Cognition", "Normal Cognition to MCI",</span></span>
<span id="cb25-139"><a href="#cb25-139" aria-hidden="true" tabindex="-1"></a><span class="in">                   "Normal Cognition to Dementia", "MCI to Normal Cognition", "MCI to MCI",</span></span>
<span id="cb25-140"><a href="#cb25-140" aria-hidden="true" tabindex="-1"></a><span class="in">                   "MCI to Dementia", "Dementia to Dementia") </span></span>
<span id="cb25-141"><a href="#cb25-141" aria-hidden="true" tabindex="-1"></a><span class="in">        ))</span></span>
<span id="cb25-142"><a href="#cb25-142" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-143"><a href="#cb25-143" aria-hidden="true" tabindex="-1"></a><span class="in">  return(data)</span></span>
<span id="cb25-144"><a href="#cb25-144" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb25-145"><a href="#cb25-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-146"><a href="#cb25-146" aria-hidden="true" tabindex="-1"></a><span class="in">calculate_probabilties &lt;- function(data) {</span></span>
<span id="cb25-147"><a href="#cb25-147" aria-hidden="true" tabindex="-1"></a><span class="in">  # Calculates the proportion of each cognitive status transition in the dataset.</span></span>
<span id="cb25-148"><a href="#cb25-148" aria-hidden="true" tabindex="-1"></a><span class="in">  # Counts the occurrences of each transition and computes their relative probabilities.</span></span>
<span id="cb25-149"><a href="#cb25-149" aria-hidden="true" tabindex="-1"></a><span class="in">  # Arguments:</span></span>
<span id="cb25-150"><a href="#cb25-150" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - data: The dataset containing transition information.</span></span>
<span id="cb25-151"><a href="#cb25-151" aria-hidden="true" tabindex="-1"></a><span class="in">  # Returns:</span></span>
<span id="cb25-152"><a href="#cb25-152" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - A dataset with transition probabilities, split into "from" and "to" states.</span></span>
<span id="cb25-153"><a href="#cb25-153" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-154"><a href="#cb25-154" aria-hidden="true" tabindex="-1"></a><span class="in">  # Calculate the proportion of each transition by dividing by the total count</span></span>
<span id="cb25-155"><a href="#cb25-155" aria-hidden="true" tabindex="-1"></a><span class="in">  data |&gt;</span></span>
<span id="cb25-156"><a href="#cb25-156" aria-hidden="true" tabindex="-1"></a><span class="in">    count(transition) |&gt;</span></span>
<span id="cb25-157"><a href="#cb25-157" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(prop = n / sum(n)) |&gt;</span></span>
<span id="cb25-158"><a href="#cb25-158" aria-hidden="true" tabindex="-1"></a><span class="in">    tidyr::separate(transition, into = c("from", "to"), sep = " to ")</span></span>
<span id="cb25-159"><a href="#cb25-159" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb25-160"><a href="#cb25-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-161"><a href="#cb25-161" aria-hidden="true" tabindex="-1"></a><span class="in">transition_matrix &lt;- function(data, longitudinal = FALSE) {</span></span>
<span id="cb25-162"><a href="#cb25-162" aria-hidden="true" tabindex="-1"></a><span class="in">  # Constructs a transition matrix from the calculated transition probabilities.</span></span>
<span id="cb25-163"><a href="#cb25-163" aria-hidden="true" tabindex="-1"></a><span class="in">  # The matrix represents the probability of moving from one cognitive state to another.</span></span>
<span id="cb25-164"><a href="#cb25-164" aria-hidden="true" tabindex="-1"></a><span class="in">  # Arguments:</span></span>
<span id="cb25-165"><a href="#cb25-165" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - data: The dataset containing transition probabilities.</span></span>
<span id="cb25-166"><a href="#cb25-166" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - longitudinal: A TRUE/FALSE statement indicating if the probabilities are from multiple waves</span></span>
<span id="cb25-167"><a href="#cb25-167" aria-hidden="true" tabindex="-1"></a><span class="in">  # Returns:</span></span>
<span id="cb25-168"><a href="#cb25-168" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - A transition matrix with rows representing "from" states and columns </span></span>
<span id="cb25-169"><a href="#cb25-169" aria-hidden="true" tabindex="-1"></a><span class="in">  #   representing "to" states.</span></span>
<span id="cb25-170"><a href="#cb25-170" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-171"><a href="#cb25-171" aria-hidden="true" tabindex="-1"></a><span class="in">  if(longitudinal == FALSE) {</span></span>
<span id="cb25-172"><a href="#cb25-172" aria-hidden="true" tabindex="-1"></a><span class="in">    # Defining empty matrix matrix</span></span>
<span id="cb25-173"><a href="#cb25-173" aria-hidden="true" tabindex="-1"></a><span class="in">    states &lt;- c("Normal Cognition", "MCI", "Dementia")</span></span>
<span id="cb25-174"><a href="#cb25-174" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb25-175"><a href="#cb25-175" aria-hidden="true" tabindex="-1"></a><span class="in">    transition_matrix &lt;- matrix(</span></span>
<span id="cb25-176"><a href="#cb25-176" aria-hidden="true" tabindex="-1"></a><span class="in">      0,</span></span>
<span id="cb25-177"><a href="#cb25-177" aria-hidden="true" tabindex="-1"></a><span class="in">      nrow = length(states),</span></span>
<span id="cb25-178"><a href="#cb25-178" aria-hidden="true" tabindex="-1"></a><span class="in">      ncol = length(states),</span></span>
<span id="cb25-179"><a href="#cb25-179" aria-hidden="true" tabindex="-1"></a><span class="in">      dimnames = list(from_state = states, to_state = states))</span></span>
<span id="cb25-180"><a href="#cb25-180" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb25-181"><a href="#cb25-181" aria-hidden="true" tabindex="-1"></a><span class="in">    # Fill the transition matrix with probabilities</span></span>
<span id="cb25-182"><a href="#cb25-182" aria-hidden="true" tabindex="-1"></a><span class="in">    for (i in 1:nrow(data)) {</span></span>
<span id="cb25-183"><a href="#cb25-183" aria-hidden="true" tabindex="-1"></a><span class="in">      from &lt;- data$from[i]</span></span>
<span id="cb25-184"><a href="#cb25-184" aria-hidden="true" tabindex="-1"></a><span class="in">      to &lt;- data$to[i]</span></span>
<span id="cb25-185"><a href="#cb25-185" aria-hidden="true" tabindex="-1"></a><span class="in">      prob &lt;- data$prop[i]</span></span>
<span id="cb25-186"><a href="#cb25-186" aria-hidden="true" tabindex="-1"></a><span class="in">      </span></span>
<span id="cb25-187"><a href="#cb25-187" aria-hidden="true" tabindex="-1"></a><span class="in">      transition_matrix[from, to] &lt;- prob</span></span>
<span id="cb25-188"><a href="#cb25-188" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb25-189"><a href="#cb25-189" aria-hidden="true" tabindex="-1"></a><span class="in">  } else if(longitudinal == TRUE){</span></span>
<span id="cb25-190"><a href="#cb25-190" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb25-191"><a href="#cb25-191" aria-hidden="true" tabindex="-1"></a><span class="in">    # Aggregate by 'from' and 'to' states to sum transition probabilities</span></span>
<span id="cb25-192"><a href="#cb25-192" aria-hidden="true" tabindex="-1"></a><span class="in">    data_agg &lt;- data |&gt;</span></span>
<span id="cb25-193"><a href="#cb25-193" aria-hidden="true" tabindex="-1"></a><span class="in">      group_by(from, to) |&gt;</span></span>
<span id="cb25-194"><a href="#cb25-194" aria-hidden="true" tabindex="-1"></a><span class="in">      summarise(transition_prob = sum(prop), .groups = "drop")</span></span>
<span id="cb25-195"><a href="#cb25-195" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb25-196"><a href="#cb25-196" aria-hidden="true" tabindex="-1"></a><span class="in">    transition_matrix &lt;- data_agg |&gt;</span></span>
<span id="cb25-197"><a href="#cb25-197" aria-hidden="true" tabindex="-1"></a><span class="in">      tidyr::pivot_wider(names_from = to, values_from = transition_prob, values_fill = 0) |&gt;</span></span>
<span id="cb25-198"><a href="#cb25-198" aria-hidden="true" tabindex="-1"></a><span class="in">      tibble::column_to_rownames("from") |&gt;</span></span>
<span id="cb25-199"><a href="#cb25-199" aria-hidden="true" tabindex="-1"></a><span class="in">      as.matrix()</span></span>
<span id="cb25-200"><a href="#cb25-200" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb25-201"><a href="#cb25-201" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-202"><a href="#cb25-202" aria-hidden="true" tabindex="-1"></a><span class="in">  return(transition_matrix)</span></span>
<span id="cb25-203"><a href="#cb25-203" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb25-204"><a href="#cb25-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-205"><a href="#cb25-205" aria-hidden="true" tabindex="-1"></a><span class="in">plot_matrix &lt;- function(data, year, ts = FALSE) {</span></span>
<span id="cb25-206"><a href="#cb25-206" aria-hidden="true" tabindex="-1"></a><span class="in">  # Visualizes the transition matrix as a heatmap.</span></span>
<span id="cb25-207"><a href="#cb25-207" aria-hidden="true" tabindex="-1"></a><span class="in">  # Uses color gradients to represent transition probabilities and includes labels for clarity.</span></span>
<span id="cb25-208"><a href="#cb25-208" aria-hidden="true" tabindex="-1"></a><span class="in">  # Arguments:</span></span>
<span id="cb25-209"><a href="#cb25-209" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - data: The transition matrix or dataset to plot.</span></span>
<span id="cb25-210"><a href="#cb25-210" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - year: The year or time period associated with the data.</span></span>
<span id="cb25-211"><a href="#cb25-211" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - ts: A logical flag indicating whether the title should include a time series label.</span></span>
<span id="cb25-212"><a href="#cb25-212" aria-hidden="true" tabindex="-1"></a><span class="in">  # Returns:</span></span>
<span id="cb25-213"><a href="#cb25-213" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - A ggplot object representing the transition probabilities as a heatmap.</span></span>
<span id="cb25-214"><a href="#cb25-214" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-215"><a href="#cb25-215" aria-hidden="true" tabindex="-1"></a><span class="in">  if(ts == TRUE) {</span></span>
<span id="cb25-216"><a href="#cb25-216" aria-hidden="true" tabindex="-1"></a><span class="in">    title &lt;- paste0("Transition Probabilities Across Cognitive States - ", year)</span></span>
<span id="cb25-217"><a href="#cb25-217" aria-hidden="true" tabindex="-1"></a><span class="in">  } else {</span></span>
<span id="cb25-218"><a href="#cb25-218" aria-hidden="true" tabindex="-1"></a><span class="in">    title &lt;- paste0("Transition Probabilities Across Cognitive States (", year, "-2022)")</span></span>
<span id="cb25-219"><a href="#cb25-219" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb25-220"><a href="#cb25-220" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-221"><a href="#cb25-221" aria-hidden="true" tabindex="-1"></a><span class="in">  # Reshaping data for plotting</span></span>
<span id="cb25-222"><a href="#cb25-222" aria-hidden="true" tabindex="-1"></a><span class="in">  data &lt;- data |&gt;</span></span>
<span id="cb25-223"><a href="#cb25-223" aria-hidden="true" tabindex="-1"></a><span class="in">    as.data.frame(row.names = FALSE) |&gt;</span></span>
<span id="cb25-224"><a href="#cb25-224" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(from_state = c("Normal Cognition", "MCI", "Dementia")) |&gt;</span></span>
<span id="cb25-225"><a href="#cb25-225" aria-hidden="true" tabindex="-1"></a><span class="in">    reshape2::melt(id.vars = "from_state", variable.name = "to_state", value.name = "probability")</span></span>
<span id="cb25-226"><a href="#cb25-226" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-227"><a href="#cb25-227" aria-hidden="true" tabindex="-1"></a><span class="in">  # Plotting probabilities</span></span>
<span id="cb25-228"><a href="#cb25-228" aria-hidden="true" tabindex="-1"></a><span class="in">  data |&gt;</span></span>
<span id="cb25-229"><a href="#cb25-229" aria-hidden="true" tabindex="-1"></a><span class="in">    ggplot(aes(x = from_state, y = to_state, fill = probability)) +</span></span>
<span id="cb25-230"><a href="#cb25-230" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_tile() +</span></span>
<span id="cb25-231"><a href="#cb25-231" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_fill_viridis_c(alpha = 0.8) +</span></span>
<span id="cb25-232"><a href="#cb25-232" aria-hidden="true" tabindex="-1"></a><span class="in">    labs(title = title,</span></span>
<span id="cb25-233"><a href="#cb25-233" aria-hidden="true" tabindex="-1"></a><span class="in">         x = "To", y = "From", fill = "Prob") +</span></span>
<span id="cb25-234"><a href="#cb25-234" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_text(aes(label = round(probability, digits = 3)), size = 5) +</span></span>
<span id="cb25-235"><a href="#cb25-235" aria-hidden="true" tabindex="-1"></a><span class="in">    theme_minimal() +</span></span>
<span id="cb25-236"><a href="#cb25-236" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(plot.title = element_text(hjust = 0.5, size = 12, face = "bold"),</span></span>
<span id="cb25-237"><a href="#cb25-237" aria-hidden="true" tabindex="-1"></a><span class="in">          axis.title = element_text(size = 10),</span></span>
<span id="cb25-238"><a href="#cb25-238" aria-hidden="true" tabindex="-1"></a><span class="in">          axis.text = element_text(size = 8),</span></span>
<span id="cb25-239"><a href="#cb25-239" aria-hidden="true" tabindex="-1"></a><span class="in">          panel.grid = element_blank()</span></span>
<span id="cb25-240"><a href="#cb25-240" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb25-241"><a href="#cb25-241" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb25-242"><a href="#cb25-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-243"><a href="#cb25-243" aria-hidden="true" tabindex="-1"></a><span class="in">normalise &lt;- function(x) {</span></span>
<span id="cb25-244"><a href="#cb25-244" aria-hidden="true" tabindex="-1"></a><span class="in">  # Normalizes a matrix so that each row sums to 1.</span></span>
<span id="cb25-245"><a href="#cb25-245" aria-hidden="true" tabindex="-1"></a><span class="in">  # Arguments:</span></span>
<span id="cb25-246"><a href="#cb25-246" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - x: The input matrix to normalize.</span></span>
<span id="cb25-247"><a href="#cb25-247" aria-hidden="true" tabindex="-1"></a><span class="in">  # Returns:</span></span>
<span id="cb25-248"><a href="#cb25-248" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - A normalized matrix where each row sums to 1.</span></span>
<span id="cb25-249"><a href="#cb25-249" aria-hidden="true" tabindex="-1"></a><span class="in">  x / rowSums(x)</span></span>
<span id="cb25-250"><a href="#cb25-250" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb25-251"><a href="#cb25-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-252"><a href="#cb25-252" aria-hidden="true" tabindex="-1"></a><span class="in">reshape_matrix &lt;- function(matrix, wave) {</span></span>
<span id="cb25-253"><a href="#cb25-253" aria-hidden="true" tabindex="-1"></a><span class="in">  # Reshapes a transition matrix into a long format for easier analysis and visualization.</span></span>
<span id="cb25-254"><a href="#cb25-254" aria-hidden="true" tabindex="-1"></a><span class="in">  # Adds a "Wave" column to identify the time period associated with the matrix.</span></span>
<span id="cb25-255"><a href="#cb25-255" aria-hidden="true" tabindex="-1"></a><span class="in">  # Arguments:</span></span>
<span id="cb25-256"><a href="#cb25-256" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - matrix: The transition matrix to reshape.</span></span>
<span id="cb25-257"><a href="#cb25-257" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - wave: The wave or time period associated with the matrix.</span></span>
<span id="cb25-258"><a href="#cb25-258" aria-hidden="true" tabindex="-1"></a><span class="in">  # Returns:</span></span>
<span id="cb25-259"><a href="#cb25-259" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - A long-format dataset with "from", "to", and "transition_prob" columns.</span></span>
<span id="cb25-260"><a href="#cb25-260" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-261"><a href="#cb25-261" aria-hidden="true" tabindex="-1"></a><span class="in">  matrix |&gt;</span></span>
<span id="cb25-262"><a href="#cb25-262" aria-hidden="true" tabindex="-1"></a><span class="in">    as.data.frame() |&gt;</span></span>
<span id="cb25-263"><a href="#cb25-263" aria-hidden="true" tabindex="-1"></a><span class="in">    tibble::rownames_to_column(var = "from") |&gt;</span></span>
<span id="cb25-264"><a href="#cb25-264" aria-hidden="true" tabindex="-1"></a><span class="in">    tidyr::pivot_longer(cols = -from, names_to = "to", values_to = "transition_prob") |&gt;</span></span>
<span id="cb25-265"><a href="#cb25-265" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(Wave = wave)</span></span>
<span id="cb25-266"><a href="#cb25-266" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb25-267"><a href="#cb25-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-268"><a href="#cb25-268" aria-hidden="true" tabindex="-1"></a><span class="in">plot_transition_wave &lt;- function(data, wave) {</span></span>
<span id="cb25-269"><a href="#cb25-269" aria-hidden="true" tabindex="-1"></a><span class="in">  # Plots transition probabilities for a specific wave as a heatmap.</span></span>
<span id="cb25-270"><a href="#cb25-270" aria-hidden="true" tabindex="-1"></a><span class="in">  # Filters the data to include only the main transitions and adds labels for clarity.</span></span>
<span id="cb25-271"><a href="#cb25-271" aria-hidden="true" tabindex="-1"></a><span class="in">  # Arguments:</span></span>
<span id="cb25-272"><a href="#cb25-272" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - data: The dataset containing transition probabilities.</span></span>
<span id="cb25-273"><a href="#cb25-273" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - wave: The wave or time period to plot.</span></span>
<span id="cb25-274"><a href="#cb25-274" aria-hidden="true" tabindex="-1"></a><span class="in">  # Returns:</span></span>
<span id="cb25-275"><a href="#cb25-275" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - A ggplot object representing the transition probabilities for the </span></span>
<span id="cb25-276"><a href="#cb25-276" aria-hidden="true" tabindex="-1"></a><span class="in">  #   specified wave.</span></span>
<span id="cb25-277"><a href="#cb25-277" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-278"><a href="#cb25-278" aria-hidden="true" tabindex="-1"></a><span class="in">  # Main transitions per wave</span></span>
<span id="cb25-279"><a href="#cb25-279" aria-hidden="true" tabindex="-1"></a><span class="in">  filter_data &lt;- data.frame(</span></span>
<span id="cb25-280"><a href="#cb25-280" aria-hidden="true" tabindex="-1"></a><span class="in">    from = c("Normal Cognition", "Normal Cognition", "Normal Cognition",  "MCI", "MCI", "MCI", "Dementia", "Dementia", "Dementia"),</span></span>
<span id="cb25-281"><a href="#cb25-281" aria-hidden="true" tabindex="-1"></a><span class="in">    to = c("Normal Cognition", "MCI", "Dementia", "Normal Cognition", "MCI", "Dementia", "Normal Cognition", "MCI", "Dementia")</span></span>
<span id="cb25-282"><a href="#cb25-282" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb25-283"><a href="#cb25-283" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-284"><a href="#cb25-284" aria-hidden="true" tabindex="-1"></a><span class="in">  data |&gt;</span></span>
<span id="cb25-285"><a href="#cb25-285" aria-hidden="true" tabindex="-1"></a><span class="in">    semi_join(filter_data, by = c("from", "to")) |&gt;</span></span>
<span id="cb25-286"><a href="#cb25-286" aria-hidden="true" tabindex="-1"></a><span class="in">    filter(Wave == wave) |&gt;</span></span>
<span id="cb25-287"><a href="#cb25-287" aria-hidden="true" tabindex="-1"></a><span class="in">    ggplot(aes(x = to, y = from, fill = transition_prob)) +</span></span>
<span id="cb25-288"><a href="#cb25-288" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_tile() +</span></span>
<span id="cb25-289"><a href="#cb25-289" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_text(aes(label = transition_prob), size = 5) +</span></span>
<span id="cb25-290"><a href="#cb25-290" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_fill_viridis_c(alpha = 0.8)+</span></span>
<span id="cb25-291"><a href="#cb25-291" aria-hidden="true" tabindex="-1"></a><span class="in">    labs(title = paste0("Transition Probabilities Across Cognitive States (", wave, "-", wave + 2, ")"),</span></span>
<span id="cb25-292"><a href="#cb25-292" aria-hidden="true" tabindex="-1"></a><span class="in">         x = "To", y = "From", fill = "Prob") +</span></span>
<span id="cb25-293"><a href="#cb25-293" aria-hidden="true" tabindex="-1"></a><span class="in">    theme_light() +</span></span>
<span id="cb25-294"><a href="#cb25-294" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(</span></span>
<span id="cb25-295"><a href="#cb25-295" aria-hidden="true" tabindex="-1"></a><span class="in">      plot.title = element_text(hjust = 0.5, size = 12, face = "bold"),</span></span>
<span id="cb25-296"><a href="#cb25-296" aria-hidden="true" tabindex="-1"></a><span class="in">      axis.title = element_text(size = 10),</span></span>
<span id="cb25-297"><a href="#cb25-297" aria-hidden="true" tabindex="-1"></a><span class="in">      axis.text = element_text(size = 8),</span></span>
<span id="cb25-298"><a href="#cb25-298" aria-hidden="true" tabindex="-1"></a><span class="in">      panel.grid = element_blank(),</span></span>
<span id="cb25-299"><a href="#cb25-299" aria-hidden="true" tabindex="-1"></a><span class="in">      panel.border = element_blank()</span></span>
<span id="cb25-300"><a href="#cb25-300" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb25-301"><a href="#cb25-301" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb25-302"><a href="#cb25-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-303"><a href="#cb25-303" aria-hidden="true" tabindex="-1"></a><span class="in">backtrack_age &lt;- function(data, base_year, current_year) {</span></span>
<span id="cb25-304"><a href="#cb25-304" aria-hidden="true" tabindex="-1"></a><span class="in">  # Back calculates an individual's age by 2-year intervals</span></span>
<span id="cb25-305"><a href="#cb25-305" aria-hidden="true" tabindex="-1"></a><span class="in">  # Arguments:</span></span>
<span id="cb25-306"><a href="#cb25-306" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - data: The dataset containing the age variable and a 'Wave' column indicating the year of the wave</span></span>
<span id="cb25-307"><a href="#cb25-307" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - current_year: The year for which the age is measured (e.g., 2022)</span></span>
<span id="cb25-308"><a href="#cb25-308" aria-hidden="true" tabindex="-1"></a><span class="in">  # Returns:</span></span>
<span id="cb25-309"><a href="#cb25-309" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - A dataset where the age is subtracted by intervals of 2 for each respective year</span></span>
<span id="cb25-310"><a href="#cb25-310" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-311"><a href="#cb25-311" aria-hidden="true" tabindex="-1"></a><span class="in">  # Map Wave values (1-10) to their corresponding years</span></span>
<span id="cb25-312"><a href="#cb25-312" aria-hidden="true" tabindex="-1"></a><span class="in">  wave_to_year &lt;- function(wave) {</span></span>
<span id="cb25-313"><a href="#cb25-313" aria-hidden="true" tabindex="-1"></a><span class="in">    base_year + (as.numeric(wave) - 1) * 2</span></span>
<span id="cb25-314"><a href="#cb25-314" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb25-315"><a href="#cb25-315" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-316"><a href="#cb25-316" aria-hidden="true" tabindex="-1"></a><span class="in">  data |&gt;</span></span>
<span id="cb25-317"><a href="#cb25-317" aria-hidden="true" tabindex="-1"></a><span class="in">    group_by(ID) |&gt;</span></span>
<span id="cb25-318"><a href="#cb25-318" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(Age = Age - (current_year - wave_to_year(Wave))) |&gt;</span></span>
<span id="cb25-319"><a href="#cb25-319" aria-hidden="true" tabindex="-1"></a><span class="in">    ungroup()</span></span>
<span id="cb25-320"><a href="#cb25-320" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb25-321"><a href="#cb25-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-322"><a href="#cb25-322" aria-hidden="true" tabindex="-1"></a><span class="in">pivot_data &lt;- function(data, cog_total = FALSE) {</span></span>
<span id="cb25-323"><a href="#cb25-323" aria-hidden="true" tabindex="-1"></a><span class="in">  # Reshapes the input dataset by pivoting cardiovascular, depression, and cognitive data</span></span>
<span id="cb25-324"><a href="#cb25-324" aria-hidden="true" tabindex="-1"></a><span class="in">  # into long format for analysis. Handles two scenarios: one for cognitive status and</span></span>
<span id="cb25-325"><a href="#cb25-325" aria-hidden="true" tabindex="-1"></a><span class="in">  # another for total cognitive scores. Combines the pivoted data into a final dataset</span></span>
<span id="cb25-326"><a href="#cb25-326" aria-hidden="true" tabindex="-1"></a><span class="in">  # for further analysis.</span></span>
<span id="cb25-327"><a href="#cb25-327" aria-hidden="true" tabindex="-1"></a><span class="in">  # Arguments:</span></span>
<span id="cb25-328"><a href="#cb25-328" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - data: The input dataset containing cardiovascular, depression, and cognitive data.</span></span>
<span id="cb25-329"><a href="#cb25-329" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - cog_total: A logical flag indicating whether to pivot total cognitive scores (TRUE)</span></span>
<span id="cb25-330"><a href="#cb25-330" aria-hidden="true" tabindex="-1"></a><span class="in">  #               or cognitive status (FALSE).</span></span>
<span id="cb25-331"><a href="#cb25-331" aria-hidden="true" tabindex="-1"></a><span class="in">  # Returns:</span></span>
<span id="cb25-332"><a href="#cb25-332" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - A reshaped dataset in long format with combined cardiovascular, depression, and</span></span>
<span id="cb25-333"><a href="#cb25-333" aria-hidden="true" tabindex="-1"></a><span class="in">  #     cognitive data, ready for analysis.</span></span>
<span id="cb25-334"><a href="#cb25-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-335"><a href="#cb25-335" aria-hidden="true" tabindex="-1"></a><span class="in">  # Pivot cardio dataset</span></span>
<span id="cb25-336"><a href="#cb25-336" aria-hidden="true" tabindex="-1"></a><span class="in">  data_cardio &lt;- data |&gt;</span></span>
<span id="cb25-337"><a href="#cb25-337" aria-hidden="true" tabindex="-1"></a><span class="in">    tidyr::pivot_longer(</span></span>
<span id="cb25-338"><a href="#cb25-338" aria-hidden="true" tabindex="-1"></a><span class="in">      cols = starts_with("Cardio_risk"),</span></span>
<span id="cb25-339"><a href="#cb25-339" aria-hidden="true" tabindex="-1"></a><span class="in">      names_to = "Cardio_Year",</span></span>
<span id="cb25-340"><a href="#cb25-340" aria-hidden="true" tabindex="-1"></a><span class="in">      values_to = "Cardio_risk"</span></span>
<span id="cb25-341"><a href="#cb25-341" aria-hidden="true" tabindex="-1"></a><span class="in">    ) |&gt;</span></span>
<span id="cb25-342"><a href="#cb25-342" aria-hidden="true" tabindex="-1"></a><span class="in">    select(!any_of(c(</span></span>
<span id="cb25-343"><a href="#cb25-343" aria-hidden="true" tabindex="-1"></a><span class="in">      "Cardio_Year", </span></span>
<span id="cb25-344"><a href="#cb25-344" aria-hidden="true" tabindex="-1"></a><span class="in">      paste0("cogfunction", 2016:2022), </span></span>
<span id="cb25-345"><a href="#cb25-345" aria-hidden="true" tabindex="-1"></a><span class="in">      paste0("cog_score_", 2016:2022)</span></span>
<span id="cb25-346"><a href="#cb25-346" aria-hidden="true" tabindex="-1"></a><span class="in">      )))</span></span>
<span id="cb25-347"><a href="#cb25-347" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-348"><a href="#cb25-348" aria-hidden="true" tabindex="-1"></a><span class="in">  # Pivot dementia dataset</span></span>
<span id="cb25-349"><a href="#cb25-349" aria-hidden="true" tabindex="-1"></a><span class="in">  data_dep &lt;- data |&gt;</span></span>
<span id="cb25-350"><a href="#cb25-350" aria-hidden="true" tabindex="-1"></a><span class="in">    tidyr::pivot_longer(</span></span>
<span id="cb25-351"><a href="#cb25-351" aria-hidden="true" tabindex="-1"></a><span class="in">      cols = starts_with("Total_dep"),</span></span>
<span id="cb25-352"><a href="#cb25-352" aria-hidden="true" tabindex="-1"></a><span class="in">      names_to = "Dep_Year",</span></span>
<span id="cb25-353"><a href="#cb25-353" aria-hidden="true" tabindex="-1"></a><span class="in">      values_to = "Depression_score"</span></span>
<span id="cb25-354"><a href="#cb25-354" aria-hidden="true" tabindex="-1"></a><span class="in">    ) |&gt;</span></span>
<span id="cb25-355"><a href="#cb25-355" aria-hidden="true" tabindex="-1"></a><span class="in">    select(ID, Depression_score)</span></span>
<span id="cb25-356"><a href="#cb25-356" aria-hidden="true" tabindex="-1"></a><span class="in">           </span></span>
<span id="cb25-357"><a href="#cb25-357" aria-hidden="true" tabindex="-1"></a><span class="in">  if(cog_total == FALSE) {</span></span>
<span id="cb25-358"><a href="#cb25-358" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb25-359"><a href="#cb25-359" aria-hidden="true" tabindex="-1"></a><span class="in">    # Pivot cognition dataset</span></span>
<span id="cb25-360"><a href="#cb25-360" aria-hidden="true" tabindex="-1"></a><span class="in">    data_cog &lt;- data |&gt;</span></span>
<span id="cb25-361"><a href="#cb25-361" aria-hidden="true" tabindex="-1"></a><span class="in">      tidyr::pivot_longer(</span></span>
<span id="cb25-362"><a href="#cb25-362" aria-hidden="true" tabindex="-1"></a><span class="in">        cols = starts_with("cogfunction"),</span></span>
<span id="cb25-363"><a href="#cb25-363" aria-hidden="true" tabindex="-1"></a><span class="in">        names_to = "Wave",</span></span>
<span id="cb25-364"><a href="#cb25-364" aria-hidden="true" tabindex="-1"></a><span class="in">        values_to = "Status"</span></span>
<span id="cb25-365"><a href="#cb25-365" aria-hidden="true" tabindex="-1"></a><span class="in">      ) |&gt;</span></span>
<span id="cb25-366"><a href="#cb25-366" aria-hidden="true" tabindex="-1"></a><span class="in">      select(!any_of(c(</span></span>
<span id="cb25-367"><a href="#cb25-367" aria-hidden="true" tabindex="-1"></a><span class="in">        paste0("Cardio_risk_", 16:22), </span></span>
<span id="cb25-368"><a href="#cb25-368" aria-hidden="true" tabindex="-1"></a><span class="in">        paste0("Total_dep_20", 16:22))</span></span>
<span id="cb25-369"><a href="#cb25-369" aria-hidden="true" tabindex="-1"></a><span class="in">        ))</span></span>
<span id="cb25-370"><a href="#cb25-370" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-371"><a href="#cb25-371" aria-hidden="true" tabindex="-1"></a><span class="in">  # Adding cardio data to cognition data</span></span>
<span id="cb25-372"><a href="#cb25-372" aria-hidden="true" tabindex="-1"></a><span class="in">  combine_data &lt;- data_cog |&gt;</span></span>
<span id="cb25-373"><a href="#cb25-373" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(Cardio_risk = data_cardio$Cardio_risk, .after = Education_tri) |&gt;</span></span>
<span id="cb25-374"><a href="#cb25-374" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(Depression = data_dep$Depression_score, .after = Cardio_risk)</span></span>
<span id="cb25-375"><a href="#cb25-375" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-376"><a href="#cb25-376" aria-hidden="true" tabindex="-1"></a><span class="in">  # Producing final dataset</span></span>
<span id="cb25-377"><a href="#cb25-377" aria-hidden="true" tabindex="-1"></a><span class="in">  final_data &lt;- combine_data |&gt;</span></span>
<span id="cb25-378"><a href="#cb25-378" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(</span></span>
<span id="cb25-379"><a href="#cb25-379" aria-hidden="true" tabindex="-1"></a><span class="in">      Wave = stringr::str_replace(Wave, "cogfunction", "HRS_"),</span></span>
<span id="cb25-380"><a href="#cb25-380" aria-hidden="true" tabindex="-1"></a><span class="in">      Wave = factor(</span></span>
<span id="cb25-381"><a href="#cb25-381" aria-hidden="true" tabindex="-1"></a><span class="in">        Wave,</span></span>
<span id="cb25-382"><a href="#cb25-382" aria-hidden="true" tabindex="-1"></a><span class="in">        levels = c("HRS_2016", "HRS_2018", "HRS_2020", "HRS_2022"),</span></span>
<span id="cb25-383"><a href="#cb25-383" aria-hidden="true" tabindex="-1"></a><span class="in">        labels = c(1, 2, 3, 4)</span></span>
<span id="cb25-384"><a href="#cb25-384" aria-hidden="true" tabindex="-1"></a><span class="in">      )) |&gt;</span></span>
<span id="cb25-385"><a href="#cb25-385" aria-hidden="true" tabindex="-1"></a><span class="in">    group_by(ID) |&gt;</span></span>
<span id="cb25-386"><a href="#cb25-386" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(</span></span>
<span id="cb25-387"><a href="#cb25-387" aria-hidden="true" tabindex="-1"></a><span class="in">      Status = ifelse(cumany(Status == "Dementia"), "Dementia", Status),</span></span>
<span id="cb25-388"><a href="#cb25-388" aria-hidden="true" tabindex="-1"></a><span class="in">      Status = factor(</span></span>
<span id="cb25-389"><a href="#cb25-389" aria-hidden="true" tabindex="-1"></a><span class="in">        Status,</span></span>
<span id="cb25-390"><a href="#cb25-390" aria-hidden="true" tabindex="-1"></a><span class="in">        levels = c("Normal Cognition", "MCI", "Dementia"),</span></span>
<span id="cb25-391"><a href="#cb25-391" aria-hidden="true" tabindex="-1"></a><span class="in">        labels = c(1, 2, 3)</span></span>
<span id="cb25-392"><a href="#cb25-392" aria-hidden="true" tabindex="-1"></a><span class="in">      )) |&gt;</span></span>
<span id="cb25-393"><a href="#cb25-393" aria-hidden="true" tabindex="-1"></a><span class="in">    ungroup() |&gt;</span></span>
<span id="cb25-394"><a href="#cb25-394" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(</span></span>
<span id="cb25-395"><a href="#cb25-395" aria-hidden="true" tabindex="-1"></a><span class="in">      Gender = factor(Gender, levels = c(0, 1)),</span></span>
<span id="cb25-396"><a href="#cb25-396" aria-hidden="true" tabindex="-1"></a><span class="in">      Education_tri = factor(Education_tri, levels = c(0, 1, 2)),</span></span>
<span id="cb25-397"><a href="#cb25-397" aria-hidden="true" tabindex="-1"></a><span class="in">      Wave = as.numeric(Wave),</span></span>
<span id="cb25-398"><a href="#cb25-398" aria-hidden="true" tabindex="-1"></a><span class="in">      Status = as.numeric(Status)</span></span>
<span id="cb25-399"><a href="#cb25-399" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb25-400"><a href="#cb25-400" aria-hidden="true" tabindex="-1"></a><span class="in">  } else {</span></span>
<span id="cb25-401"><a href="#cb25-401" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb25-402"><a href="#cb25-402" aria-hidden="true" tabindex="-1"></a><span class="in">    # Pivot cog total data</span></span>
<span id="cb25-403"><a href="#cb25-403" aria-hidden="true" tabindex="-1"></a><span class="in">    data_score &lt;- data |&gt;</span></span>
<span id="cb25-404"><a href="#cb25-404" aria-hidden="true" tabindex="-1"></a><span class="in">      tidyr::pivot_longer(</span></span>
<span id="cb25-405"><a href="#cb25-405" aria-hidden="true" tabindex="-1"></a><span class="in">        cols = starts_with("cog_score"),</span></span>
<span id="cb25-406"><a href="#cb25-406" aria-hidden="true" tabindex="-1"></a><span class="in">        names_to = "Wave",</span></span>
<span id="cb25-407"><a href="#cb25-407" aria-hidden="true" tabindex="-1"></a><span class="in">        values_to = "Score"</span></span>
<span id="cb25-408"><a href="#cb25-408" aria-hidden="true" tabindex="-1"></a><span class="in">      ) |&gt;</span></span>
<span id="cb25-409"><a href="#cb25-409" aria-hidden="true" tabindex="-1"></a><span class="in">      mutate(</span></span>
<span id="cb25-410"><a href="#cb25-410" aria-hidden="true" tabindex="-1"></a><span class="in">        Wave = stringr::str_replace(Wave, "cog_score_", ""),</span></span>
<span id="cb25-411"><a href="#cb25-411" aria-hidden="true" tabindex="-1"></a><span class="in">        Wave = factor(</span></span>
<span id="cb25-412"><a href="#cb25-412" aria-hidden="true" tabindex="-1"></a><span class="in">          Wave, </span></span>
<span id="cb25-413"><a href="#cb25-413" aria-hidden="true" tabindex="-1"></a><span class="in">          levels = c("2016", "2018", "2020", "2022"),</span></span>
<span id="cb25-414"><a href="#cb25-414" aria-hidden="true" tabindex="-1"></a><span class="in">          labels = c(1, 2, 3, 4)),</span></span>
<span id="cb25-415"><a href="#cb25-415" aria-hidden="true" tabindex="-1"></a><span class="in">        </span></span>
<span id="cb25-416"><a href="#cb25-416" aria-hidden="true" tabindex="-1"></a><span class="in">        Gender = as.factor(Gender),</span></span>
<span id="cb25-417"><a href="#cb25-417" aria-hidden="true" tabindex="-1"></a><span class="in">        Education_tri = as.factor(Education_tri)</span></span>
<span id="cb25-418"><a href="#cb25-418" aria-hidden="true" tabindex="-1"></a><span class="in">      ) |&gt;</span></span>
<span id="cb25-419"><a href="#cb25-419" aria-hidden="true" tabindex="-1"></a><span class="in">      select(!any_of(c(</span></span>
<span id="cb25-420"><a href="#cb25-420" aria-hidden="true" tabindex="-1"></a><span class="in">        paste0("Cardio_risk_", 16:22), </span></span>
<span id="cb25-421"><a href="#cb25-421" aria-hidden="true" tabindex="-1"></a><span class="in">        paste0("Total_dep_20", 16:22))</span></span>
<span id="cb25-422"><a href="#cb25-422" aria-hidden="true" tabindex="-1"></a><span class="in">      ))</span></span>
<span id="cb25-423"><a href="#cb25-423" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb25-424"><a href="#cb25-424" aria-hidden="true" tabindex="-1"></a><span class="in">    # Combine cardio and cog total data</span></span>
<span id="cb25-425"><a href="#cb25-425" aria-hidden="true" tabindex="-1"></a><span class="in">    final_data &lt;- data_score |&gt;</span></span>
<span id="cb25-426"><a href="#cb25-426" aria-hidden="true" tabindex="-1"></a><span class="in">      mutate(Cardio_risk = data_cardio$Cardio_risk, .after = Education_tri) |&gt;</span></span>
<span id="cb25-427"><a href="#cb25-427" aria-hidden="true" tabindex="-1"></a><span class="in">      mutate(Depression = data_dep$Depression_score, .after = Cardio_risk)</span></span>
<span id="cb25-428"><a href="#cb25-428" aria-hidden="true" tabindex="-1"></a><span class="in">    }</span></span>
<span id="cb25-429"><a href="#cb25-429" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-430"><a href="#cb25-430" aria-hidden="true" tabindex="-1"></a><span class="in">  return(final_data)</span></span>
<span id="cb25-431"><a href="#cb25-431" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb25-432"><a href="#cb25-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-433"><a href="#cb25-433" aria-hidden="true" tabindex="-1"></a><span class="in">gentleman_test &lt;- function(data, model) {</span></span>
<span id="cb25-434"><a href="#cb25-434" aria-hidden="true" tabindex="-1"></a><span class="in">  # Compares observed and expected prevalence of cognitive states (Normal Cognition, MCI, Dementia)</span></span>
<span id="cb25-435"><a href="#cb25-435" aria-hidden="true" tabindex="-1"></a><span class="in">  # over time. Reshapes the observed and expected data into a long format and generates a</span></span>
<span id="cb25-436"><a href="#cb25-436" aria-hidden="true" tabindex="-1"></a><span class="in">  # faceted line plot to visualize the comparison.</span></span>
<span id="cb25-437"><a href="#cb25-437" aria-hidden="true" tabindex="-1"></a><span class="in">  # Arguments:</span></span>
<span id="cb25-438"><a href="#cb25-438" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - data: A list containing observed and expected prevalence data.</span></span>
<span id="cb25-439"><a href="#cb25-439" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - model: A string representing the model name, used in the plot title.</span></span>
<span id="cb25-440"><a href="#cb25-440" aria-hidden="true" tabindex="-1"></a><span class="in">  # Returns:</span></span>
<span id="cb25-441"><a href="#cb25-441" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - A ggplot object displaying the observed vs. expected prevalence of cognitive states</span></span>
<span id="cb25-442"><a href="#cb25-442" aria-hidden="true" tabindex="-1"></a><span class="in">  #     over time.</span></span>
<span id="cb25-443"><a href="#cb25-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-444"><a href="#cb25-444" aria-hidden="true" tabindex="-1"></a><span class="in">  # Reshaping observed prevalence</span></span>
<span id="cb25-445"><a href="#cb25-445" aria-hidden="true" tabindex="-1"></a><span class="in">  do1 &lt;- as_tibble(row.names(data$Observed)) |&gt;</span></span>
<span id="cb25-446"><a href="#cb25-446" aria-hidden="true" tabindex="-1"></a><span class="in">    rename(time = value) |&gt;</span></span>
<span id="cb25-447"><a href="#cb25-447" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(time = as.numeric(time))</span></span>
<span id="cb25-448"><a href="#cb25-448" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-449"><a href="#cb25-449" aria-hidden="true" tabindex="-1"></a><span class="in">  do2 &lt;- as_tibble(data$Observed) |&gt; </span></span>
<span id="cb25-450"><a href="#cb25-450" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(type = "observed")</span></span>
<span id="cb25-451"><a href="#cb25-451" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-452"><a href="#cb25-452" aria-hidden="true" tabindex="-1"></a><span class="in">  do &lt;- cbind(do1, do2) |&gt;</span></span>
<span id="cb25-453"><a href="#cb25-453" aria-hidden="true" tabindex="-1"></a><span class="in">    select(-Total) |&gt;</span></span>
<span id="cb25-454"><a href="#cb25-454" aria-hidden="true" tabindex="-1"></a><span class="in">    tidyr::gather(state, number, -c(time, type)) |&gt;</span></span>
<span id="cb25-455"><a href="#cb25-455" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(state = case_when(state == "State 1" ~ "Normal Cognition",</span></span>
<span id="cb25-456"><a href="#cb25-456" aria-hidden="true" tabindex="-1"></a><span class="in">                             state == "State 2" ~ "MCI",</span></span>
<span id="cb25-457"><a href="#cb25-457" aria-hidden="true" tabindex="-1"></a><span class="in">                             state == "State 3" ~ "Dementia"))</span></span>
<span id="cb25-458"><a href="#cb25-458" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-459"><a href="#cb25-459" aria-hidden="true" tabindex="-1"></a><span class="in">  # Reshaping expected prevalence</span></span>
<span id="cb25-460"><a href="#cb25-460" aria-hidden="true" tabindex="-1"></a><span class="in">  de1 &lt;- as_tibble(row.names(data$Expected)) |&gt;</span></span>
<span id="cb25-461"><a href="#cb25-461" aria-hidden="true" tabindex="-1"></a><span class="in">    rename(time = value) |&gt;</span></span>
<span id="cb25-462"><a href="#cb25-462" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(time = as.numeric(time))</span></span>
<span id="cb25-463"><a href="#cb25-463" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-464"><a href="#cb25-464" aria-hidden="true" tabindex="-1"></a><span class="in">  de2 &lt;- as_tibble(data$Expected) |&gt;</span></span>
<span id="cb25-465"><a href="#cb25-465" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(type = "expected")</span></span>
<span id="cb25-466"><a href="#cb25-466" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-467"><a href="#cb25-467" aria-hidden="true" tabindex="-1"></a><span class="in">  de &lt;- cbind(de1,de2) |&gt;</span></span>
<span id="cb25-468"><a href="#cb25-468" aria-hidden="true" tabindex="-1"></a><span class="in">    select(-Total) |&gt;</span></span>
<span id="cb25-469"><a href="#cb25-469" aria-hidden="true" tabindex="-1"></a><span class="in">    tidyr::gather(state, number, -c(time, type))</span></span>
<span id="cb25-470"><a href="#cb25-470" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-471"><a href="#cb25-471" aria-hidden="true" tabindex="-1"></a><span class="in">  # Turn into single data frame and plotting</span></span>
<span id="cb25-472"><a href="#cb25-472" aria-hidden="true" tabindex="-1"></a><span class="in">  rbind(do, de) |&gt;</span></span>
<span id="cb25-473"><a href="#cb25-473" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(type = factor(type),</span></span>
<span id="cb25-474"><a href="#cb25-474" aria-hidden="true" tabindex="-1"></a><span class="in">           state = factor(state, levels = c("Normal Cognition", "MCI", "Dementia")),</span></span>
<span id="cb25-475"><a href="#cb25-475" aria-hidden="true" tabindex="-1"></a><span class="in">           time = round(time,3)) |&gt;</span></span>
<span id="cb25-476"><a href="#cb25-476" aria-hidden="true" tabindex="-1"></a><span class="in">    group_by(state) |&gt;</span></span>
<span id="cb25-477"><a href="#cb25-477" aria-hidden="true" tabindex="-1"></a><span class="in">    ggplot(aes(x = time, y = number, colour = type)) +</span></span>
<span id="cb25-478"><a href="#cb25-478" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_line(linewidth = 1) +</span></span>
<span id="cb25-479"><a href="#cb25-479" aria-hidden="true" tabindex="-1"></a><span class="in">    labs(title = paste0("Observed vs Fitted Values: ", model), x = "Time", y = "") +</span></span>
<span id="cb25-480"><a href="#cb25-480" aria-hidden="true" tabindex="-1"></a><span class="in">    facet_wrap(~ state) +</span></span>
<span id="cb25-481"><a href="#cb25-481" aria-hidden="true" tabindex="-1"></a><span class="in">    theme_bw() +</span></span>
<span id="cb25-482"><a href="#cb25-482" aria-hidden="true" tabindex="-1"></a><span class="in">    ggeasy::easy_remove_legend_title()</span></span>
<span id="cb25-483"><a href="#cb25-483" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb25-484"><a href="#cb25-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-485"><a href="#cb25-485" aria-hidden="true" tabindex="-1"></a><span class="in">process_hr &lt;- function(data, fix_upper = TRUE) {</span></span>
<span id="cb25-486"><a href="#cb25-486" aria-hidden="true" tabindex="-1"></a><span class="in">  # Processes hazard ratio (HR) data by cleaning and reshaping it for visualization.</span></span>
<span id="cb25-487"><a href="#cb25-487" aria-hidden="true" tabindex="-1"></a><span class="in">  # Converts covariate names into descriptive labels and ensures proper formatting</span></span>
<span id="cb25-488"><a href="#cb25-488" aria-hidden="true" tabindex="-1"></a><span class="in">  # of transitions and confidence intervals. Optionally fixes upper confidence intervals</span></span>
<span id="cb25-489"><a href="#cb25-489" aria-hidden="true" tabindex="-1"></a><span class="in">  # that exceed a specified threshold.</span></span>
<span id="cb25-490"><a href="#cb25-490" aria-hidden="true" tabindex="-1"></a><span class="in">  # Arguments:</span></span>
<span id="cb25-491"><a href="#cb25-491" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - data: The input dataset containing hazard ratio data.</span></span>
<span id="cb25-492"><a href="#cb25-492" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - fix_upper: A logical flag indicating whether to fix upper confidence intervals</span></span>
<span id="cb25-493"><a href="#cb25-493" aria-hidden="true" tabindex="-1"></a><span class="in">  #                that exceed a threshold (default: TRUE).</span></span>
<span id="cb25-494"><a href="#cb25-494" aria-hidden="true" tabindex="-1"></a><span class="in">  # Returns:</span></span>
<span id="cb25-495"><a href="#cb25-495" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - A cleaned and reshaped dataset ready for hazard ratio visualization.</span></span>
<span id="cb25-496"><a href="#cb25-496" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-497"><a href="#cb25-497" aria-hidden="true" tabindex="-1"></a><span class="in">  data &lt;- do.call(rbind.data.frame, data) |&gt;</span></span>
<span id="cb25-498"><a href="#cb25-498" aria-hidden="true" tabindex="-1"></a><span class="in">    tibble::rownames_to_column(var = "Covariate") |&gt;</span></span>
<span id="cb25-499"><a href="#cb25-499" aria-hidden="true" tabindex="-1"></a><span class="in">    tidyr::separate_wider_delim(cols = Covariate, </span></span>
<span id="cb25-500"><a href="#cb25-500" aria-hidden="true" tabindex="-1"></a><span class="in">                                delim = ".", </span></span>
<span id="cb25-501"><a href="#cb25-501" aria-hidden="true" tabindex="-1"></a><span class="in">                                names = c("Covariate", "Transition")) |&gt;</span></span>
<span id="cb25-502"><a href="#cb25-502" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(Covariate = case_when(</span></span>
<span id="cb25-503"><a href="#cb25-503" aria-hidden="true" tabindex="-1"></a><span class="in">      Covariate == "Gender1" ~ "Female",</span></span>
<span id="cb25-504"><a href="#cb25-504" aria-hidden="true" tabindex="-1"></a><span class="in">      Covariate == "Education_tri1" ~ "High School",</span></span>
<span id="cb25-505"><a href="#cb25-505" aria-hidden="true" tabindex="-1"></a><span class="in">      Covariate == "Education_tri2" ~ "College",</span></span>
<span id="cb25-506"><a href="#cb25-506" aria-hidden="true" tabindex="-1"></a><span class="in">      Covariate == "Cardio_risk" ~ "Cardiovascular Risk",</span></span>
<span id="cb25-507"><a href="#cb25-507" aria-hidden="true" tabindex="-1"></a><span class="in">      Covariate == "Depression" ~ "Depression",</span></span>
<span id="cb25-508"><a href="#cb25-508" aria-hidden="true" tabindex="-1"></a><span class="in">      Covariate == "Total_p" ~ "Total Procrastination",</span></span>
<span id="cb25-509"><a href="#cb25-509" aria-hidden="true" tabindex="-1"></a><span class="in">      Covariate == "Depression:Total_p" ~ "Depression x Procrastination",</span></span>
<span id="cb25-510"><a href="#cb25-510" aria-hidden="true" tabindex="-1"></a><span class="in">      TRUE ~ Covariate),</span></span>
<span id="cb25-511"><a href="#cb25-511" aria-hidden="true" tabindex="-1"></a><span class="in">      </span></span>
<span id="cb25-512"><a href="#cb25-512" aria-hidden="true" tabindex="-1"></a><span class="in">      Covariate = factor(</span></span>
<span id="cb25-513"><a href="#cb25-513" aria-hidden="true" tabindex="-1"></a><span class="in">        Covariate, </span></span>
<span id="cb25-514"><a href="#cb25-514" aria-hidden="true" tabindex="-1"></a><span class="in">        levels = c("Female", "Age", "High School", "College", </span></span>
<span id="cb25-515"><a href="#cb25-515" aria-hidden="true" tabindex="-1"></a><span class="in">                   "Cardiovascular Risk", "Depression", </span></span>
<span id="cb25-516"><a href="#cb25-516" aria-hidden="true" tabindex="-1"></a><span class="in">                   "Total Procrastination", "Depression x Procrastination"))</span></span>
<span id="cb25-517"><a href="#cb25-517" aria-hidden="true" tabindex="-1"></a><span class="in">      ) |&gt;</span></span>
<span id="cb25-518"><a href="#cb25-518" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(Transition = factor(</span></span>
<span id="cb25-519"><a href="#cb25-519" aria-hidden="true" tabindex="-1"></a><span class="in">      Transition, </span></span>
<span id="cb25-520"><a href="#cb25-520" aria-hidden="true" tabindex="-1"></a><span class="in">      levels = c("Normal Cognition - MCI", </span></span>
<span id="cb25-521"><a href="#cb25-521" aria-hidden="true" tabindex="-1"></a><span class="in">                 "Normal Cognition - Dementia",</span></span>
<span id="cb25-522"><a href="#cb25-522" aria-hidden="true" tabindex="-1"></a><span class="in">                 "MCI - Normal Cognition",</span></span>
<span id="cb25-523"><a href="#cb25-523" aria-hidden="true" tabindex="-1"></a><span class="in">                 "MCI - Dementia")))</span></span>
<span id="cb25-524"><a href="#cb25-524" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-525"><a href="#cb25-525" aria-hidden="true" tabindex="-1"></a><span class="in">  if(fix_upper == TRUE){</span></span>
<span id="cb25-526"><a href="#cb25-526" aria-hidden="true" tabindex="-1"></a><span class="in">    data &lt;- data |&gt;</span></span>
<span id="cb25-527"><a href="#cb25-527" aria-hidden="true" tabindex="-1"></a><span class="in">      mutate(U = case_when(</span></span>
<span id="cb25-528"><a href="#cb25-528" aria-hidden="true" tabindex="-1"></a><span class="in">        U &gt;= 5 &amp; Transition == "Normal Cognition - Dementia" ~ HR,</span></span>
<span id="cb25-529"><a href="#cb25-529" aria-hidden="true" tabindex="-1"></a><span class="in">        # U &gt;= 5 &amp; HR &lt; 1 ~ 1,</span></span>
<span id="cb25-530"><a href="#cb25-530" aria-hidden="true" tabindex="-1"></a><span class="in">        TRUE ~ U</span></span>
<span id="cb25-531"><a href="#cb25-531" aria-hidden="true" tabindex="-1"></a><span class="in">      ))</span></span>
<span id="cb25-532"><a href="#cb25-532" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb25-533"><a href="#cb25-533" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-534"><a href="#cb25-534" aria-hidden="true" tabindex="-1"></a><span class="in">  return(data)</span></span>
<span id="cb25-535"><a href="#cb25-535" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb25-536"><a href="#cb25-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-537"><a href="#cb25-537" aria-hidden="true" tabindex="-1"></a><span class="in">calculate_p_value &lt;- function(data) {</span></span>
<span id="cb25-538"><a href="#cb25-538" aria-hidden="true" tabindex="-1"></a><span class="in">  # Calculates p-values for hazard ratios (HR) based on log-transformed HR values and</span></span>
<span id="cb25-539"><a href="#cb25-539" aria-hidden="true" tabindex="-1"></a><span class="in">  # their confidence intervals. Adds the calculated p-values to the input dataset.</span></span>
<span id="cb25-540"><a href="#cb25-540" aria-hidden="true" tabindex="-1"></a><span class="in">  # Arguments:</span></span>
<span id="cb25-541"><a href="#cb25-541" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - data: The input dataset containing hazard ratios and confidence intervals.</span></span>
<span id="cb25-542"><a href="#cb25-542" aria-hidden="true" tabindex="-1"></a><span class="in">  # Returns:</span></span>
<span id="cb25-543"><a href="#cb25-543" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - The input dataset with an additional column for p-values</span></span>
<span id="cb25-544"><a href="#cb25-544" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-545"><a href="#cb25-545" aria-hidden="true" tabindex="-1"></a><span class="in">  log_HR &lt;- log(data$HR)</span></span>
<span id="cb25-546"><a href="#cb25-546" aria-hidden="true" tabindex="-1"></a><span class="in">  log_lower_CI &lt;- log(data$L)</span></span>
<span id="cb25-547"><a href="#cb25-547" aria-hidden="true" tabindex="-1"></a><span class="in">  log_upper_CI &lt;- log(data$U)</span></span>
<span id="cb25-548"><a href="#cb25-548" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-549"><a href="#cb25-549" aria-hidden="true" tabindex="-1"></a><span class="in">  SE &lt;- (log_upper_CI - log_lower_CI) / (2 * 1.96)</span></span>
<span id="cb25-550"><a href="#cb25-550" aria-hidden="true" tabindex="-1"></a><span class="in">  Z &lt;- log_HR / SE</span></span>
<span id="cb25-551"><a href="#cb25-551" aria-hidden="true" tabindex="-1"></a><span class="in">  p_value &lt;- 2 * (1 - pnorm(abs(Z)))</span></span>
<span id="cb25-552"><a href="#cb25-552" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-553"><a href="#cb25-553" aria-hidden="true" tabindex="-1"></a><span class="in">  data$pval &lt;- p_value |&gt; round(digits = 3)</span></span>
<span id="cb25-554"><a href="#cb25-554" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-555"><a href="#cb25-555" aria-hidden="true" tabindex="-1"></a><span class="in">  return(data)</span></span>
<span id="cb25-556"><a href="#cb25-556" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb25-557"><a href="#cb25-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-558"><a href="#cb25-558" aria-hidden="true" tabindex="-1"></a><span class="in">plot_hr &lt;- function(data) {</span></span>
<span id="cb25-559"><a href="#cb25-559" aria-hidden="true" tabindex="-1"></a><span class="in">  # Generates a forest plot of hazard ratios (HR) for cognitive transitions, including</span></span>
<span id="cb25-560"><a href="#cb25-560" aria-hidden="true" tabindex="-1"></a><span class="in">  # confidence intervals and significance stars. Customizes the plot based on covariate</span></span>
<span id="cb25-561"><a href="#cb25-561" aria-hidden="true" tabindex="-1"></a><span class="in">  # labels and ensures proper formatting for visualization.</span></span>
<span id="cb25-562"><a href="#cb25-562" aria-hidden="true" tabindex="-1"></a><span class="in">  # Arguments:</span></span>
<span id="cb25-563"><a href="#cb25-563" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - data: The input dataset containing hazard ratios, confidence intervals, and p-values.</span></span>
<span id="cb25-564"><a href="#cb25-564" aria-hidden="true" tabindex="-1"></a><span class="in">  # Returns:</span></span>
<span id="cb25-565"><a href="#cb25-565" aria-hidden="true" tabindex="-1"></a><span class="in">  #   - A ggplot object displaying hazard ratios for cognitive transitions, faceted by covariate.</span></span>
<span id="cb25-566"><a href="#cb25-566" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-567"><a href="#cb25-567" aria-hidden="true" tabindex="-1"></a><span class="in">  # Making a plot customization</span></span>
<span id="cb25-568"><a href="#cb25-568" aria-hidden="true" tabindex="-1"></a><span class="in">  labeller &lt;- c(</span></span>
<span id="cb25-569"><a href="#cb25-569" aria-hidden="true" tabindex="-1"></a><span class="in">    Female = "Being female vs. Male",</span></span>
<span id="cb25-570"><a href="#cb25-570" aria-hidden="true" tabindex="-1"></a><span class="in">    `High School` = "Having a highshool education vs. No education",</span></span>
<span id="cb25-571"><a href="#cb25-571" aria-hidden="true" tabindex="-1"></a><span class="in">    College = "Having a further education vs. No education",</span></span>
<span id="cb25-572"><a href="#cb25-572" aria-hidden="true" tabindex="-1"></a><span class="in">    `Cardiovascular Risk` = "Total number of cardiovascular risk factors",</span></span>
<span id="cb25-573"><a href="#cb25-573" aria-hidden="true" tabindex="-1"></a><span class="in">    Depression = "Depression",</span></span>
<span id="cb25-574"><a href="#cb25-574" aria-hidden="true" tabindex="-1"></a><span class="in">    Total_p = "Procrastination",</span></span>
<span id="cb25-575"><a href="#cb25-575" aria-hidden="true" tabindex="-1"></a><span class="in">    `Depression x Procrastination` = "Depression x Procrastination"</span></span>
<span id="cb25-576"><a href="#cb25-576" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb25-577"><a href="#cb25-577" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-578"><a href="#cb25-578" aria-hidden="true" tabindex="-1"></a><span class="in">  # Add a column for significance stars</span></span>
<span id="cb25-579"><a href="#cb25-579" aria-hidden="true" tabindex="-1"></a><span class="in">  data &lt;- data |&gt;</span></span>
<span id="cb25-580"><a href="#cb25-580" aria-hidden="true" tabindex="-1"></a><span class="in">    mutate(</span></span>
<span id="cb25-581"><a href="#cb25-581" aria-hidden="true" tabindex="-1"></a><span class="in">      stars = case_when(</span></span>
<span id="cb25-582"><a href="#cb25-582" aria-hidden="true" tabindex="-1"></a><span class="in">        pval &lt; 0.001 ~ "***",</span></span>
<span id="cb25-583"><a href="#cb25-583" aria-hidden="true" tabindex="-1"></a><span class="in">        pval &lt; 0.01 ~ "**",</span></span>
<span id="cb25-584"><a href="#cb25-584" aria-hidden="true" tabindex="-1"></a><span class="in">        pval &lt; 0.05 ~ "*",</span></span>
<span id="cb25-585"><a href="#cb25-585" aria-hidden="true" tabindex="-1"></a><span class="in">        pval &lt; 0.10 ~ "+",</span></span>
<span id="cb25-586"><a href="#cb25-586" aria-hidden="true" tabindex="-1"></a><span class="in">        TRUE ~ "" </span></span>
<span id="cb25-587"><a href="#cb25-587" aria-hidden="true" tabindex="-1"></a><span class="in">      ))</span></span>
<span id="cb25-588"><a href="#cb25-588" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-589"><a href="#cb25-589" aria-hidden="true" tabindex="-1"></a><span class="in">  # Plotting  </span></span>
<span id="cb25-590"><a href="#cb25-590" aria-hidden="true" tabindex="-1"></a><span class="in">  haz_plot &lt;- data |&gt;</span></span>
<span id="cb25-591"><a href="#cb25-591" aria-hidden="true" tabindex="-1"></a><span class="in">    ggplot(aes(x = HR, y = forcats::fct_rev(Transition), colour = HR &gt; 1)) +</span></span>
<span id="cb25-592"><a href="#cb25-592" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_point(size = 4) +</span></span>
<span id="cb25-593"><a href="#cb25-593" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_linerange(aes(xmin = L, xmax = U), linewidth = 1.5, alpha = 0.5) +</span></span>
<span id="cb25-594"><a href="#cb25-594" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_vline(xintercept = 1, colour = "gray75", linewidth = 0.75, linetype = "dashed") +</span></span>
<span id="cb25-595"><a href="#cb25-595" aria-hidden="true" tabindex="-1"></a><span class="in">    geom_text(aes(label = stars), vjust = -0.5, hjust = 0.5, size = 5, color = "black") +</span></span>
<span id="cb25-596"><a href="#cb25-596" aria-hidden="true" tabindex="-1"></a><span class="in">    labs(title = "Hazard Ratio for dementia transitions",</span></span>
<span id="cb25-597"><a href="#cb25-597" aria-hidden="true" tabindex="-1"></a><span class="in">         x = "Hazard Ratio (95% Confidence Interval)", </span></span>
<span id="cb25-598"><a href="#cb25-598" aria-hidden="true" tabindex="-1"></a><span class="in">         y = "") +</span></span>
<span id="cb25-599"><a href="#cb25-599" aria-hidden="true" tabindex="-1"></a><span class="in">    scale_color_manual(values = c("#E69F00", "#56B4E9"), guide = "none") +</span></span>
<span id="cb25-600"><a href="#cb25-600" aria-hidden="true" tabindex="-1"></a><span class="in">    guides(colour = "none") +</span></span>
<span id="cb25-601"><a href="#cb25-601" aria-hidden="true" tabindex="-1"></a><span class="in">    theme_bw() +</span></span>
<span id="cb25-602"><a href="#cb25-602" aria-hidden="true" tabindex="-1"></a><span class="in">    theme(</span></span>
<span id="cb25-603"><a href="#cb25-603" aria-hidden="true" tabindex="-1"></a><span class="in">      plot.title = element_text(hjust = 0.5, size = 14, face = "bold"),</span></span>
<span id="cb25-604"><a href="#cb25-604" aria-hidden="true" tabindex="-1"></a><span class="in">      axis.title.x = element_text(size = 12),</span></span>
<span id="cb25-605"><a href="#cb25-605" aria-hidden="true" tabindex="-1"></a><span class="in">      strip.text = element_text(size = 10)</span></span>
<span id="cb25-606"><a href="#cb25-606" aria-hidden="true" tabindex="-1"></a><span class="in">      )</span></span>
<span id="cb25-607"><a href="#cb25-607" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-608"><a href="#cb25-608" aria-hidden="true" tabindex="-1"></a><span class="in">  if(nrow(data) == 32){</span></span>
<span id="cb25-609"><a href="#cb25-609" aria-hidden="true" tabindex="-1"></a><span class="in">  # Centering the bottom facet because I am pedantic</span></span>
<span id="cb25-610"><a href="#cb25-610" aria-hidden="true" tabindex="-1"></a><span class="in">    haz_plot &lt;- haz_plot + ggh4x::facet_manual(</span></span>
<span id="cb25-611"><a href="#cb25-611" aria-hidden="true" tabindex="-1"></a><span class="in">    ~ Covariate,</span></span>
<span id="cb25-612"><a href="#cb25-612" aria-hidden="true" tabindex="-1"></a><span class="in">    scales = "free_x",</span></span>
<span id="cb25-613"><a href="#cb25-613" aria-hidden="true" tabindex="-1"></a><span class="in">    labeller = labeller(Covariate = labeller),</span></span>
<span id="cb25-614"><a href="#cb25-614" aria-hidden="true" tabindex="-1"></a><span class="in">    design = c(</span></span>
<span id="cb25-615"><a href="#cb25-615" aria-hidden="true" tabindex="-1"></a><span class="in">    "</span></span>
<span id="cb25-616"><a href="#cb25-616" aria-hidden="true" tabindex="-1"></a><span class="in">    AABBCC</span></span>
<span id="cb25-617"><a href="#cb25-617" aria-hidden="true" tabindex="-1"></a><span class="in">    DDEEFF</span></span>
<span id="cb25-618"><a href="#cb25-618" aria-hidden="true" tabindex="-1"></a><span class="in">    #GGHH#</span></span>
<span id="cb25-619"><a href="#cb25-619" aria-hidden="true" tabindex="-1"></a><span class="in">    "</span></span>
<span id="cb25-620"><a href="#cb25-620" aria-hidden="true" tabindex="-1"></a><span class="in">    ))</span></span>
<span id="cb25-621"><a href="#cb25-621" aria-hidden="true" tabindex="-1"></a><span class="in">  } else {</span></span>
<span id="cb25-622"><a href="#cb25-622" aria-hidden="true" tabindex="-1"></a><span class="in">    # Centering the bottom facet because I am pedantic</span></span>
<span id="cb25-623"><a href="#cb25-623" aria-hidden="true" tabindex="-1"></a><span class="in">    haz_plot &lt;- haz_plot + ggh4x::facet_manual(</span></span>
<span id="cb25-624"><a href="#cb25-624" aria-hidden="true" tabindex="-1"></a><span class="in">      ~ Covariate,</span></span>
<span id="cb25-625"><a href="#cb25-625" aria-hidden="true" tabindex="-1"></a><span class="in">      scales = "free_x",</span></span>
<span id="cb25-626"><a href="#cb25-626" aria-hidden="true" tabindex="-1"></a><span class="in">      labeller = labeller(Covariate = labeller),</span></span>
<span id="cb25-627"><a href="#cb25-627" aria-hidden="true" tabindex="-1"></a><span class="in">      design = c(</span></span>
<span id="cb25-628"><a href="#cb25-628" aria-hidden="true" tabindex="-1"></a><span class="in">      "</span></span>
<span id="cb25-629"><a href="#cb25-629" aria-hidden="true" tabindex="-1"></a><span class="in">      AABBCC</span></span>
<span id="cb25-630"><a href="#cb25-630" aria-hidden="true" tabindex="-1"></a><span class="in">      DDEEFF</span></span>
<span id="cb25-631"><a href="#cb25-631" aria-hidden="true" tabindex="-1"></a><span class="in">      ##GG##</span></span>
<span id="cb25-632"><a href="#cb25-632" aria-hidden="true" tabindex="-1"></a><span class="in">      "</span></span>
<span id="cb25-633"><a href="#cb25-633" aria-hidden="true" tabindex="-1"></a><span class="in">      ))</span></span>
<span id="cb25-634"><a href="#cb25-634" aria-hidden="true" tabindex="-1"></a><span class="in">  }</span></span>
<span id="cb25-635"><a href="#cb25-635" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb25-636"><a href="#cb25-636" aria-hidden="true" tabindex="-1"></a><span class="in">  return(haz_plot)</span></span>
<span id="cb25-637"><a href="#cb25-637" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb25-638"><a href="#cb25-638" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-639"><a href="#cb25-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-640"><a href="#cb25-640" aria-hidden="true" tabindex="-1"></a><span class="fu">## Reading in data</span></span>
<span id="cb25-641"><a href="#cb25-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-642"><a href="#cb25-642" aria-hidden="true" tabindex="-1"></a><span class="in">```{r data}</span></span>
<span id="cb25-643"><a href="#cb25-643" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(34521)</span></span>
<span id="cb25-644"><a href="#cb25-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-645"><a href="#cb25-645" aria-hidden="true" tabindex="-1"></a><span class="in">data &lt;- read.csv(here::here("analysis/data/data.csv")) </span></span>
<span id="cb25-646"><a href="#cb25-646" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-647"><a href="#cb25-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-648"><a href="#cb25-648" aria-hidden="true" tabindex="-1"></a><span class="fu"># Markov Modelling</span></span>
<span id="cb25-649"><a href="#cb25-649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-650"><a href="#cb25-650" aria-hidden="true" tabindex="-1"></a>In this section, we apply Markov modelling to analyze the transitions between cognitive states (Normal Cognition, Mild Cognitive Impairment <span class="co">[</span><span class="ot">MCI</span><span class="co">]</span>, and Dementia) using longitudinal data from the Health and Retirement Study (HRS) from 2016 to 2022. By modeling these transitions, we aim to understand the probabilities of moving between different cognitive states over time.</span>
<span id="cb25-651"><a href="#cb25-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-652"><a href="#cb25-652" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data preparation</span></span>
<span id="cb25-653"><a href="#cb25-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-654"><a href="#cb25-654" aria-hidden="true" tabindex="-1"></a>The first step is to prepare the transition dataset. We start by transforming the data to create a record of transitions from one cognitive state to another between consecutive waves.</span>
<span id="cb25-655"><a href="#cb25-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-656"><a href="#cb25-656" aria-hidden="true" tabindex="-1"></a>Once the transitions are identified, we calculate the probabilities of each state-to-state transition. These probabilities are computed by counting the occurrences of each transition and dividing by the total number of transitions.</span>
<span id="cb25-657"><a href="#cb25-657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-658"><a href="#cb25-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-659"><a href="#cb25-659" aria-hidden="true" tabindex="-1"></a><span class="in">```{r transition-probability}</span></span>
<span id="cb25-660"><a href="#cb25-660" aria-hidden="true" tabindex="-1"></a><span class="in">tran_prob &lt;- data |&gt;</span></span>
<span id="cb25-661"><a href="#cb25-661" aria-hidden="true" tabindex="-1"></a><span class="in">  extract_years(years = seq(2016, 2022, by = 2)) |&gt;</span></span>
<span id="cb25-662"><a href="#cb25-662" aria-hidden="true" tabindex="-1"></a><span class="in">  create_transitions(absorbing = TRUE) |&gt;</span></span>
<span id="cb25-663"><a href="#cb25-663" aria-hidden="true" tabindex="-1"></a><span class="in">  calculate_probabilties()</span></span>
<span id="cb25-664"><a href="#cb25-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-665"><a href="#cb25-665" aria-hidden="true" tabindex="-1"></a><span class="in">tran_prob |&gt;</span></span>
<span id="cb25-666"><a href="#cb25-666" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(prop = round(prop, digits = 3)) |&gt;</span></span>
<span id="cb25-667"><a href="#cb25-667" aria-hidden="true" tabindex="-1"></a><span class="in">  head(n = 9) |&gt;</span></span>
<span id="cb25-668"><a href="#cb25-668" aria-hidden="true" tabindex="-1"></a><span class="in">  gt::gt() |&gt;</span></span>
<span id="cb25-669"><a href="#cb25-669" aria-hidden="true" tabindex="-1"></a><span class="in">  gtExtras::gt_theme_538() |&gt;</span></span>
<span id="cb25-670"><a href="#cb25-670" aria-hidden="true" tabindex="-1"></a><span class="in">  gt::cols_align(align = "center") |&gt;</span></span>
<span id="cb25-671"><a href="#cb25-671" aria-hidden="true" tabindex="-1"></a><span class="in">  gt::tab_header(title = "Overall Transition Probabilties (2016 - 2022)") |&gt;</span></span>
<span id="cb25-672"><a href="#cb25-672" aria-hidden="true" tabindex="-1"></a><span class="in">  gt::tab_options(table.width = gt::pct(100)) |&gt;</span></span>
<span id="cb25-673"><a href="#cb25-673" aria-hidden="true" tabindex="-1"></a><span class="in">  gt::opt_align_table_header(align = "center")</span></span>
<span id="cb25-674"><a href="#cb25-674" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-675"><a href="#cb25-675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-676"><a href="#cb25-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-677"><a href="#cb25-677" aria-hidden="true" tabindex="-1"></a><span class="fu">## Creating transition matrix</span></span>
<span id="cb25-678"><a href="#cb25-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-679"><a href="#cb25-679" aria-hidden="true" tabindex="-1"></a>The probability distribution of transitions from one state to another can be represented into a transition matrix $P = (p_{ij})_{i,j}$ where each element of position $(i, j)$ represents the transition probability $p_{ij}$. </span>
<span id="cb25-680"><a href="#cb25-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-681"><a href="#cb25-681" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-682"><a href="#cb25-682" aria-hidden="true" tabindex="-1"></a>P = \begin{bmatrix} </span>
<span id="cb25-683"><a href="#cb25-683" aria-hidden="true" tabindex="-1"></a>p_{11} &amp; p_{12} &amp; p_{13} <span class="sc">\\</span></span>
<span id="cb25-684"><a href="#cb25-684" aria-hidden="true" tabindex="-1"></a>p_{21} &amp; p_{22} &amp; p_{23} <span class="sc">\\</span></span>
<span id="cb25-685"><a href="#cb25-685" aria-hidden="true" tabindex="-1"></a>p_{31} &amp; p_{32} &amp; p_{33} <span class="sc">\\</span></span>
<span id="cb25-686"><a href="#cb25-686" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb25-687"><a href="#cb25-687" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-688"><a href="#cb25-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-689"><a href="#cb25-689" aria-hidden="true" tabindex="-1"></a><span class="in">```{r transition-matrix}</span></span>
<span id="cb25-690"><a href="#cb25-690" aria-hidden="true" tabindex="-1"></a><span class="in">tran_matrix &lt;- tran_prob |&gt;</span></span>
<span id="cb25-691"><a href="#cb25-691" aria-hidden="true" tabindex="-1"></a><span class="in">  transition_matrix() |&gt;</span></span>
<span id="cb25-692"><a href="#cb25-692" aria-hidden="true" tabindex="-1"></a><span class="in">  normalise() |&gt;</span></span>
<span id="cb25-693"><a href="#cb25-693" aria-hidden="true" tabindex="-1"></a><span class="in">  round(digits = 3)</span></span>
<span id="cb25-694"><a href="#cb25-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-695"><a href="#cb25-695" aria-hidden="true" tabindex="-1"></a><span class="in">tran_matrix</span></span>
<span id="cb25-696"><a href="#cb25-696" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-697"><a href="#cb25-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-698"><a href="#cb25-698" aria-hidden="true" tabindex="-1"></a>This code creates a $3 \times 3$ matrix (for the three states: Normal Cognition, MCI, and Dementia) and populates it with the transition probabilities. </span>
<span id="cb25-699"><a href="#cb25-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-700"><a href="#cb25-700" aria-hidden="true" tabindex="-1"></a><span class="fu">## Visualising the matrix</span></span>
<span id="cb25-701"><a href="#cb25-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-702"><a href="#cb25-702" aria-hidden="true" tabindex="-1"></a>To make the transition matrix more interpretable we visualize the probabilities using a heat map (@fig-transition-matrix)</span>
<span id="cb25-703"><a href="#cb25-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-704"><a href="#cb25-704" aria-hidden="true" tabindex="-1"></a><span class="in">```{r transition-matrix-plot}</span></span>
<span id="cb25-705"><a href="#cb25-705" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-width: 8</span></span>
<span id="cb25-706"><a href="#cb25-706" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-transition-matrix</span></span>
<span id="cb25-707"><a href="#cb25-707" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: Heat map of transition probabilities (2016 - 2022)</span></span>
<span id="cb25-708"><a href="#cb25-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-709"><a href="#cb25-709" aria-hidden="true" tabindex="-1"></a><span class="in">plot_matrix(data = t(tran_matrix), year = 2016)</span></span>
<span id="cb25-710"><a href="#cb25-710" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-711"><a href="#cb25-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-712"><a href="#cb25-712" aria-hidden="true" tabindex="-1"></a>We can also create and plot transition matrices for each wave separately allowing us to see how these transition probabilities change across multiple waves of data collection</span>
<span id="cb25-713"><a href="#cb25-713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-714"><a href="#cb25-714" aria-hidden="true" tabindex="-1"></a><span class="in">```{r transition-matrix-longitudinal}</span></span>
<span id="cb25-715"><a href="#cb25-715" aria-hidden="true" tabindex="-1"></a><span class="in">tran_prob_long &lt;- data |&gt;</span></span>
<span id="cb25-716"><a href="#cb25-716" aria-hidden="true" tabindex="-1"></a><span class="in">  extract_years(years = seq(2016, 2022, by = 2)) |&gt;</span></span>
<span id="cb25-717"><a href="#cb25-717" aria-hidden="true" tabindex="-1"></a><span class="in">  create_transitions(absorbing = TRUE) |&gt;</span></span>
<span id="cb25-718"><a href="#cb25-718" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(Wave) |&gt;</span></span>
<span id="cb25-719"><a href="#cb25-719" aria-hidden="true" tabindex="-1"></a><span class="in">  calculate_probabilties() |&gt;</span></span>
<span id="cb25-720"><a href="#cb25-720" aria-hidden="true" tabindex="-1"></a><span class="in">  group_map(~ transition_matrix(.x, longitudinal = TRUE), .keep = TRUE) |&gt;</span></span>
<span id="cb25-721"><a href="#cb25-721" aria-hidden="true" tabindex="-1"></a><span class="in">  lapply(function(mat) {</span></span>
<span id="cb25-722"><a href="#cb25-722" aria-hidden="true" tabindex="-1"></a><span class="in">    mat[c("Normal Cognition", "MCI", "Dementia"), c("Normal Cognition", "MCI", "Dementia")] |&gt;</span></span>
<span id="cb25-723"><a href="#cb25-723" aria-hidden="true" tabindex="-1"></a><span class="in">        normalise()</span></span>
<span id="cb25-724"><a href="#cb25-724" aria-hidden="true" tabindex="-1"></a><span class="in">    }) |&gt;</span></span>
<span id="cb25-725"><a href="#cb25-725" aria-hidden="true" tabindex="-1"></a><span class="in">  purrr::map2_df(.y = c(seq(2016, 2020, by = 2)), .f = reshape_matrix) |&gt;</span></span>
<span id="cb25-726"><a href="#cb25-726" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb25-727"><a href="#cb25-727" aria-hidden="true" tabindex="-1"></a><span class="in">    transition_prob = round(transition_prob, digits = 3),</span></span>
<span id="cb25-728"><a href="#cb25-728" aria-hidden="true" tabindex="-1"></a><span class="in">    from = factor(from, levels = c("Normal Cognition", "MCI", "Dementia"))</span></span>
<span id="cb25-729"><a href="#cb25-729" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb25-730"><a href="#cb25-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-731"><a href="#cb25-731" aria-hidden="true" tabindex="-1"></a><span class="in">DT::datatable(</span></span>
<span id="cb25-732"><a href="#cb25-732" aria-hidden="true" tabindex="-1"></a><span class="in">  tran_prob_long,</span></span>
<span id="cb25-733"><a href="#cb25-733" aria-hidden="true" tabindex="-1"></a><span class="in">  filter = "top",</span></span>
<span id="cb25-734"><a href="#cb25-734" aria-hidden="true" tabindex="-1"></a><span class="in">  colnames = c("Probability" = "transition_prob"),</span></span>
<span id="cb25-735"><a href="#cb25-735" aria-hidden="true" tabindex="-1"></a><span class="in">  options = list(pageLength = 6, autoWidth = TRUE)</span></span>
<span id="cb25-736"><a href="#cb25-736" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb25-737"><a href="#cb25-737" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-738"><a href="#cb25-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-739"><a href="#cb25-739" aria-hidden="true" tabindex="-1"></a><span class="in">```{r transition-matrix-longitudinal-plot, fig.width=8, fig.show="animate", ffmpeg.format="gif", dev="png"}</span></span>
<span id="cb25-740"><a href="#cb25-740" aria-hidden="true" tabindex="-1"></a><span class="in">for(wave in c(seq(2016, 2020, by = 2))){</span></span>
<span id="cb25-741"><a href="#cb25-741" aria-hidden="true" tabindex="-1"></a><span class="in">  print(plot_transition_wave(data = tran_prob_long, wave = wave))</span></span>
<span id="cb25-742"><a href="#cb25-742" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb25-743"><a href="#cb25-743" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-744"><a href="#cb25-744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-745"><a href="#cb25-745" aria-hidden="true" tabindex="-1"></a><span class="fu"># Multi-State Markov Model</span></span>
<span id="cb25-746"><a href="#cb25-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-747"><a href="#cb25-747" aria-hidden="true" tabindex="-1"></a>Now that we have an idea of the disease progression across time we are interested in the effect of different covariates on these transitions. For this, we can fit a multi-state Markov model. Multi-state models (MSMs) provide a comprehensive view of the disease process and make risk-factors analysis and long-term predictions more easily. The conditional distribution of the status of an individual participant at an arbitrary examination given their status at previous examinations was assumed to have the **Markov property**. That is the distribution of the forthcoming state $X_{n+1}$ depends only on the current state $X_n$ and doesn't depend on the previous ones $X_{n-1}, X_{n-2}, \dots, X_1$.</span>
<span id="cb25-748"><a href="#cb25-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-749"><a href="#cb25-749" aria-hidden="true" tabindex="-1"></a>$$Pr(X_{n+1} = x_{n+1} \; \vert \; X_1 = x_1, X_2 = x_2, \dots, X_n = x_n) = Pr(X_{n+1} = x_{n+1} \; \vert \; X_n = x_n)$$</span>
<span id="cb25-750"><a href="#cb25-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-751"><a href="#cb25-751" aria-hidden="true" tabindex="-1"></a><span class="fu">## Data preperation</span></span>
<span id="cb25-752"><a href="#cb25-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-753"><a href="#cb25-753" aria-hidden="true" tabindex="-1"></a>For our model we are going to look at several different covariates:</span>
<span id="cb25-754"><a href="#cb25-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-755"><a href="#cb25-755" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Gender**: $0 = \text{Male;} \; 1 = \text{Female}$ </span>
<span id="cb25-756"><a href="#cb25-756" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Age**: $\text{Range} \; = 50 - 91$ </span>
<span id="cb25-757"><a href="#cb25-757" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Education**: $0 = \text{No Degree;} \; 1 = \text{High School Degree;} \; 2 = \text{Further Education}$ </span>
<span id="cb25-758"><a href="#cb25-758" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Number of cardiovascular risk factors**: $\text{Range} \; = 0 - 4$</span>
<span id="cb25-759"><a href="#cb25-759" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**Procrastination**: $\text{Range} \; = 4 - 60$</span>
<span id="cb25-760"><a href="#cb25-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-761"><a href="#cb25-761" aria-hidden="true" tabindex="-1"></a><span class="in">```{r markov-prep}</span></span>
<span id="cb25-762"><a href="#cb25-762" aria-hidden="true" tabindex="-1"></a><span class="in">cols &lt;- c(</span></span>
<span id="cb25-763"><a href="#cb25-763" aria-hidden="true" tabindex="-1"></a><span class="in">  "ID", "Gender", "Age", "Education_tri", </span></span>
<span id="cb25-764"><a href="#cb25-764" aria-hidden="true" tabindex="-1"></a><span class="in">  paste0("Cardio_risk_", seq(16, 22, by = 2)), </span></span>
<span id="cb25-765"><a href="#cb25-765" aria-hidden="true" tabindex="-1"></a><span class="in">  paste0("Total_dep_20", seq(16, 22, by = 2)), "Total_p")</span></span>
<span id="cb25-766"><a href="#cb25-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-767"><a href="#cb25-767" aria-hidden="true" tabindex="-1"></a><span class="in">markov_data &lt;- data |&gt;</span></span>
<span id="cb25-768"><a href="#cb25-768" aria-hidden="true" tabindex="-1"></a><span class="in">  extract_years(seq(2016, 2022, by = 2)) |&gt;</span></span>
<span id="cb25-769"><a href="#cb25-769" aria-hidden="true" tabindex="-1"></a><span class="in">  na.omit() |&gt;</span></span>
<span id="cb25-770"><a href="#cb25-770" aria-hidden="true" tabindex="-1"></a><span class="in">  inner_join(data[, cols], by = "ID") |&gt;</span></span>
<span id="cb25-771"><a href="#cb25-771" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_data() |&gt;</span></span>
<span id="cb25-772"><a href="#cb25-772" aria-hidden="true" tabindex="-1"></a><span class="in">  backtrack_age(base_year = 2016, current_year = 2022) |&gt;</span></span>
<span id="cb25-773"><a href="#cb25-773" aria-hidden="true" tabindex="-1"></a><span class="in">  group_by(ID) |&gt;</span></span>
<span id="cb25-774"><a href="#cb25-774" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb25-775"><a href="#cb25-775" aria-hidden="true" tabindex="-1"></a><span class="in">    Age = min(Age), # Baseline age</span></span>
<span id="cb25-776"><a href="#cb25-776" aria-hidden="true" tabindex="-1"></a><span class="in">    Cardio_risk = Cardio_risk[Wave == 1],</span></span>
<span id="cb25-777"><a href="#cb25-777" aria-hidden="true" tabindex="-1"></a><span class="in">    Depression = Depression[Wave == 1]</span></span>
<span id="cb25-778"><a href="#cb25-778" aria-hidden="true" tabindex="-1"></a><span class="in">    ) |&gt;</span></span>
<span id="cb25-779"><a href="#cb25-779" aria-hidden="true" tabindex="-1"></a><span class="in">  ungroup() |&gt;</span></span>
<span id="cb25-780"><a href="#cb25-780" aria-hidden="true" tabindex="-1"></a><span class="in">  filter(Age &gt;= 50) # Only looking at older adults</span></span>
<span id="cb25-781"><a href="#cb25-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-782"><a href="#cb25-782" aria-hidden="true" tabindex="-1"></a><span class="in">DT::datatable(</span></span>
<span id="cb25-783"><a href="#cb25-783" aria-hidden="true" tabindex="-1"></a><span class="in">  markov_data,</span></span>
<span id="cb25-784"><a href="#cb25-784" aria-hidden="true" tabindex="-1"></a><span class="in">  filter = "top",</span></span>
<span id="cb25-785"><a href="#cb25-785" aria-hidden="true" tabindex="-1"></a><span class="in">  options = list(pageLength = 6, autoWidth = TRUE)</span></span>
<span id="cb25-786"><a href="#cb25-786" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb25-787"><a href="#cb25-787" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-788"><a href="#cb25-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-789"><a href="#cb25-789" aria-hidden="true" tabindex="-1"></a>Let's look at a state table to visualize the amount of transitions over time</span>
<span id="cb25-790"><a href="#cb25-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-791"><a href="#cb25-791" aria-hidden="true" tabindex="-1"></a><span class="in">```{r state-table}</span></span>
<span id="cb25-792"><a href="#cb25-792" aria-hidden="true" tabindex="-1"></a><span class="in">markov_data |&gt;</span></span>
<span id="cb25-793"><a href="#cb25-793" aria-hidden="true" tabindex="-1"></a><span class="in">  select(ID, Wave, Status) |&gt;</span></span>
<span id="cb25-794"><a href="#cb25-794" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Status = case_when(</span></span>
<span id="cb25-795"><a href="#cb25-795" aria-hidden="true" tabindex="-1"></a><span class="in">    Status == 1 ~ "Normal Cognition", </span></span>
<span id="cb25-796"><a href="#cb25-796" aria-hidden="true" tabindex="-1"></a><span class="in">    Status == 2 ~ "MCI", </span></span>
<span id="cb25-797"><a href="#cb25-797" aria-hidden="true" tabindex="-1"></a><span class="in">    Status == 3 ~ "Dementia")) |&gt;</span></span>
<span id="cb25-798"><a href="#cb25-798" aria-hidden="true" tabindex="-1"></a><span class="in">  msm::statetable.msm(state = Status, subject = ID)</span></span>
<span id="cb25-799"><a href="#cb25-799" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-800"><a href="#cb25-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-801"><a href="#cb25-801" aria-hidden="true" tabindex="-1"></a><span class="fu">## Modelling</span></span>
<span id="cb25-802"><a href="#cb25-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-803"><a href="#cb25-803" aria-hidden="true" tabindex="-1"></a><span class="fu">### Defining a q-matrix</span></span>
<span id="cb25-804"><a href="#cb25-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-805"><a href="#cb25-805" aria-hidden="true" tabindex="-1"></a>The Q matrix (also known as the transition intensity matrix or generator matrix) defines the rates at which transitions occur between states in the model. </span>
<span id="cb25-806"><a href="#cb25-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-807"><a href="#cb25-807" aria-hidden="true" tabindex="-1"></a>It is a square matrix where:</span>
<span id="cb25-808"><a href="#cb25-808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-809"><a href="#cb25-809" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Each row corresponds to a **from** state in the model.</span>
<span id="cb25-810"><a href="#cb25-810" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Each column corresponds to a **to** state in the model.</span>
<span id="cb25-811"><a href="#cb25-811" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The off-diagonal elements $q_{ij}$ represent the transition rate from state $i$ to state $j$.</span>
<span id="cb25-812"><a href="#cb25-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-813"><a href="#cb25-813" aria-hidden="true" tabindex="-1"></a>For a model with $n$ states, the Q matrix has the following structure</span>
<span id="cb25-814"><a href="#cb25-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-815"><a href="#cb25-815" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-816"><a href="#cb25-816" aria-hidden="true" tabindex="-1"></a>Q = \begin{bmatrix} </span>
<span id="cb25-817"><a href="#cb25-817" aria-hidden="true" tabindex="-1"></a>q_{11} &amp; q_{12} &amp; \cdots &amp; q_{1n} <span class="sc">\\</span></span>
<span id="cb25-818"><a href="#cb25-818" aria-hidden="true" tabindex="-1"></a>q_{21} &amp; q_{22} &amp; \cdots &amp; q_{2n} <span class="sc">\\</span></span>
<span id="cb25-819"><a href="#cb25-819" aria-hidden="true" tabindex="-1"></a>\vdots &amp; \vdots &amp; \ddots &amp;\vdots  <span class="sc">\\</span></span>
<span id="cb25-820"><a href="#cb25-820" aria-hidden="true" tabindex="-1"></a>q_{n1} &amp; q_{n2} &amp; \cdots &amp; q_{nn}</span>
<span id="cb25-821"><a href="#cb25-821" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb25-822"><a href="#cb25-822" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb25-823"><a href="#cb25-823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-824"><a href="#cb25-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-825"><a href="#cb25-825" aria-hidden="true" tabindex="-1"></a><span class="in">```{r q-matrix}</span></span>
<span id="cb25-826"><a href="#cb25-826" aria-hidden="true" tabindex="-1"></a><span class="in"># Creating transition matrix</span></span>
<span id="cb25-827"><a href="#cb25-827" aria-hidden="true" tabindex="-1"></a><span class="in"># Define possible transitions</span></span>
<span id="cb25-828"><a href="#cb25-828" aria-hidden="true" tabindex="-1"></a><span class="in">states &lt;- c("Normal Cognition", "MCI", "Dementia")</span></span>
<span id="cb25-829"><a href="#cb25-829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-830"><a href="#cb25-830" aria-hidden="true" tabindex="-1"></a><span class="in"># Theoretical transition probabilities</span></span>
<span id="cb25-831"><a href="#cb25-831" aria-hidden="true" tabindex="-1"></a><span class="in">q_matrix &lt;- rbind(</span></span>
<span id="cb25-832"><a href="#cb25-832" aria-hidden="true" tabindex="-1"></a><span class="in">  c(0.75, 0.20, 0.05),  # From Normal, can transition to MCI or Dementia</span></span>
<span id="cb25-833"><a href="#cb25-833" aria-hidden="true" tabindex="-1"></a><span class="in">  c(0.25, 0.50, 0.25),  # From MCI, can transition to Normal or Dementia</span></span>
<span id="cb25-834"><a href="#cb25-834" aria-hidden="true" tabindex="-1"></a><span class="in">  c(0.00, 0.00, 1.00)         # From Dementia, no transitions (absorbing state)</span></span>
<span id="cb25-835"><a href="#cb25-835" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb25-836"><a href="#cb25-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-837"><a href="#cb25-837" aria-hidden="true" tabindex="-1"></a><span class="in">rownames(q_matrix) &lt;- states</span></span>
<span id="cb25-838"><a href="#cb25-838" aria-hidden="true" tabindex="-1"></a><span class="in">colnames(q_matrix) &lt;- states</span></span>
<span id="cb25-839"><a href="#cb25-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-840"><a href="#cb25-840" aria-hidden="true" tabindex="-1"></a><span class="in">q_matrix</span></span>
<span id="cb25-841"><a href="#cb25-841" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-842"><a href="#cb25-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-843"><a href="#cb25-843" aria-hidden="true" tabindex="-1"></a><span class="fu">## Fitting</span></span>
<span id="cb25-844"><a href="#cb25-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-845"><a href="#cb25-845" aria-hidden="true" tabindex="-1"></a>We will fit three different multi-state models</span>
<span id="cb25-846"><a href="#cb25-846" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-847"><a href="#cb25-847" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>A model with no covariates</span>
<span id="cb25-848"><a href="#cb25-848" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>A multivariate model with covariates acting on all transitions</span>
<span id="cb25-849"><a href="#cb25-849" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>A multivariate model with covariates (and interactions) acting on all transitions</span>
<span id="cb25-850"><a href="#cb25-850" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>A multivariate model with covariates acting on only NC &lt;-&gt; MCI &amp; MCI - Dementia</span>
<span id="cb25-851"><a href="#cb25-851" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>A multivariate model with covariates (and interactions) acting on only NC &lt;-&gt; MCI &amp; MCI - Dementia</span>
<span id="cb25-852"><a href="#cb25-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-853"><a href="#cb25-853" aria-hidden="true" tabindex="-1"></a><span class="in">```{r model-fitting}</span></span>
<span id="cb25-854"><a href="#cb25-854" aria-hidden="true" tabindex="-1"></a><span class="in">#| warning: false</span></span>
<span id="cb25-855"><a href="#cb25-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-856"><a href="#cb25-856" aria-hidden="true" tabindex="-1"></a><span class="in"># Fitting model with no covariates</span></span>
<span id="cb25-857"><a href="#cb25-857" aria-hidden="true" tabindex="-1"></a><span class="in">model_1 &lt;- msm::msm(</span></span>
<span id="cb25-858"><a href="#cb25-858" aria-hidden="true" tabindex="-1"></a><span class="in">  formula = Status ~ Wave,</span></span>
<span id="cb25-859"><a href="#cb25-859" aria-hidden="true" tabindex="-1"></a><span class="in">  subject = ID,</span></span>
<span id="cb25-860"><a href="#cb25-860" aria-hidden="true" tabindex="-1"></a><span class="in">  data = markov_data,</span></span>
<span id="cb25-861"><a href="#cb25-861" aria-hidden="true" tabindex="-1"></a><span class="in">  qmatrix = q_matrix,</span></span>
<span id="cb25-862"><a href="#cb25-862" aria-hidden="true" tabindex="-1"></a><span class="in">  obstype = 1,</span></span>
<span id="cb25-863"><a href="#cb25-863" aria-hidden="true" tabindex="-1"></a><span class="in">  method = "BFGS", </span></span>
<span id="cb25-864"><a href="#cb25-864" aria-hidden="true" tabindex="-1"></a><span class="in">  gen.inits = TRUE,</span></span>
<span id="cb25-865"><a href="#cb25-865" aria-hidden="true" tabindex="-1"></a><span class="in">  control = list(</span></span>
<span id="cb25-866"><a href="#cb25-866" aria-hidden="true" tabindex="-1"></a><span class="in">    fnscale = 5000, </span></span>
<span id="cb25-867"><a href="#cb25-867" aria-hidden="true" tabindex="-1"></a><span class="in">    maxit = 2000 # To reach convergence</span></span>
<span id="cb25-868"><a href="#cb25-868" aria-hidden="true" tabindex="-1"></a><span class="in">  ))</span></span>
<span id="cb25-869"><a href="#cb25-869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-870"><a href="#cb25-870" aria-hidden="true" tabindex="-1"></a><span class="in"># Multivariate model: covariates acting on all transitions</span></span>
<span id="cb25-871"><a href="#cb25-871" aria-hidden="true" tabindex="-1"></a><span class="in">model_2 &lt;- msm::msm(</span></span>
<span id="cb25-872"><a href="#cb25-872" aria-hidden="true" tabindex="-1"></a><span class="in">  formula = Status ~ Wave,</span></span>
<span id="cb25-873"><a href="#cb25-873" aria-hidden="true" tabindex="-1"></a><span class="in">  subject = ID,</span></span>
<span id="cb25-874"><a href="#cb25-874" aria-hidden="true" tabindex="-1"></a><span class="in">  data = markov_data,</span></span>
<span id="cb25-875"><a href="#cb25-875" aria-hidden="true" tabindex="-1"></a><span class="in">  qmatrix = q_matrix,</span></span>
<span id="cb25-876"><a href="#cb25-876" aria-hidden="true" tabindex="-1"></a><span class="in">  covariates = ~ Gender + Age + Education_tri + Cardio_risk + Depression + Total_p,</span></span>
<span id="cb25-877"><a href="#cb25-877" aria-hidden="true" tabindex="-1"></a><span class="in">  obstype = 1,</span></span>
<span id="cb25-878"><a href="#cb25-878" aria-hidden="true" tabindex="-1"></a><span class="in">  gen.inits = TRUE,</span></span>
<span id="cb25-879"><a href="#cb25-879" aria-hidden="true" tabindex="-1"></a><span class="in">  method = "BFGS",</span></span>
<span id="cb25-880"><a href="#cb25-880" aria-hidden="true" tabindex="-1"></a><span class="in">  control = list(</span></span>
<span id="cb25-881"><a href="#cb25-881" aria-hidden="true" tabindex="-1"></a><span class="in">    fnscale = 6000, </span></span>
<span id="cb25-882"><a href="#cb25-882" aria-hidden="true" tabindex="-1"></a><span class="in">    maxit = 2000 # To reach convergence</span></span>
<span id="cb25-883"><a href="#cb25-883" aria-hidden="true" tabindex="-1"></a><span class="in">  ))</span></span>
<span id="cb25-884"><a href="#cb25-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-885"><a href="#cb25-885" aria-hidden="true" tabindex="-1"></a><span class="in"># Multivariate model: covariates acting on all transitions (with interaction)</span></span>
<span id="cb25-886"><a href="#cb25-886" aria-hidden="true" tabindex="-1"></a><span class="in">model_3 &lt;- msm::msm(</span></span>
<span id="cb25-887"><a href="#cb25-887" aria-hidden="true" tabindex="-1"></a><span class="in">  formula = Status ~ Wave,</span></span>
<span id="cb25-888"><a href="#cb25-888" aria-hidden="true" tabindex="-1"></a><span class="in">  subject = ID,</span></span>
<span id="cb25-889"><a href="#cb25-889" aria-hidden="true" tabindex="-1"></a><span class="in">  data = markov_data,</span></span>
<span id="cb25-890"><a href="#cb25-890" aria-hidden="true" tabindex="-1"></a><span class="in">  qmatrix = q_matrix,</span></span>
<span id="cb25-891"><a href="#cb25-891" aria-hidden="true" tabindex="-1"></a><span class="in">  covariates = ~ Gender + Age + Education_tri + Cardio_risk + (Depression * Total_p),</span></span>
<span id="cb25-892"><a href="#cb25-892" aria-hidden="true" tabindex="-1"></a><span class="in">  obstype = 1,</span></span>
<span id="cb25-893"><a href="#cb25-893" aria-hidden="true" tabindex="-1"></a><span class="in">  gen.inits = TRUE,</span></span>
<span id="cb25-894"><a href="#cb25-894" aria-hidden="true" tabindex="-1"></a><span class="in">  method = "BFGS",</span></span>
<span id="cb25-895"><a href="#cb25-895" aria-hidden="true" tabindex="-1"></a><span class="in">  control = list(</span></span>
<span id="cb25-896"><a href="#cb25-896" aria-hidden="true" tabindex="-1"></a><span class="in">    fnscale = 5000, </span></span>
<span id="cb25-897"><a href="#cb25-897" aria-hidden="true" tabindex="-1"></a><span class="in">    maxit = 2000 # To reach convergence</span></span>
<span id="cb25-898"><a href="#cb25-898" aria-hidden="true" tabindex="-1"></a><span class="in">  ))</span></span>
<span id="cb25-899"><a href="#cb25-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-900"><a href="#cb25-900" aria-hidden="true" tabindex="-1"></a><span class="in"># Multivariate model: covariates acting on NC &lt;-&gt; MCI and MCI -&gt; D</span></span>
<span id="cb25-901"><a href="#cb25-901" aria-hidden="true" tabindex="-1"></a><span class="in">model_4 &lt;- msm::msm(</span></span>
<span id="cb25-902"><a href="#cb25-902" aria-hidden="true" tabindex="-1"></a><span class="in">  formula = Status ~ Wave,</span></span>
<span id="cb25-903"><a href="#cb25-903" aria-hidden="true" tabindex="-1"></a><span class="in">  subject = ID,</span></span>
<span id="cb25-904"><a href="#cb25-904" aria-hidden="true" tabindex="-1"></a><span class="in">  data = markov_data,</span></span>
<span id="cb25-905"><a href="#cb25-905" aria-hidden="true" tabindex="-1"></a><span class="in">  qmatrix = q_matrix,</span></span>
<span id="cb25-906"><a href="#cb25-906" aria-hidden="true" tabindex="-1"></a><span class="in">  covariates = list(</span></span>
<span id="cb25-907"><a href="#cb25-907" aria-hidden="true" tabindex="-1"></a><span class="in">    "1-2" = ~ Gender + Age + Education_tri + Cardio_risk + Depression + Total_p,</span></span>
<span id="cb25-908"><a href="#cb25-908" aria-hidden="true" tabindex="-1"></a><span class="in">    "2-1" = ~ Gender + Age + Education_tri + Cardio_risk + Depression + Total_p,</span></span>
<span id="cb25-909"><a href="#cb25-909" aria-hidden="true" tabindex="-1"></a><span class="in">    "2-3" = ~ Gender + Age + Education_tri + Cardio_risk + Depression + Total_p</span></span>
<span id="cb25-910"><a href="#cb25-910" aria-hidden="true" tabindex="-1"></a><span class="in">  ),</span></span>
<span id="cb25-911"><a href="#cb25-911" aria-hidden="true" tabindex="-1"></a><span class="in">  obstype = 1,</span></span>
<span id="cb25-912"><a href="#cb25-912" aria-hidden="true" tabindex="-1"></a><span class="in">  gen.inits = TRUE,</span></span>
<span id="cb25-913"><a href="#cb25-913" aria-hidden="true" tabindex="-1"></a><span class="in">  method = "BFGS",</span></span>
<span id="cb25-914"><a href="#cb25-914" aria-hidden="true" tabindex="-1"></a><span class="in">  control = list(</span></span>
<span id="cb25-915"><a href="#cb25-915" aria-hidden="true" tabindex="-1"></a><span class="in">    fnscale = 5000, </span></span>
<span id="cb25-916"><a href="#cb25-916" aria-hidden="true" tabindex="-1"></a><span class="in">    maxit = 2000 # To reach convergence</span></span>
<span id="cb25-917"><a href="#cb25-917" aria-hidden="true" tabindex="-1"></a><span class="in">  ))</span></span>
<span id="cb25-918"><a href="#cb25-918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-919"><a href="#cb25-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-920"><a href="#cb25-920" aria-hidden="true" tabindex="-1"></a><span class="in"># Multivariate model: covariates acting on NC &lt;-&gt; MCI and MCI -&gt; D (with interaction)</span></span>
<span id="cb25-921"><a href="#cb25-921" aria-hidden="true" tabindex="-1"></a><span class="in">model_5 &lt;- msm::msm(</span></span>
<span id="cb25-922"><a href="#cb25-922" aria-hidden="true" tabindex="-1"></a><span class="in">  formula = Status ~ Wave,</span></span>
<span id="cb25-923"><a href="#cb25-923" aria-hidden="true" tabindex="-1"></a><span class="in">  subject = ID,</span></span>
<span id="cb25-924"><a href="#cb25-924" aria-hidden="true" tabindex="-1"></a><span class="in">  data = markov_data,</span></span>
<span id="cb25-925"><a href="#cb25-925" aria-hidden="true" tabindex="-1"></a><span class="in">  qmatrix = q_matrix,</span></span>
<span id="cb25-926"><a href="#cb25-926" aria-hidden="true" tabindex="-1"></a><span class="in">  covariates = list(</span></span>
<span id="cb25-927"><a href="#cb25-927" aria-hidden="true" tabindex="-1"></a><span class="in">    "1-2" = ~ Gender + Age + Education_tri + Cardio_risk + (Depression * Total_p),</span></span>
<span id="cb25-928"><a href="#cb25-928" aria-hidden="true" tabindex="-1"></a><span class="in">    "2-1" = ~ Gender + Age + Education_tri + Cardio_risk + (Depression * Total_p),</span></span>
<span id="cb25-929"><a href="#cb25-929" aria-hidden="true" tabindex="-1"></a><span class="in">    "2-3" = ~ Gender + Age + Education_tri + Cardio_risk + (Depression * Total_p)</span></span>
<span id="cb25-930"><a href="#cb25-930" aria-hidden="true" tabindex="-1"></a><span class="in">  ),</span></span>
<span id="cb25-931"><a href="#cb25-931" aria-hidden="true" tabindex="-1"></a><span class="in">  obstype = 1,</span></span>
<span id="cb25-932"><a href="#cb25-932" aria-hidden="true" tabindex="-1"></a><span class="in">  gen.inits = TRUE,</span></span>
<span id="cb25-933"><a href="#cb25-933" aria-hidden="true" tabindex="-1"></a><span class="in">  method = "BFGS",</span></span>
<span id="cb25-934"><a href="#cb25-934" aria-hidden="true" tabindex="-1"></a><span class="in">  control = list(</span></span>
<span id="cb25-935"><a href="#cb25-935" aria-hidden="true" tabindex="-1"></a><span class="in">    fnscale = 5000, </span></span>
<span id="cb25-936"><a href="#cb25-936" aria-hidden="true" tabindex="-1"></a><span class="in">    maxit = 2000 # To reach convergence</span></span>
<span id="cb25-937"><a href="#cb25-937" aria-hidden="true" tabindex="-1"></a><span class="in">  ))</span></span>
<span id="cb25-938"><a href="#cb25-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-939"><a href="#cb25-939" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-940"><a href="#cb25-940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-941"><a href="#cb25-941" aria-hidden="true" tabindex="-1"></a><span class="fu">### Model Checking</span></span>
<span id="cb25-942"><a href="#cb25-942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-943"><a href="#cb25-943" aria-hidden="true" tabindex="-1"></a>After fitting each of our models we can extract some goodness of fit criteria</span>
<span id="cb25-944"><a href="#cb25-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-945"><a href="#cb25-945" aria-hidden="true" tabindex="-1"></a><span class="in">```{r model-goodness}</span></span>
<span id="cb25-946"><a href="#cb25-946" aria-hidden="true" tabindex="-1"></a><span class="in">log_l &lt;- c(logLik(model_1), </span></span>
<span id="cb25-947"><a href="#cb25-947" aria-hidden="true" tabindex="-1"></a><span class="in">           logLik(model_2), </span></span>
<span id="cb25-948"><a href="#cb25-948" aria-hidden="true" tabindex="-1"></a><span class="in">           logLik(model_3), </span></span>
<span id="cb25-949"><a href="#cb25-949" aria-hidden="true" tabindex="-1"></a><span class="in">           logLik(model_4), </span></span>
<span id="cb25-950"><a href="#cb25-950" aria-hidden="true" tabindex="-1"></a><span class="in">           logLik(model_5))</span></span>
<span id="cb25-951"><a href="#cb25-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-952"><a href="#cb25-952" aria-hidden="true" tabindex="-1"></a><span class="in">aic &lt;- AIC(model_1, model_2, model_3, model_4, model_5)</span></span>
<span id="cb25-953"><a href="#cb25-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-954"><a href="#cb25-954" aria-hidden="true" tabindex="-1"></a><span class="in"># Very small difference between model 2 and 3 (makes sense)</span></span>
<span id="cb25-955"><a href="#cb25-955" aria-hidden="true" tabindex="-1"></a><span class="in">cbind(log_l, aic) |&gt;</span></span>
<span id="cb25-956"><a href="#cb25-956" aria-hidden="true" tabindex="-1"></a><span class="in">  tibble::rownames_to_column("Model") |&gt;</span></span>
<span id="cb25-957"><a href="#cb25-957" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Model = stringr::str_remove(Model, "model_"))</span></span>
<span id="cb25-958"><a href="#cb25-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-959"><a href="#cb25-959" aria-hidden="true" tabindex="-1"></a><span class="in"># Likelihood ratio test</span></span>
<span id="cb25-960"><a href="#cb25-960" aria-hidden="true" tabindex="-1"></a><span class="in">lmtest::lrtest(model_1, model_2, model_3, model_4, model_5)</span></span>
<span id="cb25-961"><a href="#cb25-961" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-962"><a href="#cb25-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-963"><a href="#cb25-963" aria-hidden="true" tabindex="-1"></a>We can also look at a measure of how well the model fits the data using a test proposed by <span class="co">[</span><span class="ot">@gentleman1994</span><span class="co">]</span>. The function plots the observed numbers of individuals occupying a state at a series of times against forecasts from the fitted model, for each state (@fig-gentleman).</span>
<span id="cb25-964"><a href="#cb25-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-965"><a href="#cb25-965" aria-hidden="true" tabindex="-1"></a><span class="in">```{r gentleman_test}</span></span>
<span id="cb25-966"><a href="#cb25-966" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-width: 12</span></span>
<span id="cb25-967"><a href="#cb25-967" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-height: 12</span></span>
<span id="cb25-968"><a href="#cb25-968" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-gentleman</span></span>
<span id="cb25-969"><a href="#cb25-969" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: Fitted values versus observed values</span></span>
<span id="cb25-970"><a href="#cb25-970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-971"><a href="#cb25-971" aria-hidden="true" tabindex="-1"></a><span class="in"># Plotting fitted vs. observed values</span></span>
<span id="cb25-972"><a href="#cb25-972" aria-hidden="true" tabindex="-1"></a><span class="in">g1 &lt;- gentleman_test(data = msm::prevalence.msm(model_1), </span></span>
<span id="cb25-973"><a href="#cb25-973" aria-hidden="true" tabindex="-1"></a><span class="in">                     model = "Model 1")</span></span>
<span id="cb25-974"><a href="#cb25-974" aria-hidden="true" tabindex="-1"></a><span class="in">g2 &lt;- gentleman_test(data = msm::prevalence.msm(model_2), </span></span>
<span id="cb25-975"><a href="#cb25-975" aria-hidden="true" tabindex="-1"></a><span class="in">                     model = "Model 2")</span></span>
<span id="cb25-976"><a href="#cb25-976" aria-hidden="true" tabindex="-1"></a><span class="in">g3 &lt;- gentleman_test(data = msm::prevalence.msm(model_3), </span></span>
<span id="cb25-977"><a href="#cb25-977" aria-hidden="true" tabindex="-1"></a><span class="in">                     model = "Model 3")</span></span>
<span id="cb25-978"><a href="#cb25-978" aria-hidden="true" tabindex="-1"></a><span class="in">g4 &lt;- gentleman_test(data = msm::prevalence.msm(model_4), </span></span>
<span id="cb25-979"><a href="#cb25-979" aria-hidden="true" tabindex="-1"></a><span class="in">                     model = "Model 4")</span></span>
<span id="cb25-980"><a href="#cb25-980" aria-hidden="true" tabindex="-1"></a><span class="in">g5 &lt;- gentleman_test(data = msm::prevalence.msm(model_5), </span></span>
<span id="cb25-981"><a href="#cb25-981" aria-hidden="true" tabindex="-1"></a><span class="in">                     model = "Model 5")</span></span>
<span id="cb25-982"><a href="#cb25-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-983"><a href="#cb25-983" aria-hidden="true" tabindex="-1"></a><span class="in">ggpubr::ggarrange(g1, g2, g3, g4, g5, </span></span>
<span id="cb25-984"><a href="#cb25-984" aria-hidden="true" tabindex="-1"></a><span class="in">                  common.legend = TRUE, </span></span>
<span id="cb25-985"><a href="#cb25-985" aria-hidden="true" tabindex="-1"></a><span class="in">                  nrow = 5,</span></span>
<span id="cb25-986"><a href="#cb25-986" aria-hidden="true" tabindex="-1"></a><span class="in">                  heights = c(2, 2, 2, 2, 2), </span></span>
<span id="cb25-987"><a href="#cb25-987" aria-hidden="true" tabindex="-1"></a><span class="in">                  legend = "bottom")</span></span>
<span id="cb25-988"><a href="#cb25-988" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-989"><a href="#cb25-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-990"><a href="#cb25-990" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hazard ratios</span></span>
<span id="cb25-991"><a href="#cb25-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-992"><a href="#cb25-992" aria-hidden="true" tabindex="-1"></a>We now present hazard ratios for each of our fitted models. These ratios represent how the instantaneous risk of making a particular transition is modified by the covariate.</span>
<span id="cb25-993"><a href="#cb25-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-994"><a href="#cb25-994" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb25-995"><a href="#cb25-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-996"><a href="#cb25-996" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model 2</span></span>
<span id="cb25-997"><a href="#cb25-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-998"><a href="#cb25-998" aria-hidden="true" tabindex="-1"></a>@fig-hazard-ratio-1 presents hazard ratios from model 2 (our multivariate model with covariates acting on all transitions) for each covariate.</span>
<span id="cb25-999"><a href="#cb25-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1002"><a href="#cb25-1002" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-1003"><a href="#cb25-1003" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb25-1004"><a href="#cb25-1004" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 12</span></span>
<span id="cb25-1005"><a href="#cb25-1005" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-hazard-ratio-1</span></span>
<span id="cb25-1006"><a href="#cb25-1006" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Ouputted hazard ratios from Markov model. Green bars represent a decreased risk of transition while red bars indicate an increased risk of transition. </span></span>
<span id="cb25-1007"><a href="#cb25-1007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1008"><a href="#cb25-1008" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting hazard ratios</span></span>
<span id="cb25-1009"><a href="#cb25-1009" aria-hidden="true" tabindex="-1"></a>model_2 <span class="sc">|&gt;</span></span>
<span id="cb25-1010"><a href="#cb25-1010" aria-hidden="true" tabindex="-1"></a>  msm<span class="sc">::</span><span class="fu">hazard.msm</span>() <span class="sc">|&gt;</span></span>
<span id="cb25-1011"><a href="#cb25-1011" aria-hidden="true" tabindex="-1"></a>  <span class="fu">process_hr</span>() <span class="sc">|&gt;</span></span>
<span id="cb25-1012"><a href="#cb25-1012" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate_p_value</span>() <span class="sc">|&gt;</span></span>
<span id="cb25-1013"><a href="#cb25-1013" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_hr</span>()</span>
<span id="cb25-1014"><a href="#cb25-1014" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-1015"><a href="#cb25-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1016"><a href="#cb25-1016" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model 3</span></span>
<span id="cb25-1017"><a href="#cb25-1017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1018"><a href="#cb25-1018" aria-hidden="true" tabindex="-1"></a>@fig-hazard-ratio-2 presents hazard ratios from model 3 (our multivariate model with covariates **(and interactions)** acting on all transitions) for each covariate.</span>
<span id="cb25-1019"><a href="#cb25-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1022"><a href="#cb25-1022" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-1023"><a href="#cb25-1023" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb25-1024"><a href="#cb25-1024" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 12</span></span>
<span id="cb25-1025"><a href="#cb25-1025" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-hazard-ratio-2</span></span>
<span id="cb25-1026"><a href="#cb25-1026" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Ouputted hazard ratios from Markov model. Green bars represent a decreased risk of transition while red bars indicate an increased risk of transition. </span></span>
<span id="cb25-1027"><a href="#cb25-1027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1028"><a href="#cb25-1028" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting hazard ratios</span></span>
<span id="cb25-1029"><a href="#cb25-1029" aria-hidden="true" tabindex="-1"></a>model_3 <span class="sc">|&gt;</span></span>
<span id="cb25-1030"><a href="#cb25-1030" aria-hidden="true" tabindex="-1"></a>  msm<span class="sc">::</span><span class="fu">hazard.msm</span>() <span class="sc">|&gt;</span></span>
<span id="cb25-1031"><a href="#cb25-1031" aria-hidden="true" tabindex="-1"></a>  <span class="fu">process_hr</span>() <span class="sc">|&gt;</span></span>
<span id="cb25-1032"><a href="#cb25-1032" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate_p_value</span>() <span class="sc">|&gt;</span></span>
<span id="cb25-1033"><a href="#cb25-1033" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_hr</span>()</span>
<span id="cb25-1034"><a href="#cb25-1034" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-1035"><a href="#cb25-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1036"><a href="#cb25-1036" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model 4</span></span>
<span id="cb25-1037"><a href="#cb25-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1038"><a href="#cb25-1038" aria-hidden="true" tabindex="-1"></a>@fig-hazard-ratio-3 presents hazard ratios for model 4 (our multivariate model with covariates acting on only NC &lt;-&gt; MCI &amp; MCI -&gt; Dementia) for each covariate</span>
<span id="cb25-1039"><a href="#cb25-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1042"><a href="#cb25-1042" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-1043"><a href="#cb25-1043" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb25-1044"><a href="#cb25-1044" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 12</span></span>
<span id="cb25-1045"><a href="#cb25-1045" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-hazard-ratio-3</span></span>
<span id="cb25-1046"><a href="#cb25-1046" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Ouputted hazard ratios from Markov model. Green bars represent a decreased risk of transition while red bars indicate an increased risk of transition. </span></span>
<span id="cb25-1047"><a href="#cb25-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1048"><a href="#cb25-1048" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting hazard ratios</span></span>
<span id="cb25-1049"><a href="#cb25-1049" aria-hidden="true" tabindex="-1"></a>model_4 <span class="sc">|&gt;</span></span>
<span id="cb25-1050"><a href="#cb25-1050" aria-hidden="true" tabindex="-1"></a>  msm<span class="sc">::</span><span class="fu">hazard.msm</span>() <span class="sc">|&gt;</span></span>
<span id="cb25-1051"><a href="#cb25-1051" aria-hidden="true" tabindex="-1"></a>  <span class="fu">process_hr</span>() <span class="sc">|&gt;</span></span>
<span id="cb25-1052"><a href="#cb25-1052" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate_p_value</span>() <span class="sc">|&gt;</span></span>
<span id="cb25-1053"><a href="#cb25-1053" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_hr</span>()</span>
<span id="cb25-1054"><a href="#cb25-1054" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-1055"><a href="#cb25-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1056"><a href="#cb25-1056" aria-hidden="true" tabindex="-1"></a><span class="fu">## Model 5</span></span>
<span id="cb25-1057"><a href="#cb25-1057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1058"><a href="#cb25-1058" aria-hidden="true" tabindex="-1"></a>@fig-hazard-ratio-4 presents hazard ratios for model 5 (our multivariate model with covariates **(and interactions)** acting on only NC &lt;-&gt; MCI &amp; MCI -&gt; Dementia) for each covariate</span>
<span id="cb25-1059"><a href="#cb25-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1062"><a href="#cb25-1062" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb25-1063"><a href="#cb25-1063" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-width: 12</span></span>
<span id="cb25-1064"><a href="#cb25-1064" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-height: 12</span></span>
<span id="cb25-1065"><a href="#cb25-1065" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-hazard-ratio-4</span></span>
<span id="cb25-1066"><a href="#cb25-1066" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: Ouputted hazard ratios from Markov model. Green bars represent a decreased risk of transition while red bars indicate an increased risk of transition. </span></span>
<span id="cb25-1067"><a href="#cb25-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1068"><a href="#cb25-1068" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting hazard ratios</span></span>
<span id="cb25-1069"><a href="#cb25-1069" aria-hidden="true" tabindex="-1"></a>model_5 <span class="sc">|&gt;</span></span>
<span id="cb25-1070"><a href="#cb25-1070" aria-hidden="true" tabindex="-1"></a>  msm<span class="sc">::</span><span class="fu">hazard.msm</span>() <span class="sc">|&gt;</span></span>
<span id="cb25-1071"><a href="#cb25-1071" aria-hidden="true" tabindex="-1"></a>  <span class="fu">process_hr</span>() <span class="sc">|&gt;</span></span>
<span id="cb25-1072"><a href="#cb25-1072" aria-hidden="true" tabindex="-1"></a>  <span class="fu">calculate_p_value</span>() <span class="sc">|&gt;</span></span>
<span id="cb25-1073"><a href="#cb25-1073" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_hr</span>()</span>
<span id="cb25-1074"><a href="#cb25-1074" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb25-1075"><a href="#cb25-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-1076"><a href="#cb25-1076" aria-hidden="true" tabindex="-1"></a>:::</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/C-Monaghan/crisp-clam/edit/main/analysis/continous-markov.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/C-Monaghan/crisp-clam/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Made with <i class="fa-brands fa-r-project" aria-label="r-project"></i> and <a href="https://quarto.org/">Quarto</a><br> <a href="https://github.com/C-Monaghan/crisp-clam">View the source at <i class="fa-brands fa-github" aria-label="github"></i> GitHub</a></p>
</div>
  </div>
</footer>




</body></html>